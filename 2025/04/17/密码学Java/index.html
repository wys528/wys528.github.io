<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>密码学Java | Hexo</title><meta name="author" content="lele"><meta name="copyright" content="lele"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="学习目标：了解一些常见的密码学算法Hex编码什么是Hex编码Hex编码是一种用16个字符表示任意二进制数据的方法。它是一种编码，而非加密算法 java代码如下： package org.example;import com.sun.org.apache.xerces.internal.impl.dv.util.HexBin;&#x2F;&#x2F;TIP To &lt;b&gt;Run&lt;&#x2F;b&gt; code,">
<meta property="og:type" content="article">
<meta property="og:title" content="密码学Java">
<meta property="og:url" content="http://example.com/2025/04/17/%E5%AF%86%E7%A0%81%E5%AD%A6Java/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="学习目标：了解一些常见的密码学算法Hex编码什么是Hex编码Hex编码是一种用16个字符表示任意二进制数据的方法。它是一种编码，而非加密算法 java代码如下： package org.example;import com.sun.org.apache.xerces.internal.impl.dv.util.HexBin;&#x2F;&#x2F;TIP To &lt;b&gt;Run&lt;&#x2F;b&gt; code,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg">
<meta property="article:published_time" content="2025-04-17T07:49:47.000Z">
<meta property="article:modified_time" content="2025-04-25T15:05:39.306Z">
<meta property="article:author" content="lele">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" href="/image/tx.jpg"><link rel="canonical" href="http://example.com/2025/04/17/%E5%AF%86%E7%A0%81%E5%AD%A6Java/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '密码学Java',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-04-25 23:05:39'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/tx.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">121</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Hexo"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/test.gif"/><span class="site-name">Hexo</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">密码学Java</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-17T07:49:47.000Z" title="发表于 2025-04-17 15:49:47">2025-04-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-25T15:05:39.306Z" title="更新于 2025-04-25 23:05:39">2025-04-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/AndroidRe/">AndroidRe</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="密码学Java"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="学习目标：了解一些常见的密码学算法"><a href="#学习目标：了解一些常见的密码学算法" class="headerlink" title="学习目标：了解一些常见的密码学算法"></a>学习目标：了解一些常见的密码学算法</h1><h2 id="Hex编码"><a href="#Hex编码" class="headerlink" title="Hex编码"></a>Hex编码</h2><h3 id="什么是Hex编码"><a href="#什么是Hex编码" class="headerlink" title="什么是Hex编码"></a>什么是Hex编码</h3><p>Hex编码是一种用16个字符表示任意二进制数据的方法。它是一种编码，而非加密算法</p>
<p>java代码如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xerces.internal.impl.dv.util.HexBin;</span><br><span class="line"></span><br><span class="line"><span class="comment">//TIP To &lt;b&gt;Run&lt;/b&gt; code, press &lt;shortcut actionId=&quot;Run&quot;/&gt; or</span></span><br><span class="line"><span class="comment">// click the &lt;icon src=&quot;AllIcons.Actions.Execute&quot;/&gt; icon in the gutter.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;许之少年凌云志， 曾许人间第一流&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] bytes = name.getBytes();</span><br><span class="line">        System.out.println(bytes);</span><br><span class="line">        <span class="type">String</span> <span class="variable">encode</span> <span class="operator">=</span> HexBin.encode(bytes);</span><br><span class="line">        System.out.println(encode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里注意把编码方式改成UTF-8否则会报错，<strong>修改完后要重启idea</strong></p>
<p>url编码与HEX编码大体相同，区别就是在每组字节前面加了个%</p>
<p>encode源码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">public</span> String <span class="title function_">encode</span><span class="params">(<span class="type">byte</span>[] binaryData)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (binaryData == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">lengthData</span>   <span class="operator">=</span> binaryData.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">lengthEncode</span> <span class="operator">=</span> lengthData * <span class="number">2</span>;</span><br><span class="line">    <span class="type">char</span>[] encodedData = <span class="keyword">new</span> <span class="title class_">char</span>[lengthEncode];</span><br><span class="line">    <span class="type">int</span> temp;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; lengthData; i++) &#123;</span><br><span class="line">        temp = binaryData[i];</span><br><span class="line">        <span class="keyword">if</span> (temp &lt; <span class="number">0</span>)</span><br><span class="line">            temp += <span class="number">256</span>;</span><br><span class="line">        encodedData[i*<span class="number">2</span>] = lookUpHexAlphabet[temp &gt;&gt; <span class="number">4</span>];</span><br><span class="line">        encodedData[i*<span class="number">2</span>+<span class="number">1</span>] = lookUpHexAlphabet[temp &amp; <span class="number">0xf</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(encodedData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="在安卓当中使用"><a href="#在安卓当中使用" class="headerlink" title="在安卓当中使用"></a>在安卓当中使用</h3><p>导入依赖</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">implementation (&quot;com.squareup.okhttp3:okhttp:4.9.3&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Log.d(<span class="string">&quot;hyq&quot;</span>, <span class="string">&quot;测试代码&quot;</span>);</span><br><span class="line"><span class="type">ByteString</span> <span class="variable">byteString</span> <span class="operator">=</span> ByteString.of(<span class="string">&quot;好有钱&quot;</span>.getBytes());</span><br><span class="line">System.out.println(byteString.hex());</span><br></pre></td></tr></table></figure>

<h3 id="Hex编码的特点"><a href="#Hex编码的特点" class="headerlink" title="Hex编码的特点"></a>Hex编码的特点</h3><ul>
<li>用0-9 a-f 16个字符表示</li>
<li>每个十六进制字符代表4bit，也就是2个十六进制字符代表哪一个字节</li>
<li>在实际引用中，比如密钥初始化，一定要分清楚传进去的密钥是哪种编码写的，采用对应方式解析，才能得到正确结果</li>
</ul>
<h3 id="手写代码"><a href="#手写代码" class="headerlink" title="手写代码"></a>手写代码</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HexEncoder</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">char</span>[] lookupHexAlphabet = &#123;</span><br><span class="line">            <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encode</span><span class="params">(<span class="type">byte</span>[] binaryData)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(binaryData == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">lengthData</span> <span class="operator">=</span> binaryData.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">lengthEncode</span> <span class="operator">=</span> lengthData * <span class="number">2</span>;</span><br><span class="line">        <span class="type">char</span>[] encodeData = <span class="keyword">new</span> <span class="title class_">char</span>[lengthEncode];</span><br><span class="line">        <span class="type">int</span> temp;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;lengthData; i++) &#123;</span><br><span class="line">            temp = binaryData[i];</span><br><span class="line">            <span class="keyword">if</span>(temp &lt; <span class="number">0</span>) temp += <span class="number">256</span>;</span><br><span class="line">            encodeData[<span class="number">2</span>*i] = lookupHexAlphabet[temp&gt;&gt; <span class="number">4</span>];</span><br><span class="line">            encodeData[<span class="number">2</span>*i+<span class="number">1</span>] = lookupHexAlphabet[temp &amp; <span class="number">0xF</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(encodeData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;好有钱&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] binaryData = name.getBytes();</span><br><span class="line">        System.out.println(encode(binaryData));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h2><h3 id="什么是base64"><a href="#什么是base64" class="headerlink" title="什么是base64"></a>什么是base64</h3><p>Base64是一种用64个字符表示任意二进制数据的方法。它是一种编码，而非加密算法</p>
<p>A-Z  a-z  0-9  +  &#x2F;  &#x3D;</p>
<h3 id="Base64的应用"><a href="#Base64的应用" class="headerlink" title="Base64的应用"></a>Base64的应用</h3><p>RSA密钥、加密后的密文、图片等数据中，会有一些不可见字符。直接转换成文本传输的话，会有乱码、数据错误、数据丢失等情况出现，就可以使用Base64编码</p>
<h3 id="Base64编码的实现"><a href="#Base64编码的实现" class="headerlink" title="Base64编码的实现"></a>Base64编码的实现</h3><h4 id="java中的实现"><a href="#java中的实现" class="headerlink" title="java中的实现"></a>java中的实现</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(<span class="string">&quot;好有钱12345678&quot;</span>.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="android中的实现"><a href="#android中的实现" class="headerlink" title="android中的实现"></a>android中的实现</h3><h4 id="第一种，使用ByteString类"><a href="#第一种，使用ByteString类" class="headerlink" title="第一种，使用ByteString类"></a>第一种，使用ByteString类</h4><p>需要先导入okhttp3依赖</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">implementation (&quot;com.squareup.okhttp3:okhttp:4.9.3&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">ByteString</span> <span class="variable">byteString</span> <span class="operator">=</span> ByteString.of(<span class="string">&quot;好有钱&quot;</span>.getBytes());</span><br><span class="line">System.out.println(<span class="string">&quot;byteString base64: &quot;</span> + byteString.base64());</span><br></pre></td></tr></table></figure>

<h4 id="第二种，在android-studio中使用java库"><a href="#第二种，在android-studio中使用java库" class="headerlink" title="第二种，在android studio中使用java库"></a>第二种，在android studio中使用java库</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.O) &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(<span class="string">&quot;好有钱&quot;</span>.getBytes());</span><br><span class="line">    <span class="type">byte</span>[] encode = Base64.getEncoder().encode(<span class="string">&quot;好有钱&quot;</span>.getBytes());</span><br><span class="line">    System.out.println(<span class="string">&quot;java.util.Base64&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(encode));</span><br><span class="line">    System.out.println(<span class="string">&quot;java.util.Base64&quot;</span> + s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="第三种，使用安卓自带的"><a href="#第三种，使用安卓自带的" class="headerlink" title="第三种，使用安卓自带的"></a>第三种，使用安卓自带的</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> android.util.Base64.encodeToString(<span class="string">&quot;好有钱&quot;</span>.getBytes(), <span class="number">0</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;android.util.Base64&quot;</span> + s);</span><br></pre></td></tr></table></figure>

<h3 id="Base64码表的妙用"><a href="#Base64码表的妙用" class="headerlink" title="Base64码表的妙用"></a>Base64码表的妙用</h3><p>为了传输数据安全，通常会对Base64数据进行URL编码，或者会把+和&#x2F;替换成-和_</p>
<h3 id="Base64编码细节"><a href="#Base64编码细节" class="headerlink" title="Base64编码细节"></a>Base64编码细节</h3><p>每个Base64字符代表原数据中的6bit</p>
<p>Base64编码后的字符数，是4的倍数</p>
<p>编码的字节数是3的倍数时，不需要填充</p>
<h3 id="Base64编码的特点"><a href="#Base64编码的特点" class="headerlink" title="Base64编码的特点"></a>Base64编码的特点</h3><ul>
<li>Base64编码是编码，不是压缩，编码后只会增加字节数</li>
<li>算法可逆，解码很方便，不用于私密信息通讯</li>
<li>标准的Base64每行为76个字符，行末添加换行符</li>
<li>加密后的字符串只有65种字符，不可打印字符也可传输</li>
<li>在Java层可以通过hook对应方法名来快速定位关键代码</li>
<li>在so层可以通过输入输出的数据和码表来确定算法</li>
</ul>
<h2 id="MD5（消息摘要算法）"><a href="#MD5（消息摘要算法）" class="headerlink" title="MD5（消息摘要算法）"></a>MD5（消息摘要算法）</h2><p><strong>摘要长度为128bit</strong></p>
<h3 id="MD5的java实现"><a href="#MD5的java实现" class="headerlink" title="MD5的java实现"></a>MD5的java实现</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">MessageDigest</span> <span class="variable">md5</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">md5.update(<span class="string">&quot;hyq&quot;</span>.getBytes());</span><br><span class="line">md5.digest()</span><br></pre></td></tr></table></figure>

<h3 id="MD5的一些性质"><a href="#MD5的一些性质" class="headerlink" title="MD5的一些性质"></a>MD5的一些性质</h3><p>加密后的字节数组可以编码成Hex、Base64</p>
<p>没有任何输入，也能计算hash值</p>
<p>碰到加salt的MD5，可以直接输入空的值，得到结果去CMD5查询一下，有可能就得到salt(但是salt不能太长)</p>
<h2 id="SHA（消息摘要算法）"><a href="#SHA（消息摘要算法）" class="headerlink" title="SHA（消息摘要算法）"></a>SHA（消息摘要算法）</h2><p>SHA是一系列算法，以SHA-1、SHA-256、、、命名</p>
<p>除了SHA-1的摘要长度是160bit，别的摘要长度都是后面的数字</p>
<h3 id="SHA的Java实现"><a href="#SHA的Java实现" class="headerlink" title="SHA的Java实现"></a>SHA的Java实现</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">MessageDisgest</span> <span class="variable">sha1</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">&quot;SHA-1&quot;</span>);</span><br><span class="line">sha1.update(<span class="string">&quot;hyq&quot;</span>.getBytes());</span><br><span class="line">sha1.digest();</span><br></pre></td></tr></table></figure>

<h3 id="SHA的一些性质"><a href="#SHA的一些性质" class="headerlink" title="SHA的一些性质"></a>SHA的一些性质</h3><p>加密后的字节数组可以编码成Hex、Base64</p>
<p>没有任何输入，也能计算hash值</p>
<h2 id="MAC系列算法（消息认证码，对称）"><a href="#MAC系列算法（消息认证码，对称）" class="headerlink" title="MAC系列算法（消息认证码，对称）"></a>MAC系列算法（消息认证码，对称）</h2><table>
<thead>
<tr>
<th>算法</th>
<th>摘要长度(bit)</th>
</tr>
</thead>
<tbody><tr>
<td>HmacMD5</td>
<td>128</td>
</tr>
<tr>
<td>HmacSHA1</td>
<td>160</td>
</tr>
<tr>
<td>HmacSHA256</td>
<td>256</td>
</tr>
<tr>
<td>HmacSHA384</td>
<td>384</td>
</tr>
<tr>
<td>HmacSHA512</td>
<td>512</td>
</tr>
<tr>
<td>HmacMD2</td>
<td>128</td>
</tr>
<tr>
<td>HmacMD4</td>
<td>128</td>
</tr>
<tr>
<td>HmacSHA224</td>
<td>224</td>
</tr>
</tbody></table>
<p>MAC算法与MD和SHA的区别是多了一个密钥，密钥可以随便给</p>
<h3 id="MAC的java实现"><a href="#MAC的java实现" class="headerlink" title="MAC的java实现"></a>MAC的java实现</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">SecretKeySpec</span> <span class="variable">secretKeySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(<span class="string">&quot;a12345678&quot;</span>.getBytes(), <span class="string">&quot;HmacSHA1&quot;</span>);</span><br><span class="line"><span class="type">Mac</span> <span class="variable">mac</span> <span class="operator">=</span> Mac.getInstance(secretKeySpec.getAlgorithm());</span><br><span class="line">mac.init(secretKeySpec);</span><br><span class="line">mac.update(<span class="string">&quot;hyq&quot;</span>.getBytes());</span><br><span class="line">mac.doFinla();</span><br></pre></td></tr></table></figure>

<h3 id="MAC的一些性质"><a href="#MAC的一些性质" class="headerlink" title="MAC的一些性质"></a>MAC的一些性质</h3><p>加密后的字节数组可以编码成Hex、Base64</p>
<p>没有任何输入，也能计算hash值</p>
<h2 id="DES（对称）"><a href="#DES（对称）" class="headerlink" title="DES（对称）"></a>DES（对称）</h2><h3 id="DES的java实现"><a href="#DES的java实现" class="headerlink" title="DES的java实现"></a>DES的java实现</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第一种密钥产生方式	不常用，了解下即可</span></span><br><span class="line"><span class="type">DESKeySpec</span> <span class="variable">desKeySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DESKeySpce</span>(<span class="string">&quot;12345678&quot;</span>.getBytes());</span><br><span class="line"><span class="type">SecretKeyFactory</span> <span class="variable">key</span> <span class="operator">=</span> SecretKeyFactory.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line"><span class="type">SecretKey</span> <span class="variable">secretKey</span> <span class="operator">=</span> key.generateSecret(desKeySpec);</span><br><span class="line"></span><br><span class="line"><span class="comment">//第二种密钥产生方式</span></span><br><span class="line"><span class="type">SecretKeySpec</span> <span class="variable">secretKeySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(<span class="string">&quot;12345678&quot;</span>.getBytes(), <span class="string">&quot;DES&quot;</span>);</span><br><span class="line"><span class="type">Cipher</span> <span class="variable">des</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DES&quot;</span>);</span><br><span class="line">des.init(Ciphter.ENCRYPT_MODE, secretKeySpec);</span><br><span class="line">des.doFinal(<span class="string">&quot;hyq&quot;</span>.getBytes());</span><br></pre></td></tr></table></figure>



<h3 id="ECB模式和CBC模式的区别"><a href="#ECB模式和CBC模式的区别" class="headerlink" title="ECB模式和CBC模式的区别"></a>ECB模式和CBC模式的区别</h3><ul>
<li><p>没有指明加密模式和填充方式，表示使用默认的DES&#x2F;ECB&#x2F;PKCS5Padding</p>
</li>
<li><p>加密后的字节数组可以编码成Hex、Base64</p>
</li>
<li><p>DES算法明文按64位进行分组加密</p>
</li>
<li><p>要复现一个对称加密算法，需要得到以下几个东西</p>
<p>明文、key、iv、mode、padding</p>
</li>
<li><p>明文、key、iv需要注意解析方式，而且不一定是字符串形式</p>
</li>
<li><p>如果加密模式是ECB，则不需要iv</p>
</li>
<li><p>如果明文中有两个分组的内容相同，ECB会得到完全一样的密文，CBC不会</p>
</li>
<li><p>加密算法的结果通常与明文等长或者更长，如果变短了，那可能是gzip、protubuf</p>
</li>
</ul>
<h2 id="DESede（对称）"><a href="#DESede（对称）" class="headerlink" title="DESede（对称）"></a>DESede（对称）</h2><p>用第一个密钥加密，然后用第二个密钥解密，最后再用第三个密钥加密</p>
<h3 id="DESede的java实现"><a href="#DESede的java实现" class="headerlink" title="DESede的java实现"></a>DESede的java实现</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 第一种产生密钥的方式</span></span><br><span class="line"><span class="type">DESedeKeySpec</span> <span class="variable">desedeKey</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DESedeKeySpec</span>(<span class="string">&quot;1234567812345678&quot;</span>).getBytes();</span><br><span class="line"><span class="type">SecretKeyFactory</span> <span class="variable">key</span> <span class="operator">=</span> SecretKeyFactory.getInstance(<span class="string">&quot;DESede&quot;</span>);</span><br><span class="line"><span class="type">SecretKeySpec</span> <span class="variable">secretKey</span> <span class="operator">=</span> key.generateSecret(desKeySpec);</span><br><span class="line"><span class="comment">//第二种密钥产生方式</span></span><br><span class="line"><span class="type">SecretKeySpec</span> <span class="variable">secretKeySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(<span class="string">&quot;1234567812345678&quot;</span>.getBytes(), <span class="string">&quot;DESede&quot;</span>);</span><br><span class="line"><span class="type">Ciphter</span> <span class="variable">ciphter_desede</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;DESede&quot;</span>);</span><br><span class="line">ciphter_desede.init(Ciphter.ENCRYPT_MODE, secretKeySpec);</span><br><span class="line">ciphter_desede.doFinal(<span class="string">&quot;hyq&quot;</span>.getBytes());</span><br></pre></td></tr></table></figure>

<h2 id="AES（对称）"><a href="#AES（对称）" class="headerlink" title="AES（对称）"></a>AES（对称）</h2><p>根据密钥长度的不同，可以分为AES128、AES192、AES256</p>
<h3 id="AES的java实现"><a href="#AES的java实现" class="headerlink" title="AES的java实现"></a>AES的java实现</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">SecretKeySpec</span> <span class="variable">key</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(<span class="string">&quot;1234567890abcdef&quot;</span>.getBytes(), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line"><span class="type">IvParamterSpec</span> <span class="variable">iv</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IvParamterSpec</span>(<span class="string">&quot;1234567890abcdef&quot;</span>.getBytes());</span><br><span class="line"><span class="type">Ciphter</span> <span class="variable">aes</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;AES/CBC/PKCS5Padding&quot;</span>);</span><br><span class="line">aes.init(<span class="number">1</span>, key, iv);</span><br><span class="line">aes.doFinal(<span class="string">&quot;a12345678&quot;</span>.getBytes())</span><br></pre></td></tr></table></figure>

<h3 id="ECB模式和CBC模式的区别-1"><a href="#ECB模式和CBC模式的区别-1" class="headerlink" title="ECB模式和CBC模式的区别"></a>ECB模式和CBC模式的区别</h3><p>在对称加密算法里，如果使用NOPadding，加密的明文必须刚好等于分组长度倍数，否则会报错</p>
<p>如果使用PKCS5Padding，会对加密的明文填充1字节-1个分组的长度</p>
<h2 id="RSA-Base64（非对称）"><a href="#RSA-Base64（非对称）" class="headerlink" title="RSA_Base64（非对称）"></a>RSA_Base64（非对称）</h2><h3 id="私钥的格式"><a href="#私钥的格式" class="headerlink" title="私钥的格式"></a>私钥的格式</h3><p>pkcs1格式通常开头是 ——BEGIN RSA PRIVATE KEY——</p>
<p>pkcs8格式通常开头是 ——BEGIN PRIVATE KEY——</p>
<p>Java中的私钥必须是pkcs8格式</p>
<h3 id="RSA密钥的解析"><a href="#RSA密钥的解析" class="headerlink" title="RSA密钥的解析"></a>RSA密钥的解析</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">byte</span>[] keyBytes = Base64Decoder.decodeBuffer(key);</span><br><span class="line"><span class="type">X509EncodeKeySpec</span> <span class="variable">keySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">X509EncodedKeySPec</span>(keyBytes);</span><br><span class="line"><span class="type">KeyFactory</span> <span class="variable">keyFactory</span> <span class="operator">=</span> KeyFactory.getInstance(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line"><span class="type">PublicKey</span> <span class="variable">publicKey</span> <span class="operator">=</span> keyFactory.generatePublic(keySpec);</span><br><span class="line"></span><br><span class="line"><span class="type">byte</span>[] keyBytes = Base64Decoder.decodeBuffer(key);</span><br><span class="line"><span class="type">PKCS8EncodeKeySpec</span> <span class="variable">keySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PKCS8EncodedKeySpec</span>(keyBytes);</span><br><span class="line"><span class="type">KeyFactory</span> <span class="variable">keyFactory</span> <span class="operator">=</span> KeyFactory.getInstance(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line"><span class="type">PrivateKey</span> <span class="variable">privateKey</span> <span class="operator">=</span> keyFactory.generetePrivate(keySpec);</span><br></pre></td></tr></table></figure>

<h3 id="RSA加解密"><a href="#RSA加解密" class="headerlink" title="RSA加解密"></a>RSA加解密</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;RSA/None/NoPadding&quot;</span>);</span><br><span class="line">cipher.init(Cipher.ENCRYPT_MODE, publicKey);</span><br><span class="line"><span class="type">byte</span>[] bt_encrypted = cipher.doFinal(bt_plaintext);</span><br><span class="line"></span><br><span class="line"><span class="type">Cipher</span> <span class="variable">cipher</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;RSA/None/NoPadding&quot;</span>);</span><br><span class="line">cipher.init(Cipher.DECRYPT_MODE, privateKey);</span><br><span class="line"><span class="type">byte</span>[] bt_orinial = cipher.doFinal(bt_encrypted);</span><br></pre></td></tr></table></figure>

<h3 id="RSA模式和填充细节"><a href="#RSA模式和填充细节" class="headerlink" title="RSA模式和填充细节"></a>RSA模式和填充细节</h3><ul>
<li><p>None模式和ECB模式是一致的</p>
</li>
<li><p>NoPadding</p>
<p>明文最多字节数位密钥字节数</p>
<p>密文与密钥等长</p>
<p>填充字节0，加密后的密文不变</p>
</li>
<li><p>pkcs1padding</p>
<p>明文最大字节数为密钥字节数-11</p>
<p>密文与密钥等长</p>
<p>每一次的填充不一样，使得加密后的密文会变</p>
</li>
<li><p>把pkcs1padding加密后的密文，用NoPadding去解密，会得到填充的字节</p>
</li>
<li><p>没有指明加密模式和填充方式，表示使用默认的RSA&#x2F;ECB&#x2F;NOPadding</p>
</li>
<li><p>加密后的字节数组可以编码成Hex、Base64</p>
</li>
</ul>
<h2 id="RSA-Hex"><a href="#RSA-Hex" class="headerlink" title="RSA_Hex"></a>RSA_Hex</h2><h3 id="RSA密钥的解析-1"><a href="#RSA密钥的解析-1" class="headerlink" title="RSA密钥的解析"></a>RSA密钥的解析</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">BigInteger</span> <span class="variable">N</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(stringN, <span class="number">16</span>);</span><br><span class="line"><span class="type">BigInteger</span> <span class="variable">E</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(stringE, <span class="number">16</span>);</span><br><span class="line"><span class="type">RSAPublicKeySpec</span> <span class="variable">spec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RSAPublicKeySpec</span>(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line"><span class="type">PublicKey</span> <span class="variable">publicKey</span> <span class="operator">=</span> keyFactory.getInstance(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line"><span class="type">PublicKey</span> <span class="variable">publicKey</span> <span class="operator">=</span> keyFactory.generatePublic(spec);</span><br></pre></td></tr></table></figure>

<h2 id="多种加密算法的常见结合套路"><a href="#多种加密算法的常见结合套路" class="headerlink" title="多种加密算法的常见结合套路"></a>多种加密算法的常见结合套路</h2><p>随机生成AES密钥A</p>
<p>A密钥用于AES加密数据，得到数据密文B</p>
<p>使用RSA对A密钥加密，得到密钥密文C</p>
<p>提交密钥密文C和数据密文B给服务器</p>
<h4 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.databinding.ActivityMainBinding;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> okio.ByteString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Used to load the &#x27;demo&#x27; library on application startup.</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;demo&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ActivityMainBinding binding;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        binding = ActivityMainBinding.inflate(getLayoutInflater());</span><br><span class="line">        setContentView(binding.getRoot());</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//客户端加密部分 cipherText和cipherKey 需要同时提交给服务器</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">AESKey</span> <span class="operator">=</span> generateAESKey();</span><br><span class="line">            <span class="type">String</span> <span class="variable">cipherText</span> <span class="operator">=</span> AES.encryptAES(<span class="string">&quot;hyq&quot;</span>, AESKey);</span><br><span class="line">            <span class="type">String</span> <span class="variable">cipherKey</span> <span class="operator">=</span> RSA_Base64.encryptByPublicKey(AESKey);</span><br><span class="line">            <span class="comment">//服务器解密部分</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">plainKey</span> <span class="operator">=</span> RSA_Base64.decryptByPrivateKey(cipherKey);</span><br><span class="line">            <span class="type">String</span> <span class="variable">plainText</span> <span class="operator">=</span> AES.decryptAES(ByteString.decodeBase64(cipherText).toByteArray(), plainKey);</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A native method that is implemented by the &#x27;demo&#x27; native library,</span></span><br><span class="line"><span class="comment">     * which is packaged with this application.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> String <span class="title function_">stringFromJNI</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateAESKey</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">stringBuffer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">random_i</span> <span class="operator">=</span> random.nextInt(<span class="number">100</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span> + Integer.toHexString(random_i);</span><br><span class="line">            temp = temp.substring(temp.length() - <span class="number">2</span>);</span><br><span class="line">            stringBuffer.append(temp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">resultKey</span> <span class="operator">=</span> stringBuffer.toString();</span><br><span class="line">        <span class="keyword">return</span> resultKey;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="AES-java"><a href="#AES-java" class="headerlink" title="AES.java"></a>AES.java</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.security.InvalidAlgorithmParameterException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> okio.ByteString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AES</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encryptAES</span><span class="params">(String plainText, String AESKey)</span> <span class="keyword">throws</span> NoSuchPaddingException, NoSuchAlgorithmException, InvalidAlgorithmParameterException, InvalidKeyException, IllegalBlockSizeException, BadPaddingException &#123;</span><br><span class="line">        <span class="type">SecretKeySpec</span> <span class="variable">aesKey</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(ByteString.decodeHex(AESKey).toByteArray(), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line">        <span class="type">IvParameterSpec</span> <span class="variable">ivParameterSpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IvParameterSpec</span>(<span class="string">&quot;0123456789abcdef&quot;</span>.getBytes());</span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">aes</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;AES/CBC/PKCS5Padding&quot;</span>);</span><br><span class="line">        aes.init(Cipher.ENCRYPT_MODE, aesKey, ivParameterSpec);</span><br><span class="line">        <span class="type">byte</span>[] bytes = aes.doFinal(plainText.getBytes());</span><br><span class="line">        <span class="type">ByteString</span> <span class="variable">of</span> <span class="operator">=</span> ByteString.of(bytes);</span><br><span class="line">        <span class="keyword">return</span> of.base64();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">decryptAES</span><span class="params">(String plainText, String AESKey)</span> <span class="keyword">throws</span> InvalidAlgorithmParameterException, InvalidKeyException, NoSuchPaddingException, NoSuchAlgorithmException, IllegalBlockSizeException, BadPaddingException &#123;</span><br><span class="line">        <span class="type">SecretKeySpec</span> <span class="variable">aesKey</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(ByteString.decodeHex(AESKey).toByteArray(), <span class="string">&quot;AES&quot;</span>);</span><br><span class="line">        <span class="type">IvParameterSpec</span> <span class="variable">ivParameterSpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IvParameterSpec</span>(<span class="string">&quot;0123456789abcdef&quot;</span>.getBytes());</span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">aes</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;AES/CBC/PKCS5Padding&quot;</span>);</span><br><span class="line">        aes.init(Cipher.DECRYPT_MODE, aesKey, ivParameterSpec);</span><br><span class="line">        <span class="type">byte</span>[] bytes = aes.doFinal(plainText.getBytes());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(bytes);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="RSA-Base64-java"><a href="#RSA-Base64-java" class="headerlink" title="RSA_Base64.java"></a>RSA_Base64.java</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.security.KeyFactory;</span><br><span class="line"><span class="keyword">import</span> java.security.PrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.Provider;</span><br><span class="line"><span class="keyword">import</span> java.security.PublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.X509EncodedKeySpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> okio.ByteString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RSA_Base64</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">publicKeyBase64</span> <span class="operator">=</span> <span class="string">&quot;MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDxRQHxL/8xZ1EaNmQBGZnpMiCY&quot;</span> +</span><br><span class="line">            <span class="string">&quot;7gRzog6nDjfBJacytEiVJnJRuq1V/D+JKaXDwetsCnSUaz65LCFHU09OSEYee5oC&quot;</span> +</span><br><span class="line">            <span class="string">&quot;iI0ql21EA306c91oT/fQpPngQGZHLUtDOUdJVlAKnicCvmR24NqyNKFuY8L0cnB1&quot;</span> +</span><br><span class="line">            <span class="string">&quot;zcax73Rf+Ctf/lxAOwIDAQAB&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">privateKeyBase64</span> <span class="operator">=</span> <span class="string">&quot;MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAPFFAfEv/zFnURo2\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;ZAEZmekyIJjuBHOiDqcON8ElpzK0SJUmclG6rVX8P4kppcPB62wKdJRrPrksIUdT\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;T05IRh57mgKIjSqXbUQDfTpz3WhP99Ck+eBAZkctS0M5R0lWUAqeJwK+ZHbg2rI0\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;oW5jwvRycHXNxrHvdF/4K1/+XEA7AgMBAAECgYEAsGkDrYWps0bW7zKb1o4Qkojb\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;etZ2HNJ+ojlsHObaJOHbPGs7JXU4bmmdTz5LfSIacAoJCciMuTqCLrPEhfmkghPq\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;U2MjyjfqYdXALoP7l/vt6QmjY/g1IAsaZN9nFhyjJ2WzgOx1f7gZj4NBSvTdSj7H\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;m5E24zkm+p7Qw1z6/mkCQQD7WSXAXcv2v3Vo6qi1FUlkzQgCQLFYqXNSOSPpno3y\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;oohUFIkMj0bYGbVE1LzV30Rb6Z8e8yQAByw6l8RuGb2PAkEA9bwb2euyOe6CcqpE\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;PNFc+7UlOJAy5epVFKHbu0aNivVpU0hsphqjIGXJGHYTspyEOLqtzILqKPZr6pru\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;WvJUlQJBAJoImQUZtlyCGs7wN/G5mN/ocscGpGikd+Lk16hdHbqbdpaoexCyYYUf\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;xCHpicw75mW5d2V9Ngu6WZWS2rNqnOsCQCoMK//X8sEy7KNOOyrk8DIpxtqs4eix\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;dil3oK+k3OdgIsubYuvxNuR+RjCnU6uGWKGUX9TUudiUgda89/gb6xkCQFm8gD6n\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;AyN+PPPKRq2M84+cAbnvjdIAY3OFHfkaoWCtEj5DR0UDuVv7jN7+re2D7id/GkAe\n&quot;</span> +</span><br><span class="line">            <span class="string">&quot;FAmhvYQwwLnifrw=&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> PublicKey <span class="title function_">generatePublicKey</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">byte</span>[] publicKeyBase64Bytes = ByteString.decodeBase64(publicKeyBase64).toByteArray();</span><br><span class="line">        <span class="type">X509EncodedKeySpec</span> <span class="variable">x509EncodedKeySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">X509EncodedKeySpec</span>(publicKeyBase64Bytes);</span><br><span class="line">        <span class="type">KeyFactory</span> <span class="variable">keyFactory</span> <span class="operator">=</span> KeyFactory.getInstance(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> keyFactory.generatePublic(x509EncodedKeySpec);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> PrivateKey <span class="title function_">generatePrivateKey</span><span class="params">()</span> <span class="keyword">throws</span>  Exception&#123;</span><br><span class="line">        <span class="type">byte</span>[] privateKeyBase64Bytes = ByteString.decodeBase64(privateKeyBase64).toByteArray();</span><br><span class="line">        <span class="type">PKCS8EncodedKeySpec</span> <span class="variable">pkcs8EncodedKeySpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PKCS8EncodedKeySpec</span>(privateKeyBase64Bytes);</span><br><span class="line">        <span class="type">KeyFactory</span> <span class="variable">keyFactory</span> <span class="operator">=</span> KeyFactory.getInstance(<span class="string">&quot;RSA&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> keyFactory.generatePrivate(pkcs8EncodedKeySpec);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encryptByPublicKey</span><span class="params">(String plainText)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">PublicKey</span> <span class="variable">publicKey</span> <span class="operator">=</span> generatePublicKey();</span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">instance</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;RSA/ECB/PKCS1Padding&quot;</span>);</span><br><span class="line">        instance.init(Cipher.ENCRYPT_MODE, publicKey);</span><br><span class="line">        <span class="type">byte</span>[] bytes = instance.doFinal(plainText.getBytes());</span><br><span class="line">        <span class="type">ByteString</span> <span class="variable">of</span> <span class="operator">=</span> ByteString.of(bytes);</span><br><span class="line">        <span class="keyword">return</span> of.base64();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">decryptByPrivateKey</span><span class="params">(String cipherText)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">PrivateKey</span> <span class="variable">privateKey</span> <span class="operator">=</span> generatePrivateKey();</span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">instance</span> <span class="operator">=</span> Cipher.getInstance(<span class="string">&quot;RSA/ECB/PKCS1Padding&quot;</span>);</span><br><span class="line">        instance.init(Cipher.DECRYPT_MODE, privateKey);</span><br><span class="line">        <span class="type">byte</span>[] bytes = instance.doFinal(cipherText.getBytes());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(bytes);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数字签名算法"><a href="#数字签名算法" class="headerlink" title="数字签名算法"></a>数字签名算法</h2><h3 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">PrivateKey</span> <span class="variable">priK</span> <span class="operator">=</span> getPrivateKey(str_priK);</span><br><span class="line"><span class="type">Signature</span> <span class="variable">sig</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;SHA256withRSA&quot;</span>);</span><br><span class="line">sig.initSign(priK);</span><br><span class="line">sig.update(data);</span><br><span class="line">sig.sign();</span><br></pre></td></tr></table></figure>

<h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">PublicKey</span> <span class="variable">pubK</span> <span class="operator">=</span> getPublicKey(str_pubK);</span><br><span class="line"><span class="type">Signature</span> <span class="variable">sig</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;SHA256withRSA&quot;</span>);</span><br><span class="line">sig.initVerify(pubK);</span><br><span class="line">sig.update(data);</span><br><span class="line">sig.verify(sign);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.fctf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.util.Base64;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.activity.EdgeToEdge;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"><span class="keyword">import</span> androidx.core.graphics.Insets;</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.ViewCompat;</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.fctf.databinding.ActivityMainBinding;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.spec.KeySpec;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.Cipher;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKeyFactory;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.DESKeySpec;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.IvParameterSpec;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> okio.ByteString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> ActivityMainBinding binding;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">key0</span> <span class="operator">=</span> <span class="string">&quot;82305002&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">iv0</span> <span class="operator">=</span> <span class="string">&quot;82505002&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">getNum</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNum</span><span class="params">(<span class="type">int</span> i)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.num = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        binding = ActivityMainBinding.inflate(getLayoutInflater());</span><br><span class="line">        setContentView(binding.getRoot());</span><br><span class="line">        <span class="keyword">final</span> <span class="type">TextView</span> <span class="variable">textView</span> <span class="operator">=</span> binding.textView;</span><br><span class="line">        <span class="type">Button</span> <span class="variable">button</span> <span class="operator">=</span> binding.button;</span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    MainActivity.a(MainActivity.<span class="built_in">this</span>, textView, button);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (BadPaddingException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(decrypt(<span class="string">&quot;whyysqwmstoryhzcontinues&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalBlockSizeException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (BadPaddingException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">(MainActivity <span class="built_in">this</span>$<span class="number">0</span>, TextView tv, Button button)</span> <span class="keyword">throws</span> IllegalBlockSizeException, BadPaddingException &#123;</span><br><span class="line">        <span class="type">MainActivity</span> <span class="variable">mainActivity</span> <span class="operator">=</span> <span class="built_in">this</span>$<span class="number">0</span>;</span><br><span class="line">        tv.setText(String.valueOf(<span class="built_in">this</span>$<span class="number">0.</span>num));</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>$<span class="number">0.</span>check() == <span class="number">20220422</span>)&#123;</span><br><span class="line">            Toast.makeText(mainActivity, <span class="string">&quot;Congratuations!!!&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            tv.setText(<span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">this</span>$<span class="number">0.</span>decrypt(<span class="string">&quot;whyysqwmstoryhzcontinues&quot;</span>) + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="type">int</span> <span class="title function_">check</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="built_in">this</span>.num + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">this</span>.num = i;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> String <span class="title function_">decrypt</span><span class="params">(String str)</span> <span class="keyword">throws</span> IllegalBlockSizeException, BadPaddingException &#123;</span><br><span class="line">        <span class="type">Cipher</span> <span class="variable">des</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">byte</span>[] bytes =<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; a = Class.forName(d(<span class="string">&quot;amF2YS5zZWN1cml0eS5NZXNzYWdlRGlnZXN0&quot;</span>));</span><br><span class="line">            <span class="type">Method</span> <span class="variable">b</span> <span class="operator">=</span> a.getMethod(d(<span class="string">&quot;Z2V0SW5zdGFuY2U=&quot;</span>), String.class);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">c</span> <span class="operator">=</span> b.invoke(<span class="literal">null</span>, d(<span class="string">&quot;TUQ1&quot;</span>));</span><br><span class="line">            <span class="type">Method</span> <span class="variable">e</span> <span class="operator">=</span> a.getMethod(d(<span class="string">&quot;dXBkYXRl&quot;</span>), <span class="type">byte</span>[].class);</span><br><span class="line">            e.invoke(c, key0.getBytes());</span><br><span class="line">            <span class="type">Method</span> <span class="variable">f</span> <span class="operator">=</span> a.getMethod(d(<span class="string">&quot;ZGlnZXN0&quot;</span>));</span><br><span class="line">            <span class="type">byte</span>[] k = (<span class="type">byte</span>[]) f.invoke(c);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment">//反射des</span></span><br><span class="line"><span class="comment">//            //DESKeySpec dsk = new DESKeySpec(k);</span></span><br><span class="line"><span class="comment">//            Class&lt;?&gt;  DESKeySpec = Class.forName(&quot;java.security.spec.KeySpec&quot;);</span></span><br><span class="line"><span class="comment">//            Constructor&lt;?&gt; dESKeySpecConstructor = DESKeySpec.getConstructor(byte[].class);</span></span><br><span class="line"><span class="comment">//            Object dsk =  dESKeySpecConstructor.newInstance(k);</span></span><br><span class="line"><span class="comment">//            //SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(&quot;DES&quot;);</span></span><br><span class="line"><span class="comment">//            Class&lt;?&gt; SecretKeyFactory = Class.forName(&quot;javax.crypto.SecretKeyFactory&quot;);</span></span><br><span class="line"><span class="comment">//            Method getInstance = SecretKeyFactory.getMethod(&quot;getInstance&quot;, String.class);</span></span><br><span class="line"><span class="comment">//            Object keyFactory = getInstance.invoke(null, &quot;DES&quot;);</span></span><br><span class="line"><span class="comment">//            SecretKey key = keyFactory.generateSecret(dsk);</span></span><br><span class="line"><span class="comment">//            Method generateSecret = SecretKeyFactory.getMethod();</span></span><br><span class="line"><span class="comment">//            IvParameterSpec iv = new IvParameterSpec(iv0.getBytes());</span></span><br><span class="line"><span class="comment">//            des = Cipher.getInstance(&quot;DES/CBC/PKCS5Padding&quot;);</span></span><br><span class="line"><span class="comment">//            des.init(Cipher.ENCRYPT_MODE, key, iv);</span></span><br><span class="line"><span class="comment">//            bytes = des.doFinal(str.getBytes());</span></span><br><span class="line">            Class&lt;?&gt; desKeySpecClass = Class.forName(<span class="string">&quot;javax.crypto.spec.DESKeySpec&quot;</span>);</span><br><span class="line">            Constructor&lt;?&gt; desKeySpecConstructor = desKeySpecClass.getConstructor(<span class="type">byte</span>[].class);</span><br><span class="line">            <span class="type">KeySpec</span> <span class="variable">dsk</span> <span class="operator">=</span> (KeySpec) desKeySpecConstructor.newInstance(k);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取 SecretKeyFactory 实例</span></span><br><span class="line">            Class&lt;?&gt; secretKeyFactoryClass = Class.forName(<span class="string">&quot;javax.crypto.SecretKeyFactory&quot;</span>);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">getInstanceMethod</span> <span class="operator">=</span> secretKeyFactoryClass.getMethod(<span class="string">&quot;getInstance&quot;</span>, String.class);</span><br><span class="line">            <span class="type">SecretKeyFactory</span> <span class="variable">keyFactory</span> <span class="operator">=</span> (SecretKeyFactory) getInstanceMethod.invoke(<span class="literal">null</span>, <span class="string">&quot;DES&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 生成 SecretKey</span></span><br><span class="line">            <span class="type">Method</span> <span class="variable">generateSecretMethod</span> <span class="operator">=</span> secretKeyFactoryClass.getMethod(<span class="string">&quot;generateSecret&quot;</span>, KeySpec.class);</span><br><span class="line">            <span class="type">SecretKey</span> <span class="variable">key</span> <span class="operator">=</span> (SecretKey) generateSecretMethod.invoke(keyFactory, dsk);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 创建 IvParameterSpec 实例</span></span><br><span class="line">            Class&lt;?&gt; ivParameterSpecClass = Class.forName(<span class="string">&quot;javax.crypto.spec.IvParameterSpec&quot;</span>);</span><br><span class="line">            Constructor&lt;?&gt; ivParameterSpecConstructor = ivParameterSpecClass.getConstructor(<span class="type">byte</span>[].class);</span><br><span class="line">            <span class="type">IvParameterSpec</span> <span class="variable">iv</span> <span class="operator">=</span> (IvParameterSpec) ivParameterSpecConstructor.newInstance(iv0.getBytes());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取 Cipher 实例</span></span><br><span class="line">            Class&lt;?&gt; cipherClass = Class.forName(<span class="string">&quot;javax.crypto.Cipher&quot;</span>);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">getInstanceCipherMethod</span> <span class="operator">=</span> cipherClass.getMethod(<span class="string">&quot;getInstance&quot;</span>, String.class);</span><br><span class="line">            des = (Cipher) getInstanceCipherMethod.invoke(<span class="literal">null</span>, <span class="string">&quot;DES/CBC/PKCS5Padding&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 初始化 Cipher</span></span><br><span class="line">            <span class="type">Method</span> <span class="variable">initMethod</span> <span class="operator">=</span> cipherClass.getMethod(<span class="string">&quot;init&quot;</span>, <span class="type">int</span>.class, java.security.Key.class, java.security.spec.AlgorithmParameterSpec.class);</span><br><span class="line">            initMethod.invoke(des, Cipher.ENCRYPT_MODE, key, iv);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 执行加密操作</span></span><br><span class="line">            <span class="type">Method</span> <span class="variable">doFinalMethod</span> <span class="operator">=</span> cipherClass.getMethod(<span class="string">&quot;doFinal&quot;</span>, <span class="type">byte</span>[].class);</span><br><span class="line">            bytes = (<span class="type">byte</span>[]) doFinalMethod.invoke(des, str.getBytes());</span><br><span class="line"><span class="comment">//            MessageDigest md5 = MessageDigest.getInstance(&quot;MD5&quot;);</span></span><br><span class="line"><span class="comment">//            md5.update(&quot;a12345678&quot;.getBytes());</span></span><br><span class="line"><span class="comment">//            byte[] bytes=md5.digest();</span></span><br><span class="line"><span class="comment">//            ByteString byteString = ByteString.of(bytes);</span></span><br><span class="line"><span class="comment">//            String key = byteString.hex();</span></span><br><span class="line"><span class="comment">//            System.out.println(key);</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ByteString</span> <span class="variable">byteString</span> <span class="operator">=</span> ByteString.of(bytes);</span><br><span class="line">        <span class="keyword">return</span> byteString.hex();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">d</span><span class="params">(String str)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(Base64.decode(str, <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">lele</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/04/17/%E5%AF%86%E7%A0%81%E5%AD%A6Java/">http://example.com/2025/04/17/%E5%AF%86%E7%A0%81%E5%AD%A6Java/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Hexo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/04/18/Matlab%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" title="Matlab快速入门"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Matlab快速入门</div></div></a></div><div class="next-post pull-right"><a href="/2025/04/16/%E5%88%9B%E5%BB%BAreleaseAPK/" title="创建releaseAPK"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">创建releaseAPK</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87%EF%BC%9A%E4%BA%86%E8%A7%A3%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E7%AE%97%E6%B3%95"><span class="toc-text">学习目标：了解一些常见的密码学算法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Hex%E7%BC%96%E7%A0%81"><span class="toc-text">Hex编码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFHex%E7%BC%96%E7%A0%81"><span class="toc-text">什么是Hex编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%AE%89%E5%8D%93%E5%BD%93%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-text">在安卓当中使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hex%E7%BC%96%E7%A0%81%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">Hex编码的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%86%99%E4%BB%A3%E7%A0%81"><span class="toc-text">手写代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Base64"><span class="toc-text">Base64</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFbase64"><span class="toc-text">什么是base64</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-text">Base64的应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64%E7%BC%96%E7%A0%81%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">Base64编码的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#java%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">java中的实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#android%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">android中的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%EF%BC%8C%E4%BD%BF%E7%94%A8ByteString%E7%B1%BB"><span class="toc-text">第一种，使用ByteString类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%EF%BC%8C%E5%9C%A8android-studio%E4%B8%AD%E4%BD%BF%E7%94%A8java%E5%BA%93"><span class="toc-text">第二种，在android studio中使用java库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%A7%8D%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%AE%89%E5%8D%93%E8%87%AA%E5%B8%A6%E7%9A%84"><span class="toc-text">第三种，使用安卓自带的</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64%E7%A0%81%E8%A1%A8%E7%9A%84%E5%A6%99%E7%94%A8"><span class="toc-text">Base64码表的妙用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64%E7%BC%96%E7%A0%81%E7%BB%86%E8%8A%82"><span class="toc-text">Base64编码细节</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Base64%E7%BC%96%E7%A0%81%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-text">Base64编码的特点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MD5%EF%BC%88%E6%B6%88%E6%81%AF%E6%91%98%E8%A6%81%E7%AE%97%E6%B3%95%EF%BC%89"><span class="toc-text">MD5（消息摘要算法）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MD5%E7%9A%84java%E5%AE%9E%E7%8E%B0"><span class="toc-text">MD5的java实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MD5%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%A7%E8%B4%A8"><span class="toc-text">MD5的一些性质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SHA%EF%BC%88%E6%B6%88%E6%81%AF%E6%91%98%E8%A6%81%E7%AE%97%E6%B3%95%EF%BC%89"><span class="toc-text">SHA（消息摘要算法）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SHA%E7%9A%84Java%E5%AE%9E%E7%8E%B0"><span class="toc-text">SHA的Java实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHA%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%A7%E8%B4%A8"><span class="toc-text">SHA的一些性质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MAC%E7%B3%BB%E5%88%97%E7%AE%97%E6%B3%95%EF%BC%88%E6%B6%88%E6%81%AF%E8%AE%A4%E8%AF%81%E7%A0%81%EF%BC%8C%E5%AF%B9%E7%A7%B0%EF%BC%89"><span class="toc-text">MAC系列算法（消息认证码，对称）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MAC%E7%9A%84java%E5%AE%9E%E7%8E%B0"><span class="toc-text">MAC的java实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MAC%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%A7%E8%B4%A8"><span class="toc-text">MAC的一些性质</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DES%EF%BC%88%E5%AF%B9%E7%A7%B0%EF%BC%89"><span class="toc-text">DES（对称）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DES%E7%9A%84java%E5%AE%9E%E7%8E%B0"><span class="toc-text">DES的java实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ECB%E6%A8%A1%E5%BC%8F%E5%92%8CCBC%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">ECB模式和CBC模式的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DESede%EF%BC%88%E5%AF%B9%E7%A7%B0%EF%BC%89"><span class="toc-text">DESede（对称）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DESede%E7%9A%84java%E5%AE%9E%E7%8E%B0"><span class="toc-text">DESede的java实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AES%EF%BC%88%E5%AF%B9%E7%A7%B0%EF%BC%89"><span class="toc-text">AES（对称）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AES%E7%9A%84java%E5%AE%9E%E7%8E%B0"><span class="toc-text">AES的java实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ECB%E6%A8%A1%E5%BC%8F%E5%92%8CCBC%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB-1"><span class="toc-text">ECB模式和CBC模式的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA-Base64%EF%BC%88%E9%9D%9E%E5%AF%B9%E7%A7%B0%EF%BC%89"><span class="toc-text">RSA_Base64（非对称）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%81%E9%92%A5%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-text">私钥的格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA%E5%AF%86%E9%92%A5%E7%9A%84%E8%A7%A3%E6%9E%90"><span class="toc-text">RSA密钥的解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-text">RSA加解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%A1%AB%E5%85%85%E7%BB%86%E8%8A%82"><span class="toc-text">RSA模式和填充细节</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA-Hex"><span class="toc-text">RSA_Hex</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA%E5%AF%86%E9%92%A5%E7%9A%84%E8%A7%A3%E6%9E%90-1"><span class="toc-text">RSA密钥的解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%A7%8D%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E5%B8%B8%E8%A7%81%E7%BB%93%E5%90%88%E5%A5%97%E8%B7%AF"><span class="toc-text">多种加密算法的常见结合套路</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MainActivity-java"><span class="toc-text">MainActivity.java</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES-java"><span class="toc-text">AES.java</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA-Base64-java"><span class="toc-text">RSA_Base64.java</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95"><span class="toc-text">数字签名算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%BE%E5%90%8D"><span class="toc-text">签名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81"><span class="toc-text">验证</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By lele</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="30" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>