<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Mterial Design | Hexo</title><meta name="author" content="lele"><meta name="copyright" content="lele"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Material Design什么是Material DesingMaterial Design是由Google的设计工程师们基于传统优秀的设计原则，结合丰富的创意和科 学技术所开发的一套全新的界面设计语言，包含了视觉、运动、互动效果等特性。 ToolbarActionBar，每个Activity最顶部的那个标题栏其实就是ActionBar。不过ActionBar由于其设计的原因，被限定只能位于A">
<meta property="og:type" content="article">
<meta property="og:title" content="Mterial Design">
<meta property="og:url" content="http://example.com/2025/01/11/Mterial-Design/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Material Design什么是Material DesingMaterial Design是由Google的设计工程师们基于传统优秀的设计原则，结合丰富的创意和科 学技术所开发的一套全新的界面设计语言，包含了视觉、运动、互动效果等特性。 ToolbarActionBar，每个Activity最顶部的那个标题栏其实就是ActionBar。不过ActionBar由于其设计的原因，被限定只能位于A">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg">
<meta property="article:published_time" content="2025-01-11T12:31:15.000Z">
<meta property="article:modified_time" content="2025-03-25T12:42:45.947Z">
<meta property="article:author" content="lele">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" href="/image/tx.jpg"><link rel="canonical" href="http://example.com/2025/01/11/Mterial-Design/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Mterial Design',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-25 20:42:45'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/tx.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">135</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Hexo"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/test.gif"/><span class="site-name">Hexo</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Mterial Design</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-01-11T12:31:15.000Z" title="发表于 2025-01-11 20:31:15">2025-01-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-03-25T12:42:45.947Z" title="更新于 2025-03-25 20:42:45">2025-03-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Android%E5%BC%80%E5%8F%91/">Android开发</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">13.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>57分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Mterial Design"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Material-Design"><a href="#Material-Design" class="headerlink" title="Material Design"></a>Material Design</h1><h2 id="什么是Material-Desing"><a href="#什么是Material-Desing" class="headerlink" title="什么是Material Desing"></a>什么是Material Desing</h2><p>Material Design是由Google的设计工程师们基于传统优秀的设计原则，结合丰富的创意和科 学技术所开发的一套全新的界面设计语言，包含了视觉、运动、互动效果等特性。</p>
<h2 id="Toolbar"><a href="#Toolbar" class="headerlink" title="Toolbar"></a>Toolbar</h2><p>ActionBar，每个Activity最顶部的那个标题栏其实就是ActionBar。不过ActionBar由于其设计的原因，被限定只能位于Activity的顶部，从而不能实现一些 Material Design的效果，因此官方现在已经不再建议使用ActionBar了</p>
<p>Toolbar的强大之处在于，它不仅继承了ActionBar的所有功能，而且灵活性很高，可以配合其 他控件完成一些Material Design的效果，下面我们就来具体学习一下。</p>
<p>首先你要知道，任何一个新建的项目，默认都是会显示ActionBar的，这个想必你已经见识过太 多次了。那么这个ActionBar到底是从哪里来的呢？其实这是根据项目中指定的主题来显示的。 打开AndroidManifest.xml文件看一下，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:theme</span>=<span class="string">&quot;@style/AppTheme&quot;</span>&gt;</span> </span><br><span class="line">     ... </span><br><span class="line"><span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到，这里使用android:theme属性指定了一个AppTheme的主题。那么这个 AppTheme又是在哪里定义的呢？打开res&#x2F;values&#x2F;theme.xml文件，代码如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span> </span><br><span class="line">     <span class="comment">&lt;!-- Base application theme. --&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;AppTheme&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.AppCompat.Light.DarkActionBar&quot;</span>&gt;</span><span class="language-xml"> </span></span><br><span class="line"><span class="language-xml">         <span class="comment">&lt;!-- Customize your theme here. --&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimary&quot;</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimaryDark&quot;</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorAccent&quot;</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">     </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里定义了一个叫AppTheme的主题，然后指定它的parent主题是 Theme.AppCompat.Light. DarkActionBar。这个DarkActionBar是一个深色的ActionBar 主题，我们之前所有的项目中自带的ActionBar就是因为指定了这个主题才出现的。</p>
<p>而现在我们准备使用Toolbar来替代ActionBar，因此需要指定一个不带ActionBar的主题，通 常有Theme.AppCompat.NoActionBar 和Theme.AppCompat.Light.NoActionBar这两种 主题可选。其中Theme.AppCompat.NoActionBar表示深色主题，它会将界面的主体颜色设 成深色，陪衬颜色设成浅色。而Theme.AppCompat.Light.NoActionBar表示浅色主题，它 会将界面的主体颜色设成浅色，陪衬颜色设成深色。具体的效果你可以自己动手试一试，这里 由于我们之前的程序一直都是以浅色为主的，那么我就选用浅色主题了，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span>  </span><br><span class="line">     <span class="comment">&lt;!-- Base application theme. --&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;AppTheme&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.AppCompat.Light.NoActionBar&quot;</span>&gt;</span><span class="language-xml"> </span></span><br><span class="line"><span class="language-xml">         <span class="comment">&lt;!-- Customize your theme here. --&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimary&quot;</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimaryDark&quot;</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorAccent&quot;</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">     </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>观察一下AppTheme中的属性重写，这里重写了colorPrimary、colorPrimaryDark和 colorAccent这3个属性的颜色。那么这3个属性分别代表什么位置的颜色呢？我用语言比较难 描述清楚，还是通过一张图来理解一下吧，如图12.2所示。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../image/toolbar.png"></p>
<p>现在我们已经将ActionBar隐藏起来了，那么接下来看一看如何使用Toolbar来替代 ActionBar。修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:popupTheme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>由于我们刚才在styles.xml中将程序的 主题指定成了浅色主题，因此Toolbar现在也是浅色主题，那么Toolbar上面的各种元素就会自 动使用深色系，从而和主体颜色区别开。但是之前使用ActionBar时文字都是白色的，现在变成 黑色的会很难看。那么为了能让Toolbar单独使用深色主题，这里我们使用了android:theme 属性，将Toolbar的主题指定成了ThemeOverlay.AppCompat.Dark.ActionBar。但是这样指 定之后又会出现新的问题，如果Toolbar中有菜单按钮（我们在3.2.5小节中学过），那么弹出 的菜单项也会变成深色主题，这样就再次变得十分难看了，于是这里又使用了 app:popupTheme属性，单独将弹出的菜单项指定成了浅色主题。</p>
<p>写完了布局，接下来我们修改MainActivity，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>() &#123; </span><br><span class="line">     <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123; </span><br><span class="line">         <span class="keyword">super</span>.onCreate(savedInstanceState) </span><br><span class="line">         setContentView(R.layout.activity_main) </span><br><span class="line">         setSupportActionBar(toolbar) </span><br><span class="line">     &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>这里关键的代码只有一句，调用setSupportActionBar()方法并将Toolbar的实例传入，这 样我们就做到既使用了Toolbar，又让它的外观与功能都和ActionBar一致了</p>
<p>接下来我们再学习一些Toolbar比较常用的功能吧，比如修改标题栏上显示的文字内容。这段文 字内容是在AndroidManifest.xml中指定的，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">android:label=&quot;Fruits&quot;</span><br></pre></td></tr></table></figure>

<p>这里给activity增加了一个android:label属性，用于指定在Toolbar中显示的文字内容， 如果没有指定的话，会默认使用application中指定的label内容，也就是我们的应用名称。</p>
<p>不过只有一个标题的Toolbar看起来太单调了，我们还可以再添加一些action按钮来让Toolbar 更加丰富一些。这里我提前准备了几张图片作为按钮的图标，将它们放在了drawable-xxhdpi 目录下（资源下载方式见前言）。现在右击res目录→New→Directory，创建一个menu文件 夹。然后右击menu文件夹→New→Menu resource ﬁle，创建一个toolbar.xml文件，并编写 如下代码：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">item</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/backup&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/ic_backup&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:title</span>=<span class="string">&quot;Backup&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:showAsAction</span>=<span class="string">&quot;always&quot;</span> /&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">item</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/delete&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/ic_delete&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:title</span>=<span class="string">&quot;Delete&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:showAsAction</span>=<span class="string">&quot;ifRoom&quot;</span> /&gt;</span> </span><br><span class="line"> <span class="tag">&lt;<span class="name">item</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/settings&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/ic_settings&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:title</span>=<span class="string">&quot;Settings&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:showAsAction</span>=<span class="string">&quot;never&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用app:showAsAction来指定按钮的显示位置，这里之所以再次使用了app命名空间， 同样是为了能够兼容低版本的系统。showAsAction主要有以下几种值可选：always表示永远 显示在Toolbar中，如果屏幕空间不够则不显示；ifRoom表示屏幕空间足够的情况下显示在 Toolbar中，不够的话就显示在菜单当中；never则表示永远显示在菜单当中。注意，Toolbar 中的action按钮只会显示图标，菜单中的action按钮只会显示文字。</p>
<p>接下来的做法就和3.2.5小节中的完全一致了，修改MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.materialtest</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> android.view.Menu</span><br><span class="line"><span class="keyword">import</span> android.view.MenuItem</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast</span><br><span class="line"><span class="keyword">import</span> androidx.activity.enableEdgeToEdge</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.ViewCompat</span><br><span class="line"><span class="keyword">import</span> androidx.core.view.WindowInsetsCompat</span><br><span class="line"><span class="keyword">import</span> com.example.materialtest.databinding.ActivityMainBinding</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        <span class="keyword">val</span> binding = ActivityMainBinding.inflate(layoutInflater)</span><br><span class="line">        setContentView(binding.root)</span><br><span class="line">        <span class="keyword">val</span> toolbar = binding.toolbar</span><br><span class="line">        setSupportActionBar(toolbar)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateOptionsMenu</span><span class="params">(menu: <span class="type">Menu</span>?)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        menuInflater.inflate(R.menu.toolbar, menu)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onOptionsItemSelected</span><span class="params">(item: <span class="type">MenuItem</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">        <span class="keyword">when</span> (item.itemId) &#123;</span><br><span class="line">            R.id.backup -&gt; Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;You clicked BackUp&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">            R.id.delete -&gt; Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;You clicked Delete&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">            R.id.settings -&gt; Toast.makeText(<span class="keyword">this</span>, <span class="string">&quot;You clicked Settings&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="滑动菜单"><a href="#滑动菜单" class="headerlink" title="滑动菜单"></a>滑动菜单</h2><h3 id="DrawerLayout"><a href="#DrawerLayout" class="headerlink" title="DrawerLayout"></a>DrawerLayout</h3><p>先来简单介绍一下DrawerLayout的用法吧。首先它是一个布局，在布局中允许放入两个直接 子控件：第一个子控件是主屏幕中显示的内容，第二个子控件是滑动菜单中显示的内容。因 此，我们就可以对activity_main.xml中的代码做如下修改：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.appcompat.Toolbar</span></span></span><br><span class="line"><span class="tag">                                    <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span></span></span><br><span class="line"><span class="tag">                                    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                                    <span class="attr">android:layout_height</span>=<span class="string">&quot;?att/actionBarSize&quot;</span></span></span><br><span class="line"><span class="tag">                                    <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">                                    <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span></span></span><br><span class="line"><span class="tag">                                    <span class="attr">app:popupTheme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">andorid:layout_gravity</span>=<span class="string">&quot;start&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:background</span>=<span class="string">&quot;#FFF&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:text</span>=<span class="string">&quot;This is menu&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:textSize</span>=<span class="string">&quot;30sp&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到，这里最外层的控件使用了DrawerLayout。DrawerLayout中放置了两个直接子控 件：第一个子控件是FrameLayout，用于作为主屏幕中显示的内容，当然里面还有我们刚刚定义的Toolbar；第二个子控件是一个TextView，用于作为滑动菜单中显示的内容，其实使用什 么都可以，DrawerLayout并没有限制只能使用固定的控件。</p>
<p>但是关于第二个子控件有一点需要注意，layout_gravity这个属性是必须指定的，因为我们 需要告诉DrawerLayout滑动菜单是在屏幕的左边还是右边，指定left表示滑动菜单在左边，指 定right表示滑动菜单在右边。这里我指定了start，表示会根据系统语言进行判断，如果系统语 言是从左往右的，比如英语、汉语，滑动菜单就在左边，如果系统语言是从右往左的，比如阿 拉伯语，滑动菜单就在右边</p>
<p>向左滑动菜单，或者点击一下菜单以外的区域，都可以让滑动菜单关闭，从而回到主界面。无 论是展示还是隐藏滑动菜单，都有非常流畅的动画过渡</p>
<h4 id="设置菜单导航按钮"><a href="#设置菜单导航按钮" class="headerlink" title="设置菜单导航按钮"></a>设置菜单导航按钮</h4><p>修改MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> :<span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        setSupportActionBar(toolbar)</span><br><span class="line">        supportActionBar?.let&#123;</span><br><span class="line">            it.setDisplayHomeAdUpEnabled(<span class="literal">true</span>)</span><br><span class="line">            it.setHomeAdUpIndicator(R.drawable.ic_menu)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    、、、</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onOptionsItemSelected</span><span class="params">(item: <span class="type">MenuItem</span>)</span></span>:<span class="built_in">Boolean</span>&#123;</span><br><span class="line">        <span class="keyword">when</span>(item.itemId)&#123;</span><br><span class="line">            android.R.id.home -&gt; drawerLayout.openDrawer(GravityCompat.START)</span><br><span class="line">            、、、</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在ActionBar不为空的情况 下调用setDisplayHomeAsUpEnabled()方法让导航按钮显示出来，调用 setHomeAsUpIndicator()方法来设置一个导航按钮图标。实际上，Toolbar最左侧的这个按 钮就叫作Home按钮，它默认的图标是一个返回的箭头，含义是返回上一个Activity。很明显， 这里我们将它默认的样式和作用都进行了修改。</p>
<p>接下来，在onOptionsItemSelected()方法中对Home按钮的点击事件进行处理，Home按 钮的id永远都是android.R.id.home。然后调用DrawerLayout的openDrawer()方法将滑 动菜单展示出来，注意，openDrawer()方法要求传入一个Gravity参数，为了保证这里的行 为和XML中定义的一致，我们传入了GravityCompat.START。</p>
<h3 id="NavigationView"><a href="#NavigationView" class="headerlink" title="NavigationView"></a>NavigationView</h3><p>事实上，你可以在滑动菜单页面定制任意的布局，不过Google给我们提供了一种更好的方法 ——使用NavigationView。</p>
<p>首先，既然这个控件是Material库中提供的，那么我们就需要将这个库引入项目中才行。打开 app&#x2F;build.gradle文件，在dependencies闭包中添加如下内容：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">implementation (<span class="string">&quot;com.google.android.material:material:1.1.0&quot;</span>)</span><br><span class="line">implementation (<span class="string">&quot;de.hdodenhof:circleimageview:3.0.1&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>这里添加了两行依赖关系：第一行就是Material库，第二行是一个开源项目 CircleImageView，它可以用来轻松实现图片圆形化的功能，我们待会就会用到它。</p>
<p>需要注意的是，当你引入了Material库之后，还需要将res&#x2F;values&#x2F;styles.xml文件中 AppTheme的parent主题改成Theme.MaterialComponents.Light.NoActionBar，否则在 使用接下来的一些控件时可能会遇到崩溃问题</p>
<p>在开始使用NavigationView之前，我们还需要准备好两个东西：menu和headerLayout。 menu是用来在NavigationView中显示具体的菜单项的，headerLayout则是用来在 NavigationView中显示头部布局的</p>
<p>先来准备menu。这里我事先找了几张图片作为按钮的图标，并将它们放在了drawablexxhdpi目录下。右击menu文件夹→New→Menu resource ﬁle，创建一个nav_menu.xml文 件，并编写如下代码：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">menu</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">group</span> <span class="attr">android:checkableBehavior</span>=<span class="string">&quot;single&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@id/navCall&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/nav_call&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:title</span>=<span class="string">&quot;Call&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@id/navFriends&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/nav_friends&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:title</span>=<span class="string">&quot;Friends&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@id/navLocation&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/nav_location&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:title</span>=<span class="string">&quot;Location&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@id/navMail&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/nav_main&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:title</span>=<span class="string">&quot;Main&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@+id/navTask&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/nav_task&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:title</span>=<span class="string">&quot;Tasks&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">group</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们首先在menu中嵌套了一个标签，然后将group的checkableBehavior属性 指定为single。group表示一个组，checkableBehavior指定为single表示组中的所有菜 单项只能单选</p>
<p>接下来应该准备headerLayout了，这是一个可以随意定制的布局，不过我并不想将它做得太复 杂。这里简单起见，我们就在headerLayout中放置头像、用户名、邮箱地址这3项内容吧。</p>
<p>右击layout文件夹→New→Layout resource ﬁle，创建一个nav_header.xml文件。 修改其中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;180dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:padding</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">                &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">de.hdodenhof.circleimageview.CircleImageView</span></span></span><br><span class="line"><span class="tag">                                                  <span class="attr">android:</span>&quot;@<span class="attr">id</span>/<span class="attr">iconImage</span>&quot;</span></span><br><span class="line"><span class="tag">                                                  <span class="attr">android:layout_width</span>=<span class="string">&quot;70dp&quot;</span></span></span><br><span class="line"><span class="tag">                                                  <span class="attr">android:layout_height</span>=<span class="string">&quot;70dp&quot;</span></span></span><br><span class="line"><span class="tag">                                                  <span class="attr">android:src</span>=<span class="string">&quot;@drawable/nav_icon&quot;</span></span></span><br><span class="line"><span class="tag">                                                  <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                                                  /&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@+id/mailText&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_allignParentBottom</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:text</span>=<span class="string">&quot;tonygreendev@gmail.com&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:textColor</span>=<span class="string">&quot;#FFF&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@+id/userText&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_above</span>=<span class="string">&quot;@id/mailText&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:text</span>=<span class="string">&quot;Tony Green&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">andorid:textColor</span>=<span class="string">&quot;#FFF&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:textSize</span>=<span class="string">&quot;14sp&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到，布局文件的最外层是一个RelativeLayout，我们将它的宽度设为match_parent， 高度设为180 dp，这是一个NavigationView比较适合的高度，然后指定它的背景色为 colorPrimary。</p>
<p>CircleImageView是一个用于将图片圆形化的控 件，它的用法非常简单，基本和ImageView是完全一样的，这里给它指定了一张图片作为头 像，然后设置为居中显示。</p>
<p>现在menu和headerLayout都准备好了，我们终于可以使用NavigationView了。修改 activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">FrameLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:popupTheme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">com.google.android.material.navigation.NavigationView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/navView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;start&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:menu</span>=<span class="string">&quot;@menu/nav_menu&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:headerLayout</span>=<span class="string">&quot;@layout/nav_header&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>修改 MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> :<span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        setSupportActionBar(toolbar)</span><br><span class="line">        supportActionBar?.let&#123;</span><br><span class="line">            it.setDispayHomeAdUpEnabled(<span class="literal">true</span>)</span><br><span class="line">            it.setHomeAdUpIndicator(R.drawable.ic_menu)</span><br><span class="line">        &#125;</span><br><span class="line">        navView.setCheckedItem(R.id.navCall)</span><br><span class="line">        navView.setNavigationItemSelectedListener&#123;</span><br><span class="line">            drawerLayout.closeDrawers()</span><br><span class="line">            <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用了NavigationView的setCheckedItem()方法将 Call菜单项设置为默认选中。接着调用了setNavigationItemSelectedListener()方法 来设置一个菜单项选中事件的监听器，当用户点击了任意菜单项时，就会回调到传入的 Lambda表达式当中，我们可以在这里编写具体的逻辑处理。这里调用了DrawerLayout的 closeDrawers()方法将滑动菜单关闭，并返回true表示此事件已被处理。</p>
<h2 id="悬浮按钮和可交互提示"><a href="#悬浮按钮和可交互提示" class="headerlink" title="悬浮按钮和可交互提示"></a>悬浮按钮和可交互提示</h2><h3 id="FloatingActionButton"><a href="#FloatingActionButton" class="headerlink" title="FloatingActionButton"></a>FloatingActionButton</h3><p>FloatingActionButton是Material库中提供的一个控件，这个控件可以帮助我们比较轻松地实 现悬浮按钮的效果。它默认会 使用colorAccent作为按钮的颜色，我们还可以通过给按钮指定一个图标来表明这个按钮的作用 是什么。</p>
<p>下面开始具体实现。首先仍然需要提前准备好一个图标，这里我放置了一张ic_done.png到 drawable-xxhdpi目录下。然后修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">FrameLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:popupTheme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">com.google.android.material.floatingactionbutton.FloatingActionButton</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/fab&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_gravity</span>=<span class="string">&quot;bottom|end&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_margin</span>=<span class="string">&quot;16dp&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_done&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>可以看到，这里我们在主屏幕布局中加入了一个FloatingActionButton。这个控件的用法并没 有什么特别的地方，layout_width和layout_height属性都指定成wrap_content， layout_gravity属性指定将这个控件放置于屏幕的右下角</p>
<p>我们还可以指定FloatingActionButton的悬浮高度，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">com.google.android.material.floatinggactionbutton.FloatingActionButton</span></span></span><br><span class="line"><span class="tag">                                                                        <span class="attr">android:id</span>=<span class="string">&quot;@id/fab&quot;</span></span></span><br><span class="line"><span class="tag">                                                                        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                                                                        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                                                                        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;bottom|end&quot;</span></span></span><br><span class="line"><span class="tag">                                                                        <span class="attr">android:layout_margin</span>=<span class="string">&quot;16dp&quot;</span></span></span><br><span class="line"><span class="tag">                                                                        <span class="attr">android:src</span>=<span class="string">&quot;@drawale/ic_done&quot;</span></span></span><br><span class="line"><span class="tag">                                                                        <span class="attr">app:elevation</span>=<span class="string">&quot;8dp&quot;</span></span></span><br><span class="line"><span class="tag">                                                                        /&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来我们看一下FloatingActionButton是如何处理点击事件的，毕竟，一个按钮首先要能点 击才有意义。修改MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> :<span class="type">AppCompatActiity</span>()&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        、、、</span><br><span class="line">        fab.setOnClickListener&#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>,<span class="string">&quot;FAB clicked&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Snackbar"><a href="#Snackbar" class="headerlink" title="Snackbar"></a>Snackbar</h3><p>Snackbar并不是Toast的替代品,Toast的作用是告诉 用户现在发生了什么事情，但用户只能被动接收这个事情，因为没有什么办法能让用户进行选 择。而Snackbar则在这方面进行了扩展，它允许在提示中加入一个可交互按钮，当用户点击按 钮的时候，可以执行一些额外的逻辑操作。</p>
<p>Snackbar的用法也非常简单，它和Toast是基本相似的，只不过可以额外增加一个按钮的点击 事件。修改MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>: <span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        、、、</span><br><span class="line">        fab.setOnClickListener&#123; view-&gt;</span><br><span class="line">                               Snackbar.make(view, <span class="string">&quot;Data deleted&quot;</span>, Toast.LENGTH_SHROT)</span><br><span class="line">                               .setAction(<span class="string">&quot;Undo&quot;</span>)&#123;</span><br><span class="line">                                   Toast.makeText(<span class="keyword">this</span>,<span class="string">&quot;Data restored&quot;</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">                               &#125;</span><br><span class="line">                               .show()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    、、、</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，这里调用了Snackbar的make()方法来创建一个Snackbar对象。make()方法的第 一个参数需要传入一个View，只要是当前界面布局的任意一个View都可以，Snackbar会使用 这个View自动查找最外层的布局，用于展示提示信息；第二个参数就是Snackbar中显示的内 容；第三个参数是Snackbar显示的时长，这些和Toast都是类似的</p>
<h3 id="CoordinatorLayout"><a href="#CoordinatorLayout" class="headerlink" title="CoordinatorLayout"></a>CoordinatorLayout</h3><p>CoordinatorLayout可以说是一个加强版的FrameLayout，由AndroidX库提供。它在普通情 况下的作用和FrameLayout基本一致，但是它拥有一些额外的Material能力。</p>
<p>事实上，CoordinatorLayout可以监听其所有子控件的各种事件，并自动帮助我们做出最为合 理的响应。举个简单的例子，刚才弹出的Snackbar提示将悬浮按钮遮挡住了，而如果我们能让 CoordinatorLayout监听到Snackbar的弹出事件，那么它会自动将内部的 FloatingActionButton向上偏移，从而确保不会被Snackbar遮挡。</p>
<p>至于CoordinatorLayout的使用也非常简单，我们只需要将原来的FrameLayout替换一下就可 以了。修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:id</span>=<span class="string">&quot;@id/drawerLayout&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                                           &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span></span></span><br><span class="line"><span class="tag">                                                         <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                                                         <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:layout_height</span>=<span class="string">&quot;attr/actionBarSize&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:backgourn</span>=<span class="string">&quot;@color/colorPrimary&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span></span></span><br><span class="line"><span class="tag">                                           <span class="attr">app:popupTheme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span></span></span><br><span class="line"><span class="tag">                                           &gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">androidx.appcompat.widget.Toolbar</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">com.google.android.material.floatingactionbutton.FloatingActionButton</span> </span></span><br><span class="line"><span class="tag">                                            <span class="attr">android:id</span>=<span class="string">&quot;@+id/fab&quot;</span> </span></span><br><span class="line"><span class="tag">                                            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">                                            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">                                            <span class="attr">android:layout_gravity</span>=<span class="string">&quot;bottom|end&quot;</span> </span></span><br><span class="line"><span class="tag">                                            <span class="attr">android:layout_margin</span>=<span class="string">&quot;16dp&quot;</span> </span></span><br><span class="line"><span class="tag">                                            <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_done&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>不过我们回过头来再思考一下，刚才说的是CoordinatorLayout可以监听其所有子控件的各种 事件，但是Snackbar好像并不是CoordinatorLayout的子控件吧，为什么它却可以被监听到 呢？</p>
<p>其实道理很简单，还记得我们在Snackbar的make()方法中传入的第一个参数吗？这个参数就 是用来指定Snackbar是基于哪个View触发的，刚才我们传入的是FloatingActionButton本 身，而FloatingActionButton是CoordinatorLayout中的子控件，因此这个事件就理所应当能被监听到了。你可以自己再做个实验，如果给Snackbar的make()方法传入一个 DrawerLayout，那么Snackbar就会再次遮挡悬浮按钮，因为DrawerLayout不是 CoordinatorLayout的子控件，CoordinatorLayout也就无法监听到Snackbar的弹出和隐藏 事件了。</p>
<h4 id="RecyclverView适配器写法"><a href="#RecyclverView适配器写法" class="headerlink" title="RecyclverView适配器写法"></a>RecyclverView适配器写法</h4><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RecyclerAdapter</span>(<span class="keyword">val</span>:xxx, <span class="keyword">val</span>:xxx):RecyclerView.Adapter&lt;RecyclerAdapter.MyViewHolder&gt;()&#123;</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">MyViewHolder</span>(<span class="keyword">val</span> binding:xxx):RecyclerAdapter.ViewHolder(binding.root)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>,viewType:<span class="type">Int</span>)</span></span>:MyViewHolder&#123;</span><br><span class="line">        <span class="keyword">val</span> binding = xxxxx</span><br><span class="line">        <span class="keyword">return</span> MyViewHolder(binding)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">MyViewHolder</span>, position: <span class="type">Int</span>)</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span>: <span class="built_in">Int</span> = upList.size</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="卡片式布局"><a href="#卡片式布局" class="headerlink" title="卡片式布局"></a>卡片式布局</h2><h3 id="MaterialCardView"><a href="#MaterialCardView" class="headerlink" title="MaterialCardView"></a>MaterialCardView</h3><p>MaterialCardView是用于实现卡片式布局效果的重要控件，由Material库提供。实际上， MaterialCardView也是一个FrameLayout，只是额外提供了圆角和阴影等效果，看上去会有 立体的感觉。</p>
<p>我们先来看一下MaterialCardView的基本用法吧，其实非常简单，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag">                                                   <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                                                   <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                                                   <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;4dp&quot;</span></span></span><br><span class="line"><span class="tag">                                                   <span class="attr">app:elevation</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">                                                   &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span>=<span class="string">&quot;@+id/infoText&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里定义了一个MaterialCardView布局，我们可以通过app:cardCornerRadius属性指定卡 片圆角的弧度，数值越大，圆角的弧度也越大。另外，还可以通过app:elevation属性指定卡 片的高度：高度值越大，投影范围也越大，但是投影效果越淡；高度值越小，投影范围也越 小，但是投影效果越浓。这一点和FloatingActionButton是一致的。由于MaterialCardView是一个FrameLayout布局，使用起来不方便，所以嵌套一个LinearLayout</p>
<p>引入依赖</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">implementation(<span class="string">&quot;com.github.bumptech.glide:glide:4.15.0&quot;</span>)  </span><br><span class="line">implementation(<span class="string">&quot;de.hdodenhof:circleimageview:3.1.0&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>接下来开始具体的代码实现，修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">         <span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">         <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">app:popupTheme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line">         <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:id</span>=<span class="string">&quot;@+id/recyclerView&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line">         <span class="tag">&lt;<span class="name">com.google.android.material.floatingactionbutton.FloatingActionButton</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:id</span>=<span class="string">&quot;@+id/fab&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_gravity</span>=<span class="string">&quot;bottom|end&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_margin</span>=<span class="string">&quot;16dp&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_done&quot;</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>接着定义一个实体类Fruit，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Fruit</span>(<span class="keyword">val</span> name: String, <span class="keyword">val</span> imageId: <span class="built_in">Int</span>)</span><br></pre></td></tr></table></figure>

<p>然后需要为RecyclerView的子项指定一个我们自定义的布局，在layout目录下新建 fruit_item.xml，代码如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;4dp&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitImage&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;100dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:scaleType</span>=<span class="string">&quot;centerCrop&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitName&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_horizontal&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_margin</span>=<span class="string">&quot;5dp&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:textSize</span>=<span class="string">&quot;16sp&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>scaleType属性，这个属性可以指定图片的缩放模式。由于各张 水果图片的长宽比例可能会不一致，为了让所有的图片都能填充满整个ImageView，这里使用 了centerCrop模式，它可以让图片保持原有比例填充满ImageView，并将超出屏幕的部分裁 剪掉。</p>
<p>接下来需要为RecyclerView准备一个适配器，新建FruitAdapter类，让这个适配器继承自 RecyclerView.Adapter，并将泛型指定为FruitAdapter.ViewHolder，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FruitAdapter</span>(<span class="keyword">val</span> context:Context, <span class="keyword">val</span> fruitlist: List&lt;Fruit&gt;):RecyclerView.Adapter&lt;FruitAdapter.MyViewHolder&gt;()&#123;</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">MyViewHolder</span>(<span class="keyword">val</span> binding: FruitItemBinding): RecyclerView.ViewHolder(binding.root)&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span>: <span class="built_in">Int</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> fruitList.size</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateVeiwHolder</span><span class="params">(parent: <span class="type">ViewGourp</span>, viewType: <span class="type">Int</span>)</span></span>: MyViewHolder&#123;</span><br><span class="line">        <span class="keyword">val</span> binding = FruitItemBinding.inflate(LayoutInflater.from(context),parent,<span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder: <span class="type">MyViewHolder</span>, position: <span class="type">Int</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">val</span> fruit = fruitList[position]</span><br><span class="line">        holder.binding.fruitName.text = fruit.name</span><br><span class="line">        Glide.with(context).load(fruit.imageId).into(holder.binding.fruitImage)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Glide.with()方法并传入一个Context、Activity或Fragment参数， 然后调用load()方法加载图片，可以是一个URL地址，也可以是一个本地路径，或者是一个资 源id，最后调用into()方法将图片设置到具体某一个ImageView中就可以了</p>
<p>这样我们将RecyclerView的适配器也准备好了，最后修改MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> :<span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">     <span class="keyword">val</span> fruits = mutableListOf(Fruit(<span class="string">&quot;Apple&quot;</span>, R.drawable.apple), Fruit(<span class="string">&quot;Banana&quot;</span>, </span><br><span class="line">         R.drawable.banana), Fruit(<span class="string">&quot;Orange&quot;</span>, R.drawable.orange), Fruit(<span class="string">&quot;Watermelon&quot;</span>, </span><br><span class="line">         R.drawable.watermelon), Fruit(<span class="string">&quot;Pear&quot;</span>, R.drawable.pear), Fruit(<span class="string">&quot;Grape&quot;</span>, </span><br><span class="line">         R.drawable.grape), Fruit(<span class="string">&quot;Pineapple&quot;</span>, R.drawable.pineapple), Fruit(<span class="string">&quot;Strawberry&quot;</span>, </span><br><span class="line">         R.drawable.strawberry), Fruit(<span class="string">&quot;Cherry&quot;</span>, R.drawable.cherry), Fruit(<span class="string">&quot;Mango&quot;</span>, </span><br><span class="line">         R.drawable.mango))</span><br><span class="line">    <span class="keyword">val</span> fruitList = ArrayList&lt;Fruit&gt;()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        、、、</span><br><span class="line">        initFruits()</span><br><span class="line">        <span class="keyword">val</span> layoutManager = GridLayoutManager(<span class="keyword">this</span>,<span class="number">2</span>)</span><br><span class="line">        recyclerView.layoutMananger = layoutManager</span><br><span class="line">        <span class="keyword">val</span> adapter = FruitAdapter(<span class="keyword">this</span>,fruitList)</span><br><span class="line">        recyclerView.adapter = adapter</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">initFruits</span><span class="params">()</span></span>&#123;</span><br><span class="line">        fruitList.clear()</span><br><span class="line">        repeat(<span class="number">50</span>)&#123;</span><br><span class="line">            <span class="keyword">val</span> index = (<span class="number">0</span> until fruits.size).random()</span><br><span class="line">            fruitList.add(fruits[index])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们的Toolbar怎么不见 了！仔细观察一下原来是被RecyclerView给挡住了。这个问题又该怎么解决呢？这就需要借助 另外一个工具了——AppBarLayout。</p>
<h3 id="AppBarLayout"><a href="#AppBarLayout" class="headerlink" title="AppBarLayout"></a>AppBarLayout</h3><p>那么我们怎样使用AppBarLayout才能解决前面的遮挡问题呢？其实只需要两步就可以了，第 一步将Toolbar嵌套到AppBarLayout中，第二步给RecyclerView指定一个布局行为。修改 activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">app:popupTheme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:id</span>=<span class="string">&quot;@+id/recyclerView&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">app:layout_behavior</span>=<span class="string">&quot;@string/appbar_scrolling_view_behavior&quot;</span> /&gt;</span> </span><br><span class="line">     ... </span><br><span class="line">     <span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br><span class="line">     ... </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>可以看到，布局文件并没有什么太大的变化。我们首先定义了一个AppBarLayout，并将 Toolbar放置在了AppBarLayout里面，然后在RecyclerView中使用app:layout_behavior属性指定了一个布局行为。其中appbar_scrolling_view_behavior这个字符串也是由 Material库提供的	当 <code>appbar_scrolling_view_behavior</code> 被设置在一个滚动视图上时，它会帮助滚动视图与 <code>AppBarLayout</code> 之间进行协调</p>
<p>当AppBarLayout接收到滚动事件的时候，它内部的子控件其实是可以指定如何去响应这些事 件的，通过app:layout_scrollFlags属性就能实现。修改activity_main.xml中的代码，</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:background</span>=<span class="string">&quot;@color/colorPrimary&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:popupTheme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Light&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_scrollFlags</span>=<span class="string">&quot;scroll|enterAlways|snap&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"> <span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里在Toolbar中添加了一个app:layout_scrollFlags属性，并将这个属性的值指定成了 scroll|enterAlways|snap。其中，scroll表示当RecyclerView向上滚动的时候， Toolbar会跟着一起向上滚动并实现隐藏；enterAlways表示当RecyclerView向下滚动的时 候，Toolbar会跟着一起向下滚动并重新显示；snap表示当Toolbar还没有完全隐藏或显示的时 候，会根据当前滚动的距离，自动选择是隐藏还是显示。</p>
<h2 id="下拉刷新"><a href="#下拉刷新" class="headerlink" title="下拉刷新"></a>下拉刷新</h2><p>SwipeRefreshLayout就是用于实现下拉刷新功能的核心类，我们把想要实现下拉刷新功能的 控件放置到SwipeRefreshLayout中，就可以迅速让这个控件支持下拉刷新。那么在 MaterialTest项目中，应该支持下拉刷新功能的控件自然就是RecyclerView了。</p>
<p>使用SwipeRefreshLayout之前首先需要在app&#x2F;build.gradle文件中添加如下依赖：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">dependencies &#123; </span><br><span class="line">... </span><br><span class="line">implementation(<span class="string">&quot;androidx.swiperefreshlayout:swiperefreshlayout:1.0.0&quot;</span> )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于SwipeRefreshLayout的用法也比较简单，下面我们就直接开始使用了。修改 activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.drawerlayout.widget.DrawerLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/drawerLayout&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/swipeRefresh&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_behavior</span>=<span class="string">&quot;@string/appbar_scrolling_view_behavior&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/recyclerView&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_behavior</span>=<span class="string">&quot;@string/appbar_scrolling_view_behavior&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">androidx.swiperefreshlayout.widget.SwipeRefreshLayout</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"> <span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.drawerlayout.widget.DrawerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到，这里我们在RecyclerView的外面又嵌套了一层SwipeRefreshLayout，这样 RecyclerView就自动拥有下拉刷新功能了。另外需要注意，由于RecyclerView现在变成了SwipeRefreshLayout的子控件，因此之前使用app:layout_behavior声明的布局行为现在 也要移到SwipeRefreshLayout中才行。</p>
<p>不过这还没有结束，虽然RecyclerView已经支持下拉刷新功能了，但是我们还要在代码中处理 具体的刷新逻辑才行。修改MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>: <span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    、、、</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInsanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        、、、</span><br><span class="line">        swipeRefresh.setColorSchemeResources(R.color.colorPrimay)</span><br><span class="line">        swipRefresh.setOnRefreshListener&#123;</span><br><span class="line">            refreshFruits(adapter)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">refreshFruits</span><span class="params">(adapter: <span class="type">FruitAdpater</span>)</span></span>&#123;</span><br><span class="line">        thread&#123;</span><br><span class="line">            Thread.sleep(<span class="number">2000</span>)</span><br><span class="line">            runOnUiThread&#123;</span><br><span class="line">                initFruits()</span><br><span class="line">                adapter.notifyDataSetChanged()</span><br><span class="line">                swipeRefresh.isRefreshing = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    、、、</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码应该还是比较好理解的，首先调用SwipeRefreshLayout的 setColorSchemeResources()方法来设置下拉刷新进度条的颜色，这里我们就使用主题中 的colorPrimary作为进度条的颜色了。接着调用setOnRefreshListener()方法来设置一 个下拉刷新的监听器，当用户进行了下拉刷新操作时，就会回调到Lambda表达式当中，然后 我们在这里去处理具体的刷新逻辑就可以了。</p>
<h2 id="可折叠式标题栏"><a href="#可折叠式标题栏" class="headerlink" title="可折叠式标题栏"></a>可折叠式标题栏</h2><h3 id="CollapsingToolbarLayout"><a href="#CollapsingToolbarLayout" class="headerlink" title="CollapsingToolbarLayout"></a>CollapsingToolbarLayout</h3><p>不过，CollapsingToolbarLayout是不能独立存在的，它在设计的时候就被限定只能作为 AppBarLayout的直接子布局来使用。而AppBarLayout又必须是CoordinatorLayout的子布 局，因此本节中我们要实现的功能其实需要综合运用前面所学的各种知识。那么话不多说，这 就开始吧。</p>
<p>首先我们需要一个额外的Activity作为水果的详情展示界面，右击com.example.materialtest 包→New→Activity→Empty Activity，创建一个FruitActivity，并将布局名指定成 activity_fruit.xml，然后我们开始编写水果详情展示界面的布局</p>
<p>由于整个布局文件比较复杂，这里我准备采用分段编写的方式。activity_fruit.xml中的内容主 要分为两部分，一个是水果标题栏，一个是水果内容详情，我们来一步步实现。</p>
<p>首先实现标题栏部分，这里使用CoordinatorLayout作为最外层布局，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>一开始的代码还是比较简单的，相信没有什么需要解释的地方。注意要始终记得定义一个 xmlns:app的命名空间，在Material Design的开发中会经常用到它。</p>
<p>接着我们在CoordinatorLayout中嵌套一个AppBarLayout，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">             <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:id</span>=<span class="string">&quot;@+id/appBar&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_height</span>=<span class="string">&quot;250dp&quot;</span>&gt;</span> </span><br><span class="line">             <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>目前为止也没有什么难理解的地方，我们给AppBarLayout定义了一个id，将它的宽度指定为 match_parent，高度指定为250 dp。当然这里的高度值你可以随意指定，不过我尝试之后发 现250 dp的视觉效果比较好。</p>
<p>接下来我们在AppBarLayout中再嵌套一个CollapsingToolbarLayout，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">         <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:id</span>=<span class="string">&quot;@+id/appBar&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;250dp&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">             <span class="tag">&lt;<span class="name">com.google.android.material.appbar.CollapsingToolbarLayout</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:id</span>=<span class="string">&quot;@+id/collapsingToolbar&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">app:contentScrim</span>=<span class="string">&quot;@color/colorPrimary&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">app:layout_scrollFlags</span>=<span class="string">&quot;scroll|exitUntilCollapsed&quot;</span>&gt;</span> </span><br><span class="line">         <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.CollapsingToolbarLayout</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>app:layout_scrollFlags属 性我们也是见过的，只不过之前是给Toolbar指定的，现在也移到外面来了。其中，scroll表 示CollapsingToolbarLayout会随着水果内容详情的滚动一起滚动，exitUntilCollapsed 表示当CollapsingToolbarLayout随着滚动完成折叠之后就保留在界面上，不再移出屏幕。</p>
<p>接下来，我们在CollapsingToolbarLayout中定义标题栏的具体内容，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/appBar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;250dp&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">com.google.android.material.appbar.CollapsingToolbarLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/collapsingToolbar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:contentScrim</span>=<span class="string">&quot;@color/colorPrimary&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_scrollFlags</span>=<span class="string">&quot;scroll|exitUntilCollapsed&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">ImageView</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitImageView&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:scaleType</span>=<span class="string">&quot;centerCrop&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_collapseMode</span>=<span class="string">&quot;parallax&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.appcompat.widget.Toolbar</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/toolbar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;?attr/actionBarSize&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_collapseMode</span>=<span class="string">&quot;pin&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.CollapsingToolbarLayout</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>app:layout_collapseMode比较陌生。它用 于指定当前控件在CollapsingToolbarLayout折叠过程中的折叠模式，其中Toolbar指定成 pin，表示在折叠的过程中位置始终保持不变，ImageView指定成parallax，表示会在折叠的 过程中产生一定的错位偏移，这种模式的视觉效果会非常好。</p>
<p>这样我们就将水果标题栏的界面编写完成了，下面开始编写水果内容详情部分。继续修改 activity_fruit.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/appBar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;250dp&quot;</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"> <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.core.widget.NestedScrollView</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">app:layout_behavior</span>=<span class="string">&quot;@string/appbar_scrolling_view_behavior&quot;</span>&gt;</span> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">androidx.core.widget.NestedScrollView</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>水果内容详情的最外层布局使用了一个NestedScrollView，注意它和AppBarLayout是平级 的。我们之前在11.2.1小节学过ScrollView的用法，它允许使用滚动的方式来查看屏幕以外的 数据，而NestedScrollView在此基础之上还增加了嵌套响应滚动事件的功能。由于 CoordinatorLayout本身已经可以响应滚动事件了，因此我们在它的内部就需要使用 NestedScrollView或RecyclerView这样的布局。另外，这里还通过app:layout_behavior 属性指定了一个布局行为，这和之前在RecyclerView中的用法是一模一样的。</p>
<p>不管是ScrollView还是NestedScrollView，它们的内部都只允许存在一个直接子布局。因此， 如果我们想要在里面放入很多东西的话，通常会先嵌套一个LinearLayout，然后再在 LinearLayout中放入具体的内容就可以了，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">     ... </span><br><span class="line">     <span class="tag">&lt;<span class="name">androidx.core.widget.NestedScrollView</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">app:layout_behavior</span>=<span class="string">&quot;@string/appbar_scrolling_view_behavior&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">LinearLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;/<span class="name">androidx.core.widget.NestedScrollView</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来在LinearLayout中放入具体的内容，这里我准备使用一个TextView来显示水果的内容详 情，并将TextView放在一个卡片式布局当中，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.core.widget.NestedScrollView</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_behavior</span>=<span class="string">&quot;@string/appbar_scrolling_view_behavior&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">LinearLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> <span class="attr">www.blogss.cn</span></span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">com.google.android.material.card.MaterialCardView</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_marginBottom</span>=<span class="string">&quot;15dp&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_marginLeft</span>=<span class="string">&quot;15dp&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_marginRight</span>=<span class="string">&quot;15dp&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;35dp&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:cardCornerRadius</span>=<span class="string">&quot;4dp&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">     <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitContentText&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_margin</span>=<span class="string">&quot;10dp&quot;</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;/<span class="name">com.google.android.material.card.MaterialCardView</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;/<span class="name">androidx.core.widget.NestedScrollView</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>好的，这样就把水果标题栏和水果内容详情的界面都编写完了，不过我们还可以在界面上再添 加一个悬浮按钮。这个悬浮按钮并不是必需的，根据具体的需求添加就可以了，如果加入的 话，我们将获得一些额外的动画效果。</p>
<p>为了做出示范，我就准备在activity_fruit.xml中加入一个悬浮按钮了。这个界面是一个水果详 情展示界面，那么我就加入一个表示评论作用的悬浮按钮吧。首先需要提前准备好一个图标， 这里我放置了一张ic_comment.png到drawable-xxhdpi目录下。然后修改 activity_fruit.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:id</span>=<span class="string">&quot;@+id/appBar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;250dp&quot;</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"> <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"> <span class="tag">&lt;<span class="name">androidx.core.widget.NestedScrollView</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_behavior</span>=<span class="string">&quot;@string/appbar_scrolling_view_behavior&quot;</span>&gt;</span> </span><br><span class="line"> ... </span><br><span class="line"> <span class="tag">&lt;/<span class="name">androidx.core.widget.NestedScrollView</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">com.google.android.material.floatingactionbutton.FloatingActionButton</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_margin</span>=<span class="string">&quot;16dp&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:src</span>=<span class="string">&quot;@drawable/ic_comment&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_anchor</span>=<span class="string">&quot;@id/appBar&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">app:layout_anchorGravity</span>=<span class="string">&quot;bottom|end&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>可以看到，这里加入了一个FloatingActionButton，它和AppBarLayout以及 NestedScrollView是平级的。FloatingActionButton中使用app:layout_anchor属性指定 了一个锚点，我们将锚点设置为AppBarLayout，这样悬浮按钮就会出现在水果标题栏的区域 内，接着又使用app:layout_anchorGravity属性将悬浮按钮定位在标题栏区域的右下角。 其他一些属性比较简单，就不再进行解释了。</p>
<p>好了，现在我们终于将整个activity_fruit.xml布局都编写完了，内容虽然比较长，但由于是分 段编写的，并且每一步我都进行了详细的说明，相信你应该看得很明白吧。</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FruitActivity</span> : <span class="type">AppCompatActivity</span>() &#123; </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">companion</span> <span class="keyword">object</span> &#123; </span><br><span class="line"> <span class="keyword">const</span> <span class="keyword">val</span> FRUIT_NAME = <span class="string">&quot;fruit_name&quot;</span> </span><br><span class="line"> <span class="keyword">const</span> <span class="keyword">val</span> FRUIT_IMAGE_ID = <span class="string">&quot;fruit_image_id&quot;</span> </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123; </span><br><span class="line"> <span class="keyword">super</span>.onCreate(savedInstanceState) </span><br><span class="line"> setContentView(R.layout.activity_fruit) </span><br><span class="line"> <span class="keyword">val</span> fruitName = intent.getStringExtra(FRUIT_NAME) ?: <span class="string">&quot;&quot;</span> </span><br><span class="line"> <span class="keyword">val</span> fruitImageId = intent.getIntExtra(FRUIT_IMAGE_ID, <span class="number">0</span>) </span><br><span class="line"> setSupportActionBar(toolbar) </span><br><span class="line"> supportActionBar?.setDisplayHomeAsUpEnabled(<span class="literal">true</span>) </span><br><span class="line"> collapsingToolbar.title = fruitName </span><br><span class="line"> Glide.with(<span class="keyword">this</span>).load(fruitImageId).into(fruitImageView) </span><br><span class="line"> fruitContentText.text = generateFruitContent(fruitName) </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onOptionsItemSelected</span><span class="params">(item: <span class="type">MenuItem</span>)</span></span>: <span class="built_in">Boolean</span> &#123; </span><br><span class="line"> <span class="keyword">when</span> (item.itemId) &#123; </span><br><span class="line"> android.R.id.home -&gt; &#123; </span><br><span class="line"> finish() </span><br><span class="line"> <span class="keyword">return</span> <span class="literal">true</span> </span><br><span class="line"> &#125; </span><br><span class="line"> &#125; </span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">super</span>.onOptionsItemSelected(item) </span><br><span class="line"> &#125; </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">generateFruitContent</span><span class="params">(fruitName: <span class="type">String</span>)</span></span> = fruitName.repeat(<span class="number">500</span>) </span><br><span class="line"> </span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>修改FruitAdapter中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FruitAdapter</span>(<span class="keyword">val</span> context: Context, <span class="keyword">val</span> fruitList: List&lt;Fruit&gt;) : </span><br><span class="line"> RecyclerView.Adapter&lt;FruitAdapter.ViewHolder&gt;() &#123; </span><br><span class="line"> ... </span><br><span class="line"> <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent: <span class="type">ViewGroup</span>, viewType: <span class="type">Int</span>)</span></span>: ViewHolder &#123; </span><br><span class="line"> <span class="keyword">val</span> view = LayoutInflater.from(context).inflate(R.layout.fruit_item, parent, <span class="literal">false</span>) </span><br><span class="line"> <span class="keyword">val</span> holder = ViewHolder(view) </span><br><span class="line"> holder.itemView.setOnClickListener &#123; </span><br><span class="line"> <span class="keyword">val</span> position = holder.adapterPosition </span><br><span class="line"> <span class="keyword">val</span> fruit = fruitList[position] </span><br><span class="line"> <span class="keyword">val</span> intent = Intent(context, FruitActivity::<span class="keyword">class</span>.java).apply &#123; </span><br><span class="line"> putExtra(FruitActivity.FRUIT_NAME, fruit.name) </span><br><span class="line"> putExtra(FruitActivity.FRUIT_IMAGE_ID, fruit.imageId) </span><br><span class="line"> &#125; </span><br><span class="line"> context.startActivity(intent) </span><br><span class="line"> &#125; </span><br><span class="line"> <span class="keyword">return</span> holder </span><br><span class="line"> &#125; </span><br><span class="line"> ... </span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="充分利用系统状态栏空间"><a href="#充分利用系统状态栏空间" class="headerlink" title="充分利用系统状态栏空间"></a>充分利用系统状态栏空间</h3><p>想要让背景图能够和系统状态栏融合，需要借助android:fitsSystemWindows这个属性来 实现。在CoordinatorLayout、AppBarLayout、CollapsingToolbarLayout这种嵌套结构的 布局中，将控件的android:fitsSystemWindows属性指定成true，就表示该控件会出现在 系统状态栏里。对应到我们的程序，那就是水果标题栏中的ImageView应该设置这个属性了。 不过只给ImageView设置这个属性是没有用的，我们必须将ImageView布局结构中的所有父 布局都设置上这个属性才可以，修改activity_fruit.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">         <span class="tag">&lt;<span class="name">com.google.android.material.appbar.AppBarLayout</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:id</span>=<span class="string">&quot;@+id/appBar&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_height</span>=<span class="string">&quot;250dp&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">             <span class="tag">&lt;<span class="name">com.google.android.material.appbar.CollapsingToolbarLayout</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:id</span>=<span class="string">&quot;@+id/collapsingToolbar&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:theme</span>=<span class="string">&quot;@style/ThemeOverlay.AppCompat.Dark.ActionBar&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">app:contentScrim</span>=<span class="string">&quot;@color/colorPrimary&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">app:layout_scrollFlags</span>=<span class="string">&quot;scroll|exitUntilCollapsed&quot;</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">             <span class="tag">&lt;<span class="name">ImageView</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitImageView&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:scaleType</span>=<span class="string">&quot;centerCrop&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">android:fitsSystemWindows</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">                 <span class="attr">app:layout_collapseMode</span>=<span class="string">&quot;parallax&quot;</span> /&gt;</span> </span><br><span class="line">         ... </span><br><span class="line">         <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.CollapsingToolbarLayout</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;/<span class="name">com.google.android.material.appbar.AppBarLayout</span>&gt;</span> </span><br><span class="line">     ... </span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.coordinatorlayout.widget.CoordinatorLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是，即使我们将android:fitsSystemWindows属性都设置好了也没有用，因为还必须在 程序的主题中将状态栏颜色指定成透明色才行。指定成透明色的方法很简单，在主题中将 android:statusBarColor属性的值指定成@android:color&#x2F;transparent就可以了。</p>
<p>打开res&#x2F;values&#x2F;styles.xml文件，对主题的内容进行修改，如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Base application theme. --&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;AppTheme&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;Theme.AppCompat.Light.NoActionBar&quot;</span>&gt;</span><span class="language-xml"> </span></span><br><span class="line"><span class="language-xml">     <span class="comment">&lt;!-- Customize your theme here. --&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimary&quot;</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorPrimaryDark&quot;</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;colorAccent&quot;</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">     </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">     <span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">&quot;FruitActivityTheme&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;AppTheme&quot;</span>&gt;</span><span class="language-xml"> </span></span><br><span class="line"><span class="language-xml">         <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">&quot;android:statusBarColor&quot;</span>&gt;</span>@android:color/transparent<span class="tag">&lt;/<span class="name">item</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">     </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们定义了一个FruitActivityTheme主题，它是专门给FruitActivity使用的。 FruitActivityTheme的父主题是AppTheme，也就是说，它继承了AppTheme中的所有特 性。在此基础之上，我们将FruitActivityTheme中的状态栏的颜色指定成透明色。</p>
<p>最后，还需要让FruitActivity使用这个主题才可以，修改AndroidManifest.xml中的代码，如 下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">     <span class="attr">package</span>=<span class="string">&quot;com.example.materialtest&quot;</span>&gt;</span> </span><br><span class="line">         <span class="tag">&lt;<span class="name">application</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:theme</span>=<span class="string">&quot;@style/AppTheme&quot;</span>&gt;</span> </span><br><span class="line">             ... </span><br><span class="line">         <span class="tag">&lt;<span class="name">activity</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:name</span>=<span class="string">&quot;.FruitActivity&quot;</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">android:theme</span>=<span class="string">&quot;@style/FruitActivityTheme&quot;</span>&gt;</span> </span><br><span class="line">             <span class="tag">&lt;/<span class="name">activity</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;/<span class="name">application</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h2 id="Kotlin课堂：编写好用的工具方法"><a href="#Kotlin课堂：编写好用的工具方法" class="headerlink" title="Kotlin课堂：编写好用的工具方法"></a>Kotlin课堂：编写好用的工具方法</h2><h3 id="求N个数的最大最小值"><a href="#求N个数的最大最小值" class="headerlink" title="求N个数的最大最小值"></a>求N个数的最大最小值</h3><p>两个数比大小这个功能，相信每一位开发者都遇到过。如果我想要获取两个数中较大的那个 数，除了使用最基本的if语句之外，还可以借助Kotlin内置的max()函数，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> a = <span class="number">10</span></span><br><span class="line"><span class="keyword">val</span> b = <span class="number">15</span></span><br><span class="line"><span class="keyword">val</span> larger = max(a,b)</span><br></pre></td></tr></table></figure>

<p>这种代码看上去简单直观，也很容易理解，因此好像并没有什么优化的必要。</p>
<p>可是现在如果我们想要在3个数中获取最大的那个数，应该怎么写呢？由于max()函数只能接收 两个参数，因此需要先比较前两个数的大小，然后再拿较大的那个数和剩余的数进行比较，写 法如下：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> a = <span class="number">10</span> </span><br><span class="line"><span class="keyword">val</span> b = <span class="number">15</span> </span><br><span class="line"><span class="keyword">val</span> c = <span class="number">5</span> </span><br><span class="line"><span class="keyword">val</span> largest = max(max(a, b), c)</span><br></pre></td></tr></table></figure>

<p>有没有觉得代码开始变得复杂了呢？3个数中获取最大值就需要使用这种嵌套max()函数的写法 了，那如果是4个数、5个数呢？没错，这个时候你就应该意识到，我们是可以对max()函数的 用法进行简化的。</p>
<p>回顾一下，我们之前在第7章的Kotlin课堂中学过vararg关键字，它允许方法接收任意多个同 等类型的参数，正好满足我们这里的需求。那么我们就可以新建一个Max.kt文件，并在其中自 定义一个max()函数，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">max</span><span class="params">(<span class="keyword">vararg</span> nums: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123; </span><br><span class="line">     <span class="keyword">var</span> maxNum = <span class="built_in">Int</span>.MIN_VALUE </span><br><span class="line">     <span class="keyword">for</span> (num <span class="keyword">in</span> nums) &#123; </span><br><span class="line">         maxNum = kotlin.math.max(maxNum, num) </span><br><span class="line">     &#125; </span><br><span class="line">     <span class="keyword">return</span> maxNum </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>可以看到，这里max()函数的参数声明中使用了vararg关键字，也就是说现在它可以接收任意 多个整型参数。接着我们使用了一个maxNum变量来记录所有数的最大值，并在一开始将它赋值 成了整型范围的最小值。然后使用for-in循环遍历nums参数列表，如果发现当前遍历的数字 比maxNum更大，就将maxNum的值更新成这个数，最终将maxNum返回即可。</p>
<p>仅仅经过这样的一层封装之后，我们在使用max()函数时就会有翻天覆地的变化，比如刚才同 样的功能，现在就可以使用如下的写法来实现：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> a = <span class="number">10</span></span><br><span class="line"><span class="keyword">val</span> b = <span class="number">15</span></span><br><span class="line"><span class="keyword">val</span> c = <span class="number">5</span></span><br><span class="line"><span class="keyword">val</span> largest = max(a,b,c)</span><br></pre></td></tr></table></figure>

<p>不过，目前我们自定义的max()函数还有一个缺点，就是它只能求N个整型数字的最大值，如果 我还想求N个浮点型或长整型数字的最大值，该怎么办呢？当然你可以定义很多个max()函数的 重载，来接收不同类型的参数，因为Kotlin中内置的max()函数也是这么做的。但是这种方案实 现起来过于烦琐，而且还会产生大量的重复代码，因此这里我准备使用一种更加巧妙的做法。</p>
<p>Java中规定，所有类型的数字都是可比较的，因此必须实现Comparable接口，这个规则在 Kotlin中也同样成立。那么我们就可以借助泛型，将max()函数修改成接收任意多个实现 Comparable接口的参数，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="type">&lt;T : Comparable&lt;T&gt;</span>&gt; <span class="title">max</span><span class="params">(<span class="keyword">vararg</span> nums: <span class="type">T</span>)</span></span>: T &#123; </span><br><span class="line">     <span class="keyword">if</span> (nums.isEmpty()) <span class="keyword">throw</span> RuntimeException(<span class="string">&quot;Params can not be empty.&quot;</span>) </span><br><span class="line">     <span class="keyword">var</span> maxNum = nums[<span class="number">0</span>] </span><br><span class="line">     <span class="keyword">for</span> (num <span class="keyword">in</span> nums) &#123; </span><br><span class="line">         <span class="keyword">if</span> (num &gt; maxNum) &#123; </span><br><span class="line">         maxNum = num </span><br><span class="line">         &#125; </span><br><span class="line">     &#125; </span><br><span class="line">     <span class="keyword">return</span> maxNum </span><br><span class="line">    &#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>经过这样的修改之后，我们就可以更加灵活地使用max()函数了，比如说求3个浮点型数字的最 大值，同样也变得轻而易举：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">val</span> a = <span class="number">3.5</span></span><br><span class="line"><span class="keyword">val</span> b = <span class="number">3.8</span></span><br><span class="line"><span class="keyword">val</span> c = <span class="number">4.1</span></span><br><span class="line"><span class="keyword">val</span> largest = max(a,b,c)</span><br></pre></td></tr></table></figure>

<p>而且现在不管是双精度浮点型、单精度浮点型，还是短整型、整型、长整型，只要是实现 Comparable接口的子类型，max()函数全部支持获取它们的最大值，是一种一劳永逸的做 法。</p>
<h3 id="简化Toast的用法"><a href="#简化Toast的用法" class="headerlink" title="简化Toast的用法"></a>简化Toast的用法</h3><p>首先回顾一下Toast的标准用法吧，如果想要在界面上弹出一段文字提示需要这样写：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">Toast.makeText(context,<span class="string">&quot;This is Toast&quot;</span>,Toast.LEGNTH_SHORT).show()</span><br></pre></td></tr></table></figure>

<p>是不是很长的一段代码？而且曾经不知道有多少人因为忘记调用最后的show()方法，导致 Toast无法弹出，从而产生一些千奇百怪的bug。</p>
<p>由于Toast是非常常用的功能，每次都需要编写这么长的一段代码确实让人很头疼，这个时候你 就应该考虑对Toast的用法进行简化了。</p>
<p>我们来分析一下，Toast的makeText()方法接收3个参数：第一个参数是Toast显示的上下文环 境，必不可少；第二个参数是Toast显示的内容，需要由调用方进行指定，可以传入字符串和字 符串资源id两种类型；第三个参数是Toast显示的时长，只支持Toast.LENGTH_SHORT和 Toast.LENGTH_LONG这两种值，相对来说变化不大。</p>
<p>那么我们就可以给String类和Int类各添加一个扩展函数，并在里面封装弹出Toast的具体逻 辑。这样以后每次想要弹出Toast提示时，只需要调用它们的扩展函数就可以了。</p>
<p>新建一个Toast.kt文件，并在其中编写如下代码：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">showToast</span><span class="params">(context: <span class="type">Context</span>)</span></span> &#123; </span><br><span class="line">     Toast.makeText(context, <span class="keyword">this</span>, Toast.LENGTH_SHORT).show() </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="built_in">Int</span>.<span class="title">showToast</span><span class="params">(context: <span class="type">Context</span>)</span></span> &#123; </span><br><span class="line">     Toast.makeText(context, <span class="keyword">this</span>, Toast.LENGTH_SHORT).show() </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>这里分别给String类和Int类新增了一个showToast()函数，并让它们都接收一个Context 参数。然后在函数的内部，我们仍然使用了Toast原生API用法，只是将弹出的内容改成了 this，另外将Toast的显示时长固定设置成Toast.LENGTH_SHORT。</p>
<p>那么经过这样的扩展之后，我们以后在使用Toast时可以变得多么简单呢？体验一下就知道了， 比如同样弹出一段文字提醒就可以这么写：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;This is Toast&quot;</span>.showToast(context)</span><br></pre></td></tr></table></figure>

<p>怎么样，比起原生Toast的用法，有没有觉得这种写法畅快多了呢？另外，这只是直接弹出一段 字符串文本的写法，如果你想弹出一个定义在strings.xml中的字符串资源，也非常简单，写法 如下：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">R.string.app_name.showToast(context)</span><br></pre></td></tr></table></figure>

<p>这两种写法分别调用的就是我们刚才在String类和Int类中添加的showToast()扩展函数。</p>
<p>当然，这种写法其实还存在一个问题，就是Toast的显示时长被固定了，如果我现在想要使用 Toast.LENGTH_LONG类型的显示时长该怎么办呢？要解决这个问题，其实最简单的做法就是 在showToast()函数中再声明一个显示时长参数，但是这样每次调用showToast()函数时都 要额外多传入一个参数，无疑增加了使用复杂度。</p>
<p>不知道你现在有没有受到什么启发呢？回顾一下，我们在第2章学习Kotlin基础语法的时候，曾 经学过给函数设定参数默认值的功能。只要借助这个功能，我们就可以在不增加showToast() 函数使用复杂度的情况下，又让它可以支持动态指定显示时长了。修改Toast.kt中的代码，如下 所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> String.<span class="title">showToast</span><span class="params">(context: <span class="type">Context</span>, duration: <span class="type">Int</span> = Toast.LENGTH_SHORT)</span></span> &#123; </span><br><span class="line">     Toast.makeText(context, <span class="keyword">this</span>, duration).show() </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="built_in">Int</span>.<span class="title">showToast</span><span class="params">(context: <span class="type">Context</span>, duration: <span class="type">Int</span> = Toast.LENGTH_SHORT)</span></span> &#123; </span><br><span class="line">     Toast.makeText(context, <span class="keyword">this</span>, duration).show() </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，我们给showToast()函数增加了一个显示时长参数，但同时也给它指定了一个参数 默认值。这样我们之前所使用的showToast()函数的写法将完全不受影响，默认会使用 Toast.LENGTH_SHORT类型的显示时长。而如果你想要使用Toast.LENGTH_LONG的显示时 长，只需要这样写就可以了：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;This is Toast&quot;</span>.showToast(context, Toast.LENGTH_LONG)</span><br></pre></td></tr></table></figure>

<h3 id="简化Snackbar的用法"><a href="#简化Snackbar的用法" class="headerlink" title="简化Snackbar的用法"></a>简化Snackbar的用法</h3><p>先来回顾一下Snackbar的常规用法吧，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">Snackbar.make(view, <span class="string">&quot;This is Snackbar&quot;</span>, Snackbar.LENGTH_SHORT) </span><br><span class="line">     .setAction(<span class="string">&quot;Action&quot;</span>) &#123; </span><br><span class="line">     <span class="comment">// 处理具体的逻辑 </span></span><br><span class="line">     &#125; </span><br><span class="line">     .show()</span><br></pre></td></tr></table></figure>

<p>可以看到，Snackbar中make()方法的第一个参数变成了View，而Toast中makeText()方法 的第一个参数是Context，另外Snackbar还可以调用setAction()方法来设置一个额外的点 击事件。除了这些区别之外，Snackbar和Toast的其他用法都是相似的。</p>
<p>那么对于这种结构的API，我们该如何进行简化呢？其实简化的方式并不固定，接下来我即将演 示的写法也只是我个人认为比较不错的一种。</p>
<p>由于make()方法接收一个View参数，Snackbar会使用这个View自动查找最外层的布局，用 于展示Snackbar。因此，我们就可以给View类添加一个扩展函数，并在里面封装显示 Snackbar的具体逻辑。新建一个Snackbar.kt文件，并编写如下代码：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> View.<span class="title">showSnackbar</span><span class="params">(text: <span class="type">String</span>, duration: <span class="type">Int</span> = Snackbar.LENGTH_SHORT)</span></span> &#123; </span><br><span class="line">     Snackbar.make(<span class="keyword">this</span>, text, duration).show() </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">fun</span> View.<span class="title">showSnackbar</span><span class="params">(resId: <span class="type">Int</span>, duration: <span class="type">Int</span> = Snackbar.LENGTH_SHORT)</span></span> &#123; </span><br><span class="line">     Snackbar.make(<span class="keyword">this</span>, resId, duration).show() </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这段代码应该还是很好理解的，和刚才的showToast()函数比较相似。只是我们将扩展函数添 加到了View类当中，并在参数列表上声明了Snackbar要显示的内容以及显示的时长。另外， Snackbar和Toast类似，显示的内容也是支持传入字符串和字符串资源id两种类型的，因此这 里我们给showSnackbar()函数进行了两种参数类型的函数重载。</p>
<p>现在想要使用Snackbar显示一段文本提示，只需要这样写就可以了：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">view.showSnackbar(<span class="string">&quot;This is Snackbar&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>假如Snackbar没有setAction()方法，那么我们的简化工作到这里就可以结束了。但是 setAction()方法作为Snackbar最大的特色之一，如果不能支持的话，我们编写的 showSnackbar()函数也就变得毫无意义了</p>
<p>这个时候，神通广大的高阶函数又能派上用场了，我们可以让showSnackbar()函数再额外接 收一个函数类型参数，以此来实现Snackbar的完整功能支持。修改Snackbar.kt中的代码，如 下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> View.<span class="title">showSnackbar</span><span class="params">(text: <span class="type">String</span>, actionText: <span class="type">String</span>? = <span class="literal">null</span>, </span></span></span><br><span class="line"><span class="params"><span class="function">     duration: <span class="type">Int</span> = Snackbar.LENGTH_SHORT, block: (() -&gt; <span class="type">Unit</span>)? = <span class="literal">null</span>)</span></span> &#123; </span><br><span class="line">             <span class="keyword">val</span> snackbar = Snackbar.make(<span class="keyword">this</span>, text, duration) </span><br><span class="line">             <span class="keyword">if</span> (actionText != <span class="literal">null</span> &amp;&amp; block != <span class="literal">null</span>) &#123; </span><br><span class="line">                 snackbar.setAction(actionText) &#123; </span><br><span class="line">                 block() </span><br><span class="line">             &#125; </span><br><span class="line">             &#125; </span><br><span class="line">             snackbar.show() </span><br><span class="line">        &#125; </span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">fun</span> View.<span class="title">showSnackbar</span><span class="params">(resId: <span class="type">Int</span>, actionResId: <span class="type">Int</span>? = <span class="literal">null</span>, </span></span></span><br><span class="line"><span class="params"><span class="function">         duration: <span class="type">Int</span> = Snackbar.LENGTH_SHORT, block: (() -&gt; <span class="type">Unit</span>)? = <span class="literal">null</span>)</span></span> &#123; </span><br><span class="line">             <span class="keyword">val</span> snackbar = Snackbar.make(<span class="keyword">this</span>, resId, duration) </span><br><span class="line">             <span class="keyword">if</span> (actionResId != <span class="literal">null</span> &amp;&amp; block != <span class="literal">null</span>) &#123; </span><br><span class="line">             snackbar.setAction(actionResId) &#123; </span><br><span class="line">             block()</span><br><span class="line">         &#125; </span><br><span class="line">     &#125; </span><br><span class="line">     snackbar.show() </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>这样showSnackbar()函数就拥有比较完整的Snackbar功能了，比如本小节最开始的那段示 例代码，现在就可以使用如下写法进行实现：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">view.showSnackbar(<span class="string">&quot;This is Snackbar&quot;</span>, <span class="string">&quot;Action&quot;</span>) &#123; </span><br><span class="line"> <span class="comment">// 处理具体的逻辑 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">lele</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/01/11/Mterial-Design/">http://example.com/2025/01/11/Mterial-Design/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Hexo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/01/19/Jetpack/" title="Jetpack"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Jetpack</div></div></a></div><div class="next-post pull-right"><a href="/2025/01/10/%E5%8D%8F%E7%A8%8B/" title="协程"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">协程</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Material-Design"><span class="toc-text">Material Design</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFMaterial-Desing"><span class="toc-text">什么是Material Desing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Toolbar"><span class="toc-text">Toolbar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8%E8%8F%9C%E5%8D%95"><span class="toc-text">滑动菜单</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DrawerLayout"><span class="toc-text">DrawerLayout</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%8F%9C%E5%8D%95%E5%AF%BC%E8%88%AA%E6%8C%89%E9%92%AE"><span class="toc-text">设置菜单导航按钮</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NavigationView"><span class="toc-text">NavigationView</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%82%AC%E6%B5%AE%E6%8C%89%E9%92%AE%E5%92%8C%E5%8F%AF%E4%BA%A4%E4%BA%92%E6%8F%90%E7%A4%BA"><span class="toc-text">悬浮按钮和可交互提示</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FloatingActionButton"><span class="toc-text">FloatingActionButton</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Snackbar"><span class="toc-text">Snackbar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CoordinatorLayout"><span class="toc-text">CoordinatorLayout</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RecyclverView%E9%80%82%E9%85%8D%E5%99%A8%E5%86%99%E6%B3%95"><span class="toc-text">RecyclverView适配器写法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%A1%E7%89%87%E5%BC%8F%E5%B8%83%E5%B1%80"><span class="toc-text">卡片式布局</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MaterialCardView"><span class="toc-text">MaterialCardView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AppBarLayout"><span class="toc-text">AppBarLayout</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E6%8B%89%E5%88%B7%E6%96%B0"><span class="toc-text">下拉刷新</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E6%8A%98%E5%8F%A0%E5%BC%8F%E6%A0%87%E9%A2%98%E6%A0%8F"><span class="toc-text">可折叠式标题栏</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CollapsingToolbarLayout"><span class="toc-text">CollapsingToolbarLayout</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%85%E5%88%86%E5%88%A9%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%8A%B6%E6%80%81%E6%A0%8F%E7%A9%BA%E9%97%B4"><span class="toc-text">充分利用系统状态栏空间</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kotlin%E8%AF%BE%E5%A0%82%EF%BC%9A%E7%BC%96%E5%86%99%E5%A5%BD%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7%E6%96%B9%E6%B3%95"><span class="toc-text">Kotlin课堂：编写好用的工具方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82N%E4%B8%AA%E6%95%B0%E7%9A%84%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E5%80%BC"><span class="toc-text">求N个数的最大最小值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96Toast%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-text">简化Toast的用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96Snackbar%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-text">简化Snackbar的用法</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By lele</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="30" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>