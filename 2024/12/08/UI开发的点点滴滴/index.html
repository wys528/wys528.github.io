<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>UI开发的点点滴滴 | Hexo</title><meta name="author" content="lele"><meta name="copyright" content="lele"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="UI开发常用控件的使用方法TextView下面我们就来看一看TextView的更多用法，将activity_main.xml的代码改成如下所示： &lt;LinearLayout xmlns:android&#x3D;&quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&quot;     android:orientation&#x3D;&quot;vertical&amp;qu">
<meta property="og:type" content="article">
<meta property="og:title" content="UI开发的点点滴滴">
<meta property="og:url" content="http://example.com/2024/12/08/UI%E5%BC%80%E5%8F%91%E7%9A%84%E7%82%B9%E7%82%B9%E6%BB%B4%E6%BB%B4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="UI开发常用控件的使用方法TextView下面我们就来看一看TextView的更多用法，将activity_main.xml的代码改成如下所示： &lt;LinearLayout xmlns:android&#x3D;&quot;http:&#x2F;&#x2F;schemas.android.com&#x2F;apk&#x2F;res&#x2F;android&quot;     android:orientation&#x3D;&quot;vertical&amp;qu">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg">
<meta property="article:published_time" content="2024-12-08T07:37:27.000Z">
<meta property="article:modified_time" content="2025-03-25T12:42:04.488Z">
<meta property="article:author" content="lele">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" href="/image/tx.jpg"><link rel="canonical" href="http://example.com/2024/12/08/UI%E5%BC%80%E5%8F%91%E7%9A%84%E7%82%B9%E7%82%B9%E6%BB%B4%E6%BB%B4/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'UI开发的点点滴滴',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-03-25 20:42:04'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/tx.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">142</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Hexo"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/image/test.gif"/><span class="site-name">Hexo</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">UI开发的点点滴滴</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-08T07:37:27.000Z" title="发表于 2024-12-08 15:37:27">2024-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-03-25T12:42:04.488Z" title="更新于 2025-03-25 20:42:04">2025-03-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Android%E5%BC%80%E5%8F%91/">Android开发</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">15k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>62分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="UI开发的点点滴滴"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="UI开发"><a href="#UI开发" class="headerlink" title="UI开发"></a>UI开发</h1><h2 id="常用控件的使用方法"><a href="#常用控件的使用方法" class="headerlink" title="常用控件的使用方法"></a>常用控件的使用方法</h2><h3 id="TextView"><a href="#TextView" class="headerlink" title="TextView"></a>TextView</h3><p>下面我们就来看一看TextView的更多用法，将activity_main.xml的代码改成如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/textView&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is TextView&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>Android中所有的控件都具有这两个属 性，可选值有3种：match_parent、wrap_content和固定值。固 定值表示表示给控件指定一个固定的尺寸，单位一般用dp，这是一种屏幕密度无关的尺寸单 位，可以保证在不同分辨率的手机上显示效果尽可能地一致，如50 dp就是一个有效的固定值。</p>
<p>修改TextView的文字对 齐方式，如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/textView&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is TextView&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>可选值有top、bottom、start、 end、center</p>
<p>另外，我们还可以对TextView中文字的颜色和大小进行修改，如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/textView&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#00ff00&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is TextView&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h3 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h3><p>它可配置的属性和TextView是差不多的，我们可以在 activity_main.xml中这样加入Button</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    ... </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果你很细心的话，可能会发现我们在XML中指定按钮上的文字明明是Button，可是为什么界 面上显示的却是BUTTON呢？这是因为Android系统默认会将按钮上的英文字母全部转换成大 写，可能是认为按钮上的内容都比较重要吧。如果这不是你想要的效果，可以在XML中添加 android:textAllCaps&#x3D;”false”这个属性</p>
<p>接下来我们可以在MainActivity中为Button的点击事件注册一个监听器，如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>:<span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentVeiw(R.layout.activity_main)</span><br><span class="line">        button.setOnClickListener&#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>除了使用函数式API的方式来注册监听器，也可以使用实现接口的方式来进行注册，代码如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>:<span class="type">AppCompatActivity</span>(),View.OnClckListener&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentVew(R.layout.activity_main)</span><br><span class="line">        button.setOnClickListener(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v:<span class="type">View</span>?)</span></span>&#123;</span><br><span class="line">        whne(v?.id)&#123;</span><br><span class="line">            R.id.button-&gt;&#123;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里我们让MainActivity实现了View.OnClickListener接口，并重写了onClick()方法， 然后在调用button的setOnClickListener()方法时将MainActivity的实例传了进去。这样 每当点击按钮时，就会执行onClick()方法中的代码了</p>
<h3 id="EditText"><a href="#EditText" class="headerlink" title="EditText"></a>EditText</h3><p>EditText是程序用于和用户进行交互的另一个重要控件，它允许用户在控件里输入和编辑内 容，并可以在程序中对这些内容进行处理。那我们来看一看如何 在界面上加入EditText吧，修改activity_main.xml中的代码，如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">EditText</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/editText&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br></pre></td></tr></table></figure>

<p>你可能平时会留意到，一些做得比较人性化的软件会在输入框里显示一些提示性的文字，一旦 用户输入了任何内容，这些提示性的文字就会消失。这种提示功能在Android里是非常容易实现 的，我们甚至不需要做任何逻辑控制，因为系统已经帮我们都处理好了。修改 activity_main.xml，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">EditText</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/editText&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:hint</span>=<span class="string">&quot;Type something here&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>不过，随着输入的内容不断增多，EditText会被不断地拉长。这是由于EditText的高度指定的是 wrap_content，因此它总能包含住里面的内容，但是当输入的内容过多时，界面就会变得非 常难看。我们可以使用android:maxLines属性来解决这个问题，修改activity_main.xml， 如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">EditText</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/editText&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:hint</span>=<span class="string">&quot;Type something here&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:maxLines</span>=<span class="string">&quot;2&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>点击按钮以弹出EditText中的消息</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>:<span class="type">AppCompatActivity</span>(),View.OnclickListener&#123;</span><br><span class="line">    <span class="keyword">lateinit</span> <span class="keyword">var</span> editText:EditText</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        <span class="keyword">val</span> button:Button=findViewById(R.id.button)</span><br><span class="line">        editText=findViewById(R.id.editText)</span><br><span class="line">        button.setOnClickListener(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v:<span class="type">View</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">when</span>(v?.id)&#123;</span><br><span class="line">            R.id.button-&gt;&#123;</span><br><span class="line">                <span class="keyword">var</span> inputText = editText.text.toString()</span><br><span class="line">                Toast.makeText(<span class="keyword">this</span>,inputText,Toast.LENGTH_SHORT).show()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ImageView"><a href="#ImageView" class="headerlink" title="ImageView"></a>ImageView</h3><p>ImageView是用于在界面上展示图片的一个控件，它可以让我们的程序界面变得更加丰富多彩。图片通常是放在以drawable开头的目录下的，并 且要带上具体的分辨率。现在最主流的手机屏幕分辨率大多是xxhdpi的，所以我们在res目录下 再新建一个drawable-xxhdpi目录，然后将事先准备好的两张图片img_1.png和img_2.png复 制到该目录当中</p>
<p>接下来修改activity_main.xml，如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/textView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is TextView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#00ff00&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textAllCaps</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/editText&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:hint</span>=<span class="string">&quot;Type something here&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:maxLines</span>=<span class="string">&quot;2&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/imageView&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:src</span>=<span class="string">&quot;@drwaable/img_1&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>用android:src属性给ImageView指定了一张图片。由于图片的宽和高都 是未知的，所以将ImageView的宽和高都设定为wrap_content，这样就保证了不管图片的尺 寸是多少，都可以完整地展示出来</p>
<p>我们还可以在程序中通过代码动态地更改ImageView中的图片，修改MainActivity的代码，如 下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>(),View.OnClickListener&#123;</span><br><span class="line">    ....</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v:<span class="type">View</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">when</span>(v?.id)&#123;</span><br><span class="line">            R.id.button-&gt;&#123;</span><br><span class="line">                imageViw.setImageResource(R.drwaable.img_2)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ProgressBar"><a href="#ProgressBar" class="headerlink" title="ProgressBar"></a>ProgressBar</h3><p>ProgressBar用于在界面上显示一个进度条，表示我们的程序正在加载一些数据。它的用法也 非常简单，修改activity_main.xml中的代码，如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinerLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:orientatio</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ProgerssBar</span> <span class="attr">android:id</span>=<span class="string">&quot;@id/progressBar&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinerLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>android:visibility进行指定，可选值有3种：visible、invisible和gone。visible 表示控件是可见的，这个值是默认值，不指定android:visibility时，控件都是可见的。 invisible表示控件不可见，但是它仍然占据着原来的位置和大小，可以理解成控件变成透明 状态了。gone则表示控件不仅不可见，而且不再占用任何屏幕空间。我们可以通过代码来设置 控件的可见性，使用的是setVisibility()方法，允许传入View.VISIBLE、 View.INVISIBLE和View.GONE这3种值</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>:<span class="type">AppCompatActivity</span>(),View.OnClickListener&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v:<span class="type">View</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">when</span>(v?.id)&#123;</span><br><span class="line">            R.id.button-&gt;&#123;</span><br><span class="line">                <span class="keyword">if</span>(progressBar.visibility == View.VISIBLE)&#123;</span><br><span class="line">                    progerssBar.visibility = View.GONE</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    progressBar.visibility = View.VISIBLE</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外，我们还可以给ProgressBar指定不同的样式，刚刚是圆形进度条，通过style属性可以将 它指定成水平进度条，修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    ... </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">ProgressBar</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/progressBar&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;?android:attr/progressBarStyleHorizontal&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:max</span>=<span class="string">&quot;100&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>指定成水平进度条后，我们还可以通过android:max属性给进度条设置一个最大值，然后在代 码中动态地更改进度条的进度。修改MainActivity中的代码，如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>(), View.OnClickListener &#123; </span><br><span class="line"> </span><br><span class="line">    ... </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v: <span class="type">View</span>?)</span></span> &#123; </span><br><span class="line">        <span class="keyword">when</span> (v?.id) &#123; </span><br><span class="line">            R.id.button -&gt; &#123; </span><br><span class="line">                progressBar.progress = progressBar.progress + <span class="number">10</span> </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="AlertDialog"><a href="#AlertDialog" class="headerlink" title="AlertDialog"></a>AlertDialog</h3><p>AlertDialog可以在当前界面弹出一个对话框，这个对话框是置顶于所有界面元素之上的，能够 屏蔽其他控件的交互能力，因此AlertDialog一般用于提示一些非常重要的内容或者警告信息</p>
<p>比如为了防止用户误删重要内容，在删除前弹出一个确认对话框。下面我们来学习一下它的用 法，修改MainActivity中的代码，如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>:<span class="type">AppCOmpatActivity</span>(),View.onClickListener&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v:<span class="type">View</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">when</span>(v?.id)&#123;</span><br><span class="line">            R.id.button-&gt;&#123;</span><br><span class="line">                AlertDialog.Builder(<span class="keyword">this</span>).apply&#123;</span><br><span class="line">                    setTitle(<span class="string">&quot;This is Dialog&quot;</span>)</span><br><span class="line">                    setMessage(<span class="string">&quot;Something important.&quot;</span>)</span><br><span class="line">                    setCancelable(<span class="literal">false</span>)</span><br><span class="line">                    setPostiviButton(<span class="string">&quot;OK&quot;</span>)&#123;dialog,which-&gt;&#125;</span><br><span class="line">                    setNegativeButton(<span class="string">&quot;Cancel&quot;</span>)&#123;dialog,which-&gt;&#125;</span><br><span class="line">                    show()                    </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="详解3种基本布局"><a href="#详解3种基本布局" class="headerlink" title="详解3种基本布局"></a>详解3种基本布局</h2><h3 id="LinearLayot"><a href="#LinearLayot" class="headerlink" title="LinearLayot"></a>LinearLayot</h3><p>下面来看android:layout_gravity属性，它和我们上一节中学到的android:gravity属 性看起来有些相似，这两个属性有什么区别呢？其实从名字就可以看出，android:gravity 用于指定文字在控件中的对齐方式，而android:layout_gravity用于指定控件在布局中的 对齐方式。android:layout_gravity的可选值和android:gravity差不多，但是需要注 意，当LinearLayout的排列方向是horizontal时，只有垂直方向上的对齐方式才会生效。因 为此时水平方向上的长度是不固定的，每添加一个控件，水平方向上的长度都会改变，因而无 法指定该方向上的对齐方式。同样的道理，当LinearLayout的排列方向是vertical时，只有 水平方向上的对齐方式才会生效。修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button1&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;top&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 1&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button2&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 2&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;bottom&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 3&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>接下来我们学习LinearLayout中的另一个重要属性——android:layout_weight。这个属 性允许我们使用比例的方式来指定控件的大小，它在手机屏幕的适配性方面可以起到非常重要 的作用。比如，我们正在编写一个消息发送界面，需要一个文本编辑框和一个发送按钮，修改 activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">EditText</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/input_message&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:hint</span>=<span class="string">&quot;Type something&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/send&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Send&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>你会发现，这里竟然将EditText和Button的宽度都指定成了0 dp，这样文本编辑框和按钮还能 显示出来吗？不用担心，由于我们使用了android:layout_weight属性，此时控件的宽度就 不应该再由android:layout_width来决定了，这里指定成0 dp是一种比较规范的写法。</p>
<p>然后在EditText和Button里将android:layout_weight属性的值指定为1，这表示EditText 和Button将在水平方向平分宽度</p>
<p>为什么将android:layout_weight属性的值同时指定为1就会平分屏幕宽度呢？其实原理很 简单，系统会先把LinearLayout下所有控件指定的layout_weight值相加，得到一个总值， 然后每个控件所占大小的比例就是用该控件的layout_weight值除以刚才算出的总值。因此如 果想让EditText占据屏幕宽度的3&#x2F;5，Button占据屏幕宽度的2&#x2F;5，只需要将EditText的 layout_ weight改成3，Button的layout_weight改成2就可以了</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;horizontal&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">EditText</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/input_message&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:hint</span>=<span class="string">&quot;Type something&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/send&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Send&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们仅指定了EditText的android:layout_weight属性，并将Button的宽度改回了 wrap_content。这表示Button的宽度仍然按照wrap_content来计算，而EditText则会占满 屏幕所有的剩余空间。使用这种方式编写的界面，不仅可以适配各种屏幕，而且看起来也更加 舒服。</p>
<h3 id="RelativeLayout"><a href="#RelativeLayout" class="headerlink" title="RelativeLayout"></a>RelativeLayout</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button1&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentLeft</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentTop</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 1&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button2&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentRight</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentTop</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 2&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 3&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button4&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentLeft</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 4&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button5&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentBottom</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_alignParentRight</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 5&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>以上代码不需要做过多解释，因为实在是太好理解了。我们让Button 1和父布局的左上角对 齐，Button 2和父布局的右上角对齐，Button 3居中显示，Button 4和父布局的左下角对齐， Button 5和父布局的右下角对齐。虽然android:layout_alignParentLeft、 android:layout_alignParentTop、android:layout_alignParentRight、 android:layout_alignParentBottom、android:layout_centerInParent这几个属 性我们之前都没接触过，可是它们的名字已经完全说明了它们的作用。</p>
<p>上面例子中的每个控件都是相对于父布局进行定位的，那控件可不可以相对于控件进行定位 呢？当然是可以的，修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RelativeLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_centerInParent</span>=<span class="string">&quot;true&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 3&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button1&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_above</span>=<span class="string">&quot;@id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_toLeftOf</span>=<span class="string">&quot;@id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 1&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button2&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_above</span>=<span class="string">&quot;@id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_toRightOf</span>=<span class="string">&quot;@id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 2&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button4&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_below</span>=<span class="string">&quot;@id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_toLeftOf</span>=<span class="string">&quot;@id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 4&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button5&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_below</span>=<span class="string">&quot;@id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_toRightOf</span>=<span class="string">&quot;@id/button3&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button 5&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>RelativeLayout中还有另外一组相对于控件进行定位的属性，android:layout_alignLeft 表示让一个控件的左边缘和另一个控件的左边缘对齐，android:layout_alignRight表示 让一个控件的右边缘和另一个控件的右边缘对齐。此外，还有android:layout_alignTop和 android:layout_alignBottom，道理都是一样的</p>
<h3 id="FrameLayout"><a href="#FrameLayout" class="headerlink" title="FrameLayout"></a>FrameLayout</h3><p>FrameLayout又称作帧布局，它相比于前面两种布局就简单太多了，因此它的应用场景少了很 多。这种布局没有丰富的定位方式，所有的控件都会默认摆放在布局的左上角。让我们通过例子来看一看吧，修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/textView&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is TextView&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>可以看到，文字和按钮都位于布局的左上角。由于Button是在TextView之后添加的，因此按钮 压在了文字的上面</p>
<p>当然，除了这种默认效果之外，我们还可以使用layout_gravity属性来指定控件在布局中的 对齐方式，这和LinearLayout中的用法是相似的。修改activity_main.xml中的代码，如下所 示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/textView&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;left&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;This is TextView&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;right&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Button&quot;</span> </span></span><br><span class="line"><span class="tag">        /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="系统控件不够用？创建自定义控件"><a href="#系统控件不够用？创建自定义控件" class="headerlink" title="系统控件不够用？创建自定义控件"></a>系统控件不够用？创建自定义控件</h2><p>我们所用的所有控件都是直接或间接继承自View的，所用的所有布局都是直接或间 接继承自ViewGroup的。View是Android中最基本的一种UI组件，它可以在屏幕上绘制一块矩 形区域，并能响应这块区域的各种事件，因此，我们使用的各种控件其实就是在View的基础上 又添加了各自特有的功能。而ViewGroup则是一种特殊的View，它可以包含很多子View和子 ViewGroup，是一个用于放置控件和布局的容器。</p>
<h3 id="引入布局"><a href="#引入布局" class="headerlink" title="引入布局"></a>引入布局</h3><p>如果在每个Activity的布局中都编 写一遍同样的标题栏代码，明显就会导致代码的大量重复。这时我们就可以使用引入布局的方 式来解决这个问题，在layout目录下新建一个title.xml布局，代码如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:background</span>=<span class="string">&quot;@drawable/title_bg&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/titleBack&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_margin</span>=<span class="string">&quot;5dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@drawable/back_bg&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Back&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#fff&quot;</span>/&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/titleText&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:gravity</span>=<span class="string">&quot;center&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Title Text&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#fff&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/titleEdit&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_margin</span>=<span class="string">&quot;5dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:background</span>=<span class="string">&quot;@drawable/edit_bg&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Edit&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;#fff&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>现在标题栏布局已经编写完成了，剩下的就是如何在程序中使用这个标题栏了，修改 activity_main.xml中的代码，如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> &gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">layout</span>=<span class="string">&quot;@layout/title&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>最后别忘了在MainActivity中将系统自带的标题栏隐藏掉，代码如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>() &#123; </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123; </span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState) </span><br><span class="line">        setContentView(R.layout.activity_main) </span><br><span class="line">        supportActionBar?.hide() </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="创建自定义控件"><a href="#创建自定义控件" class="headerlink" title="创建自定义控件"></a>创建自定义控件</h3><p>引入布局的技巧确实解决了重复编写布局代码的问题，但是如果布局中有一些控件要求能够响 应事件，我们还是需要在每个Activity中为这些控件单独编写一次事件注册的代码。比如标题栏 中的返回按钮，其实不管是在哪一个Activity中，这个按钮的功能都是相同的，即销毁当前 Activity。而如果在每一个Activity中都需要重新注册一遍返回按钮的点击事件，无疑会增加很 多重复代码，这种情况最好是使用自定义控件的方式来解决</p>
<p>新建TitleLayout继承自LinearLayout，让它成为我们自定义的标题栏控件，代码如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TitleLayout</span>(context:Context,attrs:AttributeSet):LinerLayout(context,attrs)&#123;</span><br><span class="line">    <span class="keyword">init</span>&#123;</span><br><span class="line">        LayoutInflater.from(context).inflate(R.layout.title,<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里我们在TitleLayout的主构造函数中声明了Context和AttributeSet这两个参数，在布局中 引入TitleLayout控件时就会调用这个构造函数。然后在init结构体中需要对标题栏布局进行动 态加载，这就要借助LayoutInflater来实现了。通过LayoutInflater的from()方法可以构建出 一个LayoutInflater对象，然后调用inflate()方法就可以动态加载一个布局文件。 inflate()方法接收两个参数：第一个参数是要加载的布局文件的id，这里我们传入 R.layout.title；第二个参数是给加载好的布局再添加一个父布局，这里我们想要指定为 TitleLayout，于是直接传入this。</p>
<p>现在自定义控件已经创建好了，接下来我们需要在布局文件中添加这个自定义控件，修改 activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> &gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">com.example.uicustomviews.TitleLayout</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>添加自定义控件和添加普通控件的方式基本是一样的，只不过在添加自定义控件的时候，我们 需要指明控件的完整类名，包名在这里是不可以省略的。</p>
<p>下面我们尝试为标题栏中的按钮注册点击事件，修改TitleLayout中的代码，如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TitleLayout</span>(context: Context, attrs: AttributeSet) : LinearLayout(context, attrs) &#123;  </span><br><span class="line">    <span class="keyword">init</span> &#123; </span><br><span class="line">        LayoutInflater.from(context).inflate(R.layout.title, <span class="keyword">this</span>) </span><br><span class="line">        titleBack.setOnClickListener &#123; </span><br><span class="line">            <span class="keyword">val</span> activity = context <span class="keyword">as</span> Activity </span><br><span class="line">            activity.finish() </span><br><span class="line">        &#125; </span><br><span class="line">        titleEdit.setOnClickListener &#123; </span><br><span class="line">            Toast.makeText(context, <span class="string">&quot;You clicked Edit button&quot;</span>, Toast.LENGTH_SHORT).show() </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>注意，TitleLayout中接收的context参数实际上是一个Activity的实例，在返回按钮的点击事 件里，我们要先将它转换成Activity类型，然后再调用finish()方法销毁当前的Activity。 Kotlin中的类型强制转换使用的关键字是as，由于是第一次用到，所以这里单独讲解一下</p>
<h3 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h3><h3 id="ListView的简单使用方法"><a href="#ListView的简单使用方法" class="headerlink" title="ListView的简单使用方法"></a>ListView的简单使用方法</h3><p>首先新建一个ListViewTest项目，并让Android Studio自动帮我们创建好Activity。然后修改 activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">ListView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/listView&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来修改MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>() &#123; </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> <span class="keyword">data</span> = listOf(<span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Orange&quot;</span>, <span class="string">&quot;Watermelon&quot;</span>, </span><br><span class="line">        <span class="string">&quot;Pear&quot;</span>, <span class="string">&quot;Grape&quot;</span>, <span class="string">&quot;Pineapple&quot;</span>, <span class="string">&quot;Strawberry&quot;</span>, <span class="string">&quot;Cherry&quot;</span>, <span class="string">&quot;Mango&quot;</span>, </span><br><span class="line">        <span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Orange&quot;</span>, <span class="string">&quot;Watermelon&quot;</span>, <span class="string">&quot;Pear&quot;</span>, <span class="string">&quot;Grape&quot;</span>, </span><br><span class="line">        <span class="string">&quot;Pineapple&quot;</span>, <span class="string">&quot;Strawberry&quot;</span>, <span class="string">&quot;Cherry&quot;</span>, <span class="string">&quot;Mango&quot;</span>) </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123; </span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState) </span><br><span class="line">        setContentView(R.layout.activity_main) </span><br><span class="line">        <span class="keyword">val</span> adapter = ArrayAdapter&lt;String&gt;(<span class="keyword">this</span>,android.R.layout.simple_list_item_1,<span class="keyword">data</span>) </span><br><span class="line">        listView.adapter = adapter </span><br><span class="line">    &#125; </span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>集合中的数据是无法直接传递给ListView的，我们还需要借助适配器来完成。Android 中提供了很多适配器的实现类，其中我认为最好用的就是ArrayAdapter。它可以通过泛型来指 定要适配的数据类型，然后在构造函数中把要适配的数据传入。ArrayAdapter有多个构造函数 的重载，你应该根据实际情况选择最合适的一种。由于我们这里提供的数据都是字符串，因此 将ArrayAdapter的泛型指定为String，然后在ArrayAdapter的构造函数中依次传入Activity 的实例、ListView子项布局的id，以及数据源。注意，我们使用了 android.R.layout.simple_list_item_1作为ListView子项布局的id，这是一个 Android内置的布局文件，里面只有一个TextView，可用于简单地显示一段文本。这样适配器 对象就构建好了</p>
<p>最后，还需要调用ListView的setAdapter()方法，将构建好的适配器对象传递进去，这样 ListView和数据之间的关联就建立完成了。</p>
<h3 id="定制ListView-的界面"><a href="#定制ListView-的界面" class="headerlink" title="定制ListView 的界面"></a>定制ListView 的界面</h3><p>接着定义一个实体类，作为ListView适配器的适配类型。新建Fruit类，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Fruit</span>(<span class="keyword">val</span> name:String,<span class="keyword">val</span> imageId:<span class="built_in">Int</span>)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Fruit类中只有两个字段：name表示水果的名字，imageId表示水果对应图片的资源id。</p>
<p>然后需要为ListView的子项指定一个我们自定义的布局，在layout目录下新建 fruit_item.xml，代码如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;60dp&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitImage&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;40dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginLeft</span>=<span class="string">&quot;10dp&quot;</span>/&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitName&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_vertical&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginLeft</span>=<span class="string">&quot;10dp&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>在这个布局中，我们定义了一个ImageView用于显示水果的图片，又定义了一个TextView用于 显示水果的名称，并让ImageView和TextView都在垂直方向上居中显示。</p>
<p>接下来需要创建一个自定义的适配器，这个适配器继承自ArrayAdapter，并将泛型指定为 Fruit类。新建类FruitAdapter，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FruitAdapter</span>(activity:Activity:,<span class="keyword">val</span> resourceId:int,<span class="keyword">data</span>:List&lt;Fruit&gt;):</span><br><span class="line">		ArrayAdapter&lt;Fruint&gt;(activity,resuorceId,<span class="keyword">data</span>)&#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getView</span><span class="params">(position:<span class="type">Int</span>,convertView:<span class="type">View</span>?,parent:<span class="type">ViewGroup</span>)</span></span>:View&#123;</span><br><span class="line">                <span class="keyword">val</span> view = LayoutInflater.from(context).inflate(resourceId,parent,<span class="literal">false</span>)</span><br><span class="line">                <span class="keyword">val</span> fruitImage:ImageView = view.findViewById(R.id.fruitImage)</span><br><span class="line">                <span class="keyword">val</span> fruitName:TextView=view.findViewById(R.id.fruitName)</span><br><span class="line">                <span class="keyword">var</span> fruit = getItem(position)</span><br><span class="line">                <span class="keyword">if</span>(fruit!=<span class="literal">null</span>)&#123;</span><br><span class="line">                    fruitImage.setImageResource(fruit.imageId);</span><br><span class="line">                    fruitName.text=fruit.name</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> view</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>FruitAdapter定义了一个主构造函数，用于将Activity的实例、ListView子项布局的id和数 据源传递进来。另外又重写了getView()方法，这个方法在每个子项被滚动到屏幕内的时候会 被调用。</p>
<p>在getView()方法中，首先使用LayoutInflater来为这个子项加载我们传入的布局。 LayoutInflater的inflate()方法接收3个参数，前两个参数我们已经知道是什么意思了， 第三个参数指定成false，表示只让我们在父布局中声明的layout属性生效，但不会为这个 View添加父布局。因为一旦View有了父布局之后，它就不能再添加到ListView中了。如果你现 在还不能理解这段话的含义，也没关系，只需要知道这是ListView中的标准写法就可以了，当 你以后对View理解得更加深刻的时候，再来读这段话就没有问题了</p>
<p>我们继续往下看，接下来调用View的findViewById()方法分别获取到ImageView和 TextView的实例，然后通过getItem()方法得到当前项的Fruit实例，并分别调用它们的 setImageResource()和setText()方法设置显示的图片和文字，最后将布局返回，这样我 们自定义的适配器就完成了。</p>
<p>最后修改MainActivity中的代码，如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> fruitLsit = ArrayList&lt;Fruit&gt;()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">BUndle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        initFruits()</span><br><span class="line">        <span class="keyword">val</span> adapter = FruitAdaper(<span class="keyword">this</span>,R.layout.fruit_item,fruitList)</span><br><span class="line">        listView.adapter = adapter     </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">initFruits</span><span class="params">()</span></span> &#123; </span><br><span class="line">        repeat(<span class="number">2</span>) &#123; </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Apple&quot;</span>, R.drawable.apple_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Banana&quot;</span>, R.drawable.banana_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Orange&quot;</span>, R.drawable.orange_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Watermelon&quot;</span>, R.drawable.watermelon_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Pear&quot;</span>, R.drawable.pear_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Grape&quot;</span>, R.drawable.grape_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Pineapple&quot;</span>, R.drawable.pineapple_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Strawberry&quot;</span>, R.drawable.strawberry_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Cherry&quot;</span>, R.drawable.cherry_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Mango&quot;</span>, R.drawable.mango_pic)) </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，这里添加了一个initFruits()方法，用于初始化所有的水果数据。在Fruit类的 构造函数中将水果的名字和对应的图片id传入，然后把创建好的对象添加到水果列表中。另外， 我们使用了一个repeat函数将所有的水果数据添加了两遍，这是因为如果只添加一遍的话，数 据量还不足以充满整个屏幕。repeat函数是Kotlin中另外一个非常常用的标准函数，它允许你 传入一个数值n，然后会把Lambda表达式中的内容执行n遍。接着在onCreate()方法中创建 了FruitAdapter对象，并将它作为适配器传递给ListView，这样定制ListView界面的任务就 完成了</p>
<h3 id="提升ListView-的运行效率"><a href="#提升ListView-的运行效率" class="headerlink" title="提升ListView 的运行效率"></a>提升ListView 的运行效率</h3><p>之所以说ListView这个控件很难用，是因为它有很多细节可以优化，其中运行效率就是很重要 的一点。目前我们ListView的运行效率是很低的，因为在FruitAdapter的getView()方法 中，每次都将布局重新加载了一遍，当ListView快速滚动的时候，这就会成为性能的瓶颈。</p>
<p>仔细观察你会发现，getView()方法中还有一个convertView参数，这个参数用于将之前加 载好的布局进行缓存，以便之后进行重用，我们可以借助这个参数来进行性能优化。修改 FruitAdapter中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FruitAdapter</span>(activity:Activity,<span class="keyword">val</span> resuorceId:<span class="built_in">Int</span>,<span class="keyword">data</span>:List&lt;Fruit&gt;) :</span><br><span class="line">		ArrayAdapter&lt;Fruit&gt;(activity,resourceId,<span class="keyword">data</span>)&#123;</span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getView</span><span class="params">(position: <span class="type">Int</span>,convertView:<span class="type">View</span>?,parent:<span class="type">ViewGroup</span>)</span></span>:View&#123;</span><br><span class="line">                <span class="keyword">val</span> view:View</span><br><span class="line">                <span class="keyword">if</span>(convertView == <span class="literal">null</span>)&#123;</span><br><span class="line">                    view = LayoutInflater.from(context).inflate(resourceId,parent,<span class="literal">false</span>)</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    view = convertView</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">var</span> fruitImage:ImageView = view.findViewById(R.id.fruitImage)</span><br><span class="line">                <span class="keyword">var</span> fruitName:TextView = view.findVIew</span><br><span class="line">                fruit = getItem(position)</span><br><span class="line">                <span class="keyword">if</span>(fruit!=<span class="literal">null</span>)&#123;</span><br><span class="line">                    fruitImage.setImageResource(fruit.imageId)</span><br><span class="line">                    fruitName.text = fruit.name</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> view</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，现在我们在getView()方法中进行了判断：如果convertView为null，则使用 LayoutInflater去加载布局；如果不为null，则直接对convertView进行重用。这样就大 大提高了ListView的运行效率，在快速滚动的时候可以表现出更好的性能。</p>
<p>不过，目前我们的这份代码还是可以继续优化的，虽然现在已经不会再重复去加载布局，但是 每次在getView()方法中仍然会调用View的findViewById()方法来获取一次控件的实例。 我们可以借助一个ViewHolder来对这部分性能进行优化，修改FruitAdapter中的代码，如 下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FruitAdapter</span>(activity:Activity,<span class="keyword">val</span> resourceId:<span class="built_in">Int</span>,<span class="keyword">data</span>:List&lt;Fruit&gt;):</span><br><span class="line">		ArrayAdapter&lt;Fruit&gt;(activity,resourceId,<span class="keyword">data</span>)&#123;</span><br><span class="line">            <span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">ViewHolder</span>(<span class="keyword">val</span> fruitImage:ImageView,<span class="keyword">val</span> fruitName:TextView)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getView</span><span class="params">(position:<span class="type">Int</span>,convertView:<span class="type">View</span>?,parent:<span class="type">ViewGroup</span>)</span></span>:View&#123;</span><br><span class="line">                <span class="keyword">val</span> view:View</span><br><span class="line">                <span class="keyword">val</span> viewHolder:ViewHolder</span><br><span class="line">                <span class="keyword">if</span>(convertView==<span class="literal">null</span>)&#123;</span><br><span class="line">                    view = LayoutInflater.from(context).inflate(resourceId,parent,<span class="literal">false</span>)</span><br><span class="line">                    <span class="keyword">val</span> fruitImage:ImageView = view.findViewById(R.id.fruitImage)</span><br><span class="line">                    <span class="keyword">val</span> fruitName :TextVIew = view.findViewById(R.id.fruitName)</span><br><span class="line">                    viewHolder = ViewHolder(fruitImage,fruitName)</span><br><span class="line">                    view.tag = viewHolder</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    view = convertView</span><br><span class="line">                    viewHolder = view.tag <span class="keyword">as</span> ViewHolder</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">val</span> fruit = getItem(position)</span><br><span class="line">                <span class="keyword">if</span>(fruit !=<span class="literal">null</span>)&#123;</span><br><span class="line">                    viewHolder.fruitImage.setImageResource(fruit.imageId)</span><br><span class="line">                    viewHolder.fruitName.text = fruit.name</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> view</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>我们新增了一个内部类ViewHolder，用于对ImageView和TextView的控件实例进行缓存， Kotlin中使用inner class关键字来定义内部类。当convertView为null的时候，创建一个 ViewHolder对象，并将控件的实例存放在ViewHolder里，然后调用View的setTag()方 法，将ViewHolder对象存储在View中。当convertView不为null的时候，则调用View的 getTag()方法，把ViewHolder重新取出。这样所有控件的实例都缓存在了ViewHolder里， 就没有必要每次都通过findViewById()方法来获取控件实例了。</p>
<h3 id="ListView的点击事件"><a href="#ListView的点击事件" class="headerlink" title="ListView的点击事件"></a>ListView的点击事件</h3><p>话说回来，ListView的滚动毕竟只是满足了我们视觉上的效果，可是如果ListView中的子项不 能点击的话，这个控件就没有什么实际的用途了。因此，本小节我们就来学习一下ListView如 何才能响应用户的点击事件</p>
<p>修改MainActivity中的代码，如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>:<span class="type">AppComPatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> fruitList = ArrayList&lt;Fruit&gt;()</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(savedInstanceState)</span><br><span class="line">        initFruits()</span><br><span class="line">        <span class="keyword">val</span> adapter = FruitAdappter(<span class="keyword">this</span>,R.layout.fruit_item,fruitLis)</span><br><span class="line">        listView.adapter = adapter</span><br><span class="line">        listView.setOnItemClickListener&#123;parent,view,position,id-&gt;</span><br><span class="line">                                       vla fruit = fruitList[positon]</span><br><span class="line">                                       Toast.maktText(<span class="keyword">this</span>,fruit.name,Toast.LENGTH_SHORT).show()&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，我们使用setOnItemClickListener()方法为ListView注册了一个监听器，当用 户点击了ListView中的任何一个子项时，就会回调到Lambda表达式中。这里我们可以通过 position参数判断用户点击的是哪一个子项，然后获取到相应的水果，并通过Toast将水果的 名字显示出来</p>
<p>另外你会发现，虽然这里我们必须在Lambda表达式中声明4个参数，但实际上却只用到了 position这一个参数而已。针对这种情况，Kotlin允许我们将没有用到的参数使用下划线来替 代，因此下面这种写法也是合法且更加推荐的</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">listView.setOnItemClickListener &#123; _, _, position, _ -&gt; </span><br><span class="line">    <span class="keyword">val</span> fruit = fruitList[position] </span><br><span class="line">    Toast.makeText(<span class="keyword">this</span>, fruit.name, Toast.LENGTH_SHORT).show() </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="RecyclerView"><a href="#RecyclerView" class="headerlink" title="RecyclerView"></a>RecyclerView</h2><p>Android提供了一个更强大的滚动控件——RecyclerView。它可以说是一个增强版的 ListView，不仅可以轻松实现和ListView同样的效果，还优化了ListView存在的各种不足之 处。</p>
<h3 id="RecyclerView的基本用法"><a href="#RecyclerView的基本用法" class="headerlink" title="RecyclerView的基本用法"></a>RecyclerView的基本用法</h3><p>打开app&#x2F;build.gradle文件，在dependencies闭包中添加如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dependencies &#123; </span><br><span class="line">    implementation fileTree(dir: &#x27;libs&#x27;, include: [&#x27;*.jar&#x27;]) </span><br><span class="line">    implementation&quot;org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version&quot; </span><br><span class="line">    implementation &#x27;androidx.appcompat:appcompat:1.0.2&#x27; </span><br><span class="line">    implementation &#x27;androidx.core:core-ktx:1.0.2&#x27; </span><br><span class="line">    implementation &#x27;androidx.constraintlayout:constraintlayout:1.1.3&#x27; </span><br><span class="line">    implementation &#x27;androidx.recyclerview:recyclerview:1.0.0&#x27; </span><br><span class="line">    testImplementation &#x27;junit:junit:4.12&#x27; </span><br><span class="line">    androidTestImplementation &#x27;androidx.test:runner:1.1.1&#x27; </span><br><span class="line">    androidTestImplementation &#x27;androidx.test.espresso:espresso-core:3.1.1&#x27; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>接下来修改activity_main.xml中的代码，如下所示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;&gt;</span><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/recyclerView&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>接下来需要为RecyclerView准备一个适配器，新建FruitAdapter类，让这个适配器继承自 RecyclerView.Adapter，并将泛型指定为FruitAdapter.ViewHolder。其中， ViewHolder是我们在FruitAdapter中定义的一个内部类，代码如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FruitAdapter</span>(<span class="keyword">val</span> fruitList:List&lt;Fruit&gt;):</span><br><span class="line">		RecyclerView.Adapter&lt;FruitAdapter.ViewHolder&gt;()&#123;</span><br><span class="line">            <span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">ViewHolder</span>(view:View):RecycleView.ViewHolder(view)&#123;</span><br><span class="line">                <span class="keyword">val</span> fruitImage:ImageIvew = view.findViewById(R.id.fruitImage)</span><br><span class="line">                <span class="keyword">val</span> fruitName:TextView = view.findViewById(R.id.fruirName)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent:<span class="type">ViewGroup</span>,viewType:<span class="type">Int</span>)</span></span>:ViewHolder&#123;</span><br><span class="line">                <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.fruit_item,parent,<span class="literal">false</span>)</span><br><span class="line">                <span class="keyword">return</span> ViewHolder(view)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder:<span class="type">ViewHolder</span>,position:<span class="type">Int</span>)</span></span>&#123;</span><br><span class="line">                <span class="keyword">val</span> fruit = fruitList[position]</span><br><span class="line">                holder.fruitImage.setImageResource(fruit.imageId)</span><br><span class="line">                holder.fruitName.text = fruit.name</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemCount</span><span class="params">()</span></span> = fruitList.size</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>这是RecyclerView适配器标准的写法，虽然看上去好像多了好几个方法，但其实它比ListView 的适配器要更容易理解。这里我们首先定义了一个内部类ViewHolder，它要继承自 RecyclerView.ViewHolder。然后ViewHolder的主构造函数中要传入一个View参数，这 个参数通常就是RecyclerView子项的最外层布局，那么我们就可以通过findViewById()方 法来获取布局中ImageView和TextView的实例了。</p>
<p>FruitAdapter中也有一个主构造函数，它用于把要展示的数据源传进来，我们后续的操作都 将在这个数据源的基础上进行。 继续往下看，由于FruitAdapter是继承自RecyclerView.Adapter的，那么就必须重写 onCreateViewHolder()、onBindViewHolder()和getItemCount()这3个方法。 onCreateViewHolder()方法是用于创建ViewHolder实例的，我们在这个方法中将 fruit_item布局加载进来，然后创建一个ViewHolder实例，并把加载出来的布局传入构造 函数当中，最后将ViewHolder的实例返回。onBindViewHolder()方法用于对 RecyclerView子项的数据进行赋值，会在每个子项被滚动到屏幕内的时候执行，这里我们通过 position参数得到当前项的Fruit实例，然后再将数据设置到ViewHolder的ImageView和 TextView当中即可。getItemCount()方法就非常简单了，它用于告诉RecyclerView一共有 多少子项，直接返回数据源的长度就可以了</p>
<p>适配器准备好了之后，我们就可以开始使用RecyclerView了，修改MainActivity中的代码，如 下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span>:<span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> fruitList = ArrayList&lt;Fruit&gt;()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        initFruits()</span><br><span class="line">        <span class="keyword">val</span> layoutManager = LinerLayoutManager(<span class="keyword">this</span>)</span><br><span class="line">        recycylerView.layoutManager = layoutManager</span><br><span class="line">        <span class="keyword">val</span> adapter = FruitAdapter(fruitList)</span><br><span class="line">        recyclerView.adapter = adapter</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">initFruits</span><span class="params">()</span></span> &#123; </span><br><span class="line">        repeat(<span class="number">2</span>) &#123; </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Apple&quot;</span>, R.drawable.apple_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Banana&quot;</span>, R.drawable.banana_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Orange&quot;</span>, R.drawable.orange_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Watermelon&quot;</span>, R.drawable.watermelon_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Pear&quot;</span>, R.drawable.pear_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Grape&quot;</span>, R.drawable.grape_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Pineapple&quot;</span>, R.drawable.pineapple_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Strawberry&quot;</span>, R.drawable.strawberry_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Cherry&quot;</span>, R.drawable.cherry_pic)) </span><br><span class="line">            fruitList.add(Fruit(<span class="string">&quot;Mango&quot;</span>, R.drawable.mango_pic)) </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，这里使用了一个同样的initFruits()方法，用于初始化所有的水果数据。接着在 onCreate()方法中先创建了一个LinearLayoutManager对象，并将它设置到 RecyclerView当中。LayoutManager用于指定RecyclerView的布局方式，这里使用的 LinearLayoutManager是线性布局的意思，可以实现和ListView类似的效果。接下来我们创 建了FruitAdapter的实例，并将水果数据传入FruitAdapter的构造函数中，最后调用 RecyclerView的setAdapter()方法来完成适配器设置，这样RecyclerView和数据之间的关 联就建立完成了。</p>
<h3 id="实现横向滚动和瀑布流布局"><a href="#实现横向滚动和瀑布流布局" class="headerlink" title="实现横向滚动和瀑布流布局"></a>实现横向滚动和瀑布流布局</h3><p>首先要对fruit_item布局进行修改，因为目前这个布局里面的元素是水平排列的，适用于纵 向滚动的场景，而如果我们要实现横向滚动的话，应该把fruit_item里的元素改成垂直排列 才比较合理。修改fruit_item.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;80dp&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitImage&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;40dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_horizontal&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitName&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_horizontal&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span> /&gt;</span> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>可以看到，我们将LinearLayout改成垂直方向排列，并把宽度设为80 dp。这里将宽度指定为 固定值是因为每种水果的文字长度不一致，如果用wrap_content的话，RecyclerView的子项 就会有长有短，非常不美观，而如果用match_parent的话，就会导致宽度过长，一个子项占 满整个屏幕</p>
<p>然后我们将ImageView和TextView都设置成了在布局中水平居中，并且使用 layout_marginTop属性让文字和图片之间保持一定距离</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> fruitList = ArrayList&lt;Fruit&gt;()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        initFruits()</span><br><span class="line">        <span class="keyword">val</span> layoutManager = LinerLayoutMananger(<span class="keyword">this</span>)</span><br><span class="line">        layoutManager.orientation = LinerLayoutManager.HORIZONTAL</span><br><span class="line">        recyclerView.layoutManager = layoutManager</span><br><span class="line">        <span class="keyword">val</span> adapter = FruitAdapter(fruitList)</span><br><span class="line">        recyclerView.adapter = adapter</span><br><span class="line">        ...</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MainActivity中只加入了一行代码，调用LinearLayoutManager的setOrientation()方法 设置布局的排列方向。默认是纵向排列的，我们传入LinearLayoutManager.HORIZONTAL 表示让布局横行排列，这样RecyclerView就可以横向滚动了。</p>
<p>你可以用手指在水平方向上滑动来查看屏幕外的数据。 为什么ListView很难或者根本无法实现的效果在RecyclerView上这么轻松就实现了呢？这主要 得益于RecyclerView出色的设计。ListView的布局排列是由自身去管理的，而RecyclerView则将这个工作交给了LayoutManager。LayoutManager制定了一套可扩展的布局排列接口， 子类只要按照接口的规范来实现，就能定制出各种不同排列方式的布局了</p>
<p>除了LinearLayoutManager之外，RecyclerView还给我们提供了GridLayoutManager和 StaggeredGridLayoutManager这两种内置的布局排列方式。GridLayoutManager可以用于 实现网格布局，StaggeredGridLayoutManager可以用于实现瀑布流布局。这里我们来实现 一下效果更加炫酷的瀑布流布局，网格布局就作为课后习题，交给你自己来研究了。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_margin</span>=<span class="string">&quot;5dp&quot;</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">ImageView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitImage&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;40dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;40dp&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center_horizontal&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span> /&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/fruitName&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_gravity</span>=<span class="string">&quot;left&quot;</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">&quot;10dp&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<p>这里做了几处小的调整，首先将LinearLayout的宽度由80 dp改成了match_parent，因为瀑 布流布局的宽度应该是根据布局的列数来自动适配的，而不是一个固定值。其次我们使用了 layout_margin属性来让子项之间互留一点间距，这样就不至于所有子项都紧贴在一些。最后 还将TextView的对齐属性改成了居左对齐，因为待会我们会将文字的长度变长，如果还是居中 显示就会感觉怪怪的。</p>
<p>接着修改MainActivity中的代码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>()&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> fruitList = ArrayList&lt;Fruit&gt;()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line">        initFruits()</span><br><span class="line">        <span class="keyword">val</span> layoutMaanager = StaggeredGridLayoutManager(<span class="number">3</span>,StaggeredGridLayoutManagre.VERTICAL)</span><br><span class="line">        recyclerView.layoutManager = layoutManager</span><br><span class="line">        <span class="keyword">val</span> adapter  FruitAdatpe(fruitList)</span><br><span class="line">        recyclerView.adapter = adapter</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">initFruits</span><span class="params">()</span></span>&#123;</span><br><span class="line">                repeat(<span class="number">2</span>) &#123; </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Apple&quot;</span>), </span><br><span class="line">                R.drawable.apple_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Banana&quot;</span>), </span><br><span class="line">                R.drawable.banana_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Orange&quot;</span>), </span><br><span class="line">                R.drawable.orange_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Watermelon&quot;</span>), </span><br><span class="line">                R.drawable.watermelon_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Pear&quot;</span>), </span><br><span class="line">                R.drawable.pear_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Grape&quot;</span>), </span><br><span class="line">                R.drawable.grape_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Pineapple&quot;</span>), </span><br><span class="line">                R.drawable.pineapple_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Strawberry&quot;</span>), </span><br><span class="line">                R.drawable.strawberry_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Cherry&quot;</span>), </span><br><span class="line">                R.drawable.cherry_pic)) </span><br><span class="line">            fruitList.add(Fruit(getRandomLengthString(<span class="string">&quot;Mango&quot;</span>), </span><br><span class="line">                R.drawable.mango_pic)) </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">getRandomLengthString</span><span class="params">(str:<span class="type">String</span>)</span></span>:String&#123;</span><br><span class="line">        <span class="keyword">val</span> n = (<span class="number">1.</span>.<span class="number">.20</span>).random()</span><br><span class="line">        <span class="keyword">val</span> builder = StringBuilder()</span><br><span class="line">        repeat(n)&#123;</span><br><span class="line">            builder.append(str)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> builder.toString</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先，在onCreate()方法中，我们创建了一个StaggeredGridLayoutManager的实例。 StaggeredGridLayoutManager的构造函数接收两个参数：第一个参数用于指定布局的列 数，传入3表示会把布局分为3列；第二个参数用于指定布局的排列方向，传入 StaggeredGridLayoutManager.VERTICAL表示会让布局纵向排列。最后把创建好的实例 设置到RecyclerView当中就可以了，就是这么简单</p>
<p>没错，仅仅修改了一行代码，我们就已经成功实现瀑布流布局的效果了。不过由于瀑布流布局 需要各个子项的高度不一致才能看出明显的效果，为此我又使用了一个小技巧。这里我们把眼 光聚焦到getRandomLengthString()这个方法上，这个方法中调用了Range对象的 random()函数来创造一个1到20之间的随机数，然后将参数中传入的字符串随机重复几遍。在 initFruits()方法中，每个水果的名字都改成调用getRandomLengthString()这个方法 来生成，这样就能保证各水果名字的长短差距比较大，子项的高度也就各不相同了。</p>
<h3 id="RecycleView的点击事件"><a href="#RecycleView的点击事件" class="headerlink" title="RecycleView的点击事件"></a>RecycleView的点击事件</h3><p>和ListView一样，RecyclerView也必须能响应点击事件才可以，不然的话就没什么实际用途 了。不过不同于ListView的是，RecyclerView并没有提供类似于 setOnItemClickListener()这样的注册监听器方法，而是需要我们自己给子项具体的View 去注册点击事件。这相比于ListView来说，实现起来要复杂一些</p>
<p>那么你可能就有疑问了，为什么RecyclerView在各方面的设计都要优于ListView，偏偏在点击 事件上却没有处理得非常好呢？其实不是这样的，ListView在点击事件上的处理并不人性化， setOnItemClickListener()方法注册的是子项的点击事件，但如果我想点击的是子项里具 体的某一个按钮呢？虽然ListView也能做到，但是实现起来就相对比较麻烦了。为此， RecyclerView干脆直接摒弃了子项点击事件的监听器，让所有的点击事件都由具体的View去 注册，就再没有这个困扰了。</p>
<p>下面我们来具体学习一下如何在RecyclerView中注册点击事件，修改FruitAdapter中的代 码，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FruitAdapter</span>(<span class="keyword">val</span> fruitList:List&lt;Fruit&gt;):</span><br><span class="line">	RecyclerView.Adapter&lt;FruitAdapter.ViewHolder&gt;()&#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent:<span class="type">ViewGroup</span>,viewType:<span class="type">Int</span>)</span></span>:ViewHolder&#123;</span><br><span class="line">            <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.fruit_item,<span class="literal">false</span>)</span><br><span class="line">            <span class="keyword">val</span> viewHolder = ViewHolder(view)</span><br><span class="line">            viewHolder.itemView.setOnClickListener&#123;</span><br><span class="line">                <span class="keyword">val</span> position = viewHolder.adapterPosition</span><br><span class="line">                <span class="keyword">val</span> fruit = fruitList[positon]</span><br><span class="line">                Toast.makeText(parent.context,<span class="string">&quot;you clicked view <span class="subst">$&#123;fruit.name&#125;</span>&quot;</span>,Toast.LENGTH_SHORT).show()</span><br><span class="line">            &#125;</span><br><span class="line">            viewHolder.fruitImage.setOnClickListener&#123;</span><br><span class="line">                <span class="keyword">val</span> positon = viewHolder.adapterPositon</span><br><span class="line">                <span class="keyword">val</span> fruit = fruitList[position]</span><br><span class="line">                Toast.makeText(parent.context,<span class="string">&quot;you clicked image <span class="subst">$&#123;fruit.name&#125;</span>&quot;</span>),Toast.LENGTH_SHORT).show()</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> viewHolder</span><br><span class="line">        &#125;</span><br><span class="line">     </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="ViewBinding的使用"><a href="#ViewBinding的使用" class="headerlink" title="ViewBinding的使用"></a>ViewBinding的使用</h2><h3 id="项目集成"><a href="#项目集成" class="headerlink" title="项目集成"></a>项目集成</h3><p>需要使用ViewBinding的功能，需要在对应的module的build.gradle文件中启用ViewBinding支持。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">        ...</span><br><span class="line">        viewBinding &#123;</span><br><span class="line">            enabled = true</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果您希望在生成绑定类时忽略某个布局文件，请将<code>tools:viewBindingIgnore=&quot;true&quot;</code>属性添加到相应布局文件的根视图中：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">...</span></span></span><br><span class="line"><span class="tag">            <span class="attr">tools:viewBindingIgnore</span>=<span class="string">&quot;true&quot;</span> &gt;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="在Activity中使用"><a href="#在Activity中使用" class="headerlink" title="在Activity中使用"></a>在Activity中使用</h3><p>如需设置绑定类的实例以供 Activity 使用，请在 Activity 的onCreate()方法中执行以下步骤：</p>
<ol>
<li>调用生成的绑定类中包含的静态inflate()方法。此操作会创建该绑定类的实例以供 Activity 使用。</li>
<li>通过调用 getRoot()方法或使用kotlin语法获取对根视图的引用。</li>
<li>将根视图传递到setContentView，使其成为屏幕上的活动视图</li>
</ol>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> ActivityMainBinding binding;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        binding = ActivityMainBinding .inflate(getLayoutInflater());</span><br><span class="line">        View view = binding.getRoot();</span><br><span class="line">        setContentView(view);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>配置后使用方式如下：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">binding.btnTest.setText(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">binding.button.setOnClickListener(new View.OnClickListener() &#123;</span><br><span class="line">    <span class="comment">// todo</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="在Adapter中使用ViewBinding"><a href="#在Adapter中使用ViewBinding" class="headerlink" title="在Adapter中使用ViewBinding"></a>在Adapter中使用ViewBinding</h3><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainAdapter</span> <span class="title">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="type">MainAdapter.ViewHolder</span>&gt; &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; mList;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> MainAdapter(List&lt;String&gt; list) &#123;</span><br><span class="line">        mList = list;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> MainAdapter.ViewHolder onCreateViewHolder(<span class="meta">@NonNull</span> ViewGroup parent, int viewType) &#123;</span><br><span class="line">        <span class="comment">//之前的写法</span></span><br><span class="line">        <span class="comment">//View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.layout_comment, parent, false);</span></span><br><span class="line">        <span class="comment">//ViewHolder holder = new ViewHolder(view);</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">//使用ViewBinding的写法</span></span><br><span class="line">        LayoutCommentBinding commentBinding = LayoutCommentBinding.inflate(LayoutInflater.from(parent.getContext()), parent, <span class="literal">false</span>);</span><br><span class="line">        ViewHolder holder = new ViewHolder(commentBinding);</span><br><span class="line">        <span class="keyword">return</span> holder;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> void onBindViewHolder(<span class="meta">@NonNull</span> MainAdapter.ViewHolder holder, int position) &#123;</span><br><span class="line">        holder.mTextView.setText(mList.<span class="keyword">get</span>(position));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> int getItemCount() &#123;</span><br><span class="line">        <span class="keyword">return</span> mList.size();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    static <span class="keyword">class</span> <span class="title class_">ViewHolder</span> <span class="title">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> &#123;</span><br><span class="line"> </span><br><span class="line">        TextView mTextView;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//之前的写法</span></span><br><span class="line">        <span class="comment">//public ViewHolder(@NonNull View itemView) &#123;</span></span><br><span class="line">        <span class="comment">//    super(itemView);</span></span><br><span class="line">        <span class="comment">//    mTextView = itemView.findViewById(R.id.tv_include);</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment">//使用ViewBinding的写法</span></span><br><span class="line">        ViewHolder(<span class="meta">@NonNull</span> LayoutCommentBinding commentBinding) &#123;</span><br><span class="line">            <span class="keyword">super</span>(commentBinding.getRoot());</span><br><span class="line">            mTextView = commentBinding.tvInclude;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ViewPage2"><a href="#ViewPage2" class="headerlink" title="ViewPage2"></a>ViewPage2</h2><h3 id="MainActivyty-java"><a href="#MainActivyty-java" class="headerlink" title="MainActivyty.java"></a>MainActivyty.java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span> </span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(BUndle savedInstanceState)</span>&#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState)</span><br><span class="line">            setContentVeiw(R.layout.activity_main);</span><br><span class="line">        <span class="type">ViewPager2</span> <span class="variable">viewPager</span> <span class="operator">=</span> findViewById(R.id.viewPager);</span><br><span class="line">        <span class="type">viewPagerAdapter</span> <span class="variable">viewPagerAdpater</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ViewPagerAdapter</span>();</span><br><span class="line">        viewPager.setAdapter(viewPagerAdapter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ViewPagerAdapter-java"><a href="#ViewPagerAdapter-java" class="headerlink" title="ViewPagerAdapter.java"></a>ViewPagerAdapter.java</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ViewPagerAdapter</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.Adapter&lt;ViewPagerAdapter.ViewPagerViewHolder&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; titles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(); </span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; colors = <span class="keyword">new</span> <span class="title class_">ArrayLIst</span>&lt;&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ViewPagerAdapter</span><span class="params">()</span>&#123;</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        titles.add(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        colors.add(R.color.white);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> RecyclerView.ViewHolder <span class="title function_">onCreateViewHolder</span><span class="params">(<span class="meta">@NonNull</span> ViewGroup parent,<span class="type">int</span> viewType)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ViewPagerViewHolder</span>(LayoutInlater.from(parent.getContext()).inflate(R.ayout.item_pager,parent,<span class="literal">false</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onBindViewHolder</span><span class="params">(<span class="meta">@NonNull</span> ViewPagerViewHolder holder,<span class="type">int</span> position)</span>&#123;</span><br><span class="line">        holder.mYv.setText(titles.get(position));</span><br><span class="line">        holder.mContainer.setBakcgroundResource(colors.get(position));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getItemCount</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">ViewPagerViewHolder</span> <span class="keyword">extends</span> <span class="title class_">RecyclerView</span>.ViewHolder&#123;</span><br><span class="line">            TextVeiw mTv;</span><br><span class="line">            RelativeLayout mContainer;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">viewPagerViewHolder</span><span class="params">(<span class="meta">@NonNull</span> View itemView)</span>&#123;</span><br><span class="line">            <span class="built_in">super</span>(itemView);</span><br><span class="line">            mContainer = itemView.findViewById(R.id.container);</span><br><span class="line">            mTv = itemView.findViewById(R.id.tvTitle);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="item-pager-xml"><a href="#item-pager-xml" class="headerlink" title="item_pager.xml"></a>item_pager.xml</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">RealtiveLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;https//schemas.android.com/apk/res&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span> = <span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span> = <span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span> = <span class="string">&quot;@+id/container&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span> = <span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span> = <span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:id</span> = <span class="string">&quot;+id/tvTitle&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_centerInParent</span> = <span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:textColor</span> = <span class="string">&quot;#ff4532&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:textSize</span> = <span class="string">&quot;32dp&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:text</span> = <span class="string">&quot;hello&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">RelativeLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="colors-xml"><a href="#colors-xml" class="headerlink" title="colors.xml"></a>colors.xml</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;red&quot;</span>&gt;</span>#ff4411<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;black&quot;</span>&gt;</span>000000<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">color</span> <span class="attr">name</span>=<span class="string">&quot;white&quot;</span>&gt;</span>#ffffff<span class="tag">&lt;/<span class="name">color</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="编写界面的最佳实践"><a href="#编写界面的最佳实践" class="headerlink" title="编写界面的最佳实践"></a>编写界面的最佳实践</h2><h3 id="制作9-Patch图片"><a href="#制作9-Patch图片" class="headerlink" title="制作9-Patch图片"></a>制作9-Patch图片</h3><p>那么9-Patch图片到底有什么实际作用呢？我们还是通过一个例子来看一下吧。首先在 UIBestPractice项目中放置一张气泡样式的图片message_left.png</p>
<p>我们将这张图片设置为LinearLayout的背景图片，修改activity_main.xml中的代码，如下所 示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:layout_height</span>=<span class="string">&quot;50dp&quot;</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">android:background</span>=<span class="string">&quot;@drawable/message_left&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到，由于message_left的宽度不足以填满整个屏幕的宽度，整张图片被均匀地拉伸 了！这种效果非常差，用户肯定是不能容忍的，这时就可以使用9-Patch图片来进行改善。 制作9-Patch图片其实并不复杂，只要掌握好规则就行了，那么现在我们就来学习一下。 在Android Studio中，我们可以将任何png类型的图片制作成9-Patch图片。首先对着 message_left.png图片右击→Create 9-Patch ﬁle</p>
<p>我们可以在图片的4个边框绘制一个个的小黑点，在上边框和左边框绘制的部分表示当图片需要 拉伸时就拉伸黑点标记的区域，在下边框和右边框绘制的部分表示内容允许被放置的区域。使 用鼠标在图片的边缘拖动就可以进行绘制了，按住Shift键拖动可以进行擦除。绘制完成后效果 如图4.43所示。</p>
<p>最后记得要将原来的message_left.png图片删除，只保留制作好的message_left.9.png图片 即可，因为Android项目中不允许同一文件夹下有两张相同名称的图片（即使后缀名不同也不行）。重新运行程序，效果如图4.44所示。</p>
<h3 id="编写精美的聊天界面"><a href="#编写精美的聊天界面" class="headerlink" title="编写精美的聊天界面"></a>编写精美的聊天界面</h3><p>开始编写主界面，修改activity_main.xml中的代码，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android:</span>&quot;<span class="attr">http:schemas.android.com</span>/<span class="attr">apk</span>/<span class="attr">res</span>/<span class="attr">android</span>&quot;</span></span><br><span class="line"><span class="tag">              <span class="attr">android:orientation</span>=<span class="string">&quot;vertical&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">background</span>=<span class="string">&quot;#d8e0e8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">androidx.recyclerview.widget.RecyclerView</span></span></span><br><span class="line"><span class="tag">                                               <span class="attr">android:id</span>=<span class="string">&quot;@id/recyclerView&quot;</span></span></span><br><span class="line"><span class="tag">                                               <span class="attr">aandroid:id</span>=<span class="string">layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                                               <span class="attr">android:layout_height</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                                               <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinderLayout</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:id</span>=<span class="string">&quot;@+id/inputText&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_width</span>=<span class="string">&quot;0dp&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_weight</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:hint</span>=<span class="string">&quot;Type something here&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:maxLines</span>=<span class="string">&quot;2&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">&quot;@id/send&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:text</span>=<span class="string">&quot;Send&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinderLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们在主界面中放置了一个RecyclerView用于显示聊天的消息内容，又放置了一个EditText用 于输入消息，还放置了一个Button用于发送消息。这里用到的所有属性都是我们之前学过的， 相信你理解起来应该不费力。</p>
<p>然后定义消息的实体类，新建Msg，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Msg</span>(<span class="keyword">val</span> content:String,<span class="keyword">val</span> type:<span class="built_in">Int</span>)&#123;</span><br><span class="line">    <span class="keyword">companion</span> <span class="keyword">object</span>&#123;</span><br><span class="line">       <span class="keyword">const</span> <span class="keyword">val</span> TYPE_RECEIVED = <span class="number">0</span></span><br><span class="line">       <span class="keyword">const</span> <span class="keyword">val</span> TYPE_SENT = <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Msg类中只有两个字段：content表示消息的内容，type表示消息的类型。其中消息类型有两 个值可选：TYPE_RECEIVED表示这是一条收到的消息，TYPE_SENT表示这是一条发出的消息。这里我们将TYPE_RECEIVED和TYPE_SENT定义成了常量，定义常量的关键字是const， 注意只有在单例类、companion object或顶层方法中才可以使用const关键字。</p>
<p>接下来开始编写RecyclerView的子项布局，新建msg_left_item.xml，代码如下所示：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:</span>&quot;<span class="attr">http:</span>//<span class="attr">schemas.android.com</span>/<span class="attr">apk</span>/<span class="attr">res</span>/<span class="attr">android</span>&quot;</span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:pddding</span>=<span class="string">&quot;10dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_grativity</span>=<span class="string">&quot;left&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:background</span>=<span class="string">&quot;drawable/message_left&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:id</span>=<span class="string">&quot;@id/leftMsg&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_gravity</span>=<span class="string">&quot;center&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_margin</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:textColor</span>=<span class="string">&quot;#fff&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这是接收消息的子项布局。这里我们让收到的消息居左对齐，并使用message_left.9.png作为 背景图。</p>
<p>类似地，我们还需要再编写一个发送消息的子项布局，新建msg_right_item.xml，代码如下所 示</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FrameLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">android:padding</span>=<span class="string">&quot;10dp&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinerLayout</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:layout_gravity</span>=<span class="string">&quot;right&quot;</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">android:background</span>=<span class="string">&quot;@drawable/message_right&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:id</span>=<span class="string">&quot;@id/rightMsg&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:layout_margin</span>=<span class="string">&quot;10dp&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">android:textColor</span>=<span class="string">&quot;#000&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinerLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FrameLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们让发出的消息居右对齐，并使用message_right.9.png作为背景图，基本上和刚才的 msg_left_item.xml是差不多的</p>
<p>接下来需要创建RecyclerView的适配器类，新建类MsgAdapter，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MsgAdapter</span>(<span class="keyword">val</span> msgList:List&lt;Msg&gt;):RecyclerView.Adapter&lt;RecyclerView.ViewHolder&gt;()&#123;</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">LeftViewHolder</span>(view:View):RecyclerView.ViewHolder(view)&#123;</span><br><span class="line">        <span class="keyword">val</span> leftMsg: TextView = view.findViewById(R.id.leftMsg)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">class</span> <span class="title class_">RightViewHolder</span>(view:View):RecyclerView.ViewHOlder(view)&#123;</span><br><span class="line">        <span class="keyword">val</span> rightMsg: TextView = view.findViewById(R.id.rightMsg)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">getItemViewType</span><span class="params">(position:<span class="type">Int</span>)</span></span>:<span class="built_in">Int</span>&#123;</span><br><span class="line">        <span class="keyword">val</span> msg = msgList[position]</span><br><span class="line">        <span class="keyword">return</span> msg.Type</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreateViewHolder</span><span class="params">(parent:<span class="type">ViewGroup</span>,viewType:<span class="type">Int</span>)</span></span> = <span class="keyword">if</span>(viewType==Msg.TYPE_RECEIVED)&#123;</span><br><span class="line">        <span class="keyword">val</span> view = LayoutInflater.fron(parent.context).inflate(R.layout.msg_left_item,parent,<span class="literal">false</span>)</span><br><span class="line">        LeftViewHolder(view)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">val</span> view = LayoutInflater.from(parent.context).inflate(R.layout.msg_right_item,parent,<span class="literal">false</span>)</span><br><span class="line">        RightViewHolder(view)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onBindViewHolder</span><span class="params">(holder:<span class="type">RecyclerVIew</span>.<span class="type">ViewHolder</span>,position:<span class="type">Int</span>)</span></span>&#123;</span><br><span class="line">        <span class="keyword">val</span> msg = msgList[position]</span><br><span class="line">        <span class="keyword">when</span>(holder)&#123;</span><br><span class="line">            <span class="keyword">is</span> LeftViewHolder-&gt;holder.leftMsg.text = msg.content</span><br><span class="line">            <span class="keyword">is</span> RightViewHolder-&gt;holder.rightMst.text = msg.content</span><br><span class="line">            <span class="keyword">else</span> -&gt; <span class="keyword">throw</span> IlleaglArgumentException()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述代码中用到了一个新的知识点：根据不同的viewType创建不同的界面。首先我们定义了 LeftViewHolder和RightViewHolder这两个ViewHolder，分别用于缓存 msg_left_item.xml和msg_right_item.xml布局中的控件。然后要重写 getItemViewType()方法，并在这个方法中返回当前position对应的消息类型。</p>
<p>接下来的代码你应该就比较熟悉了，和我们之前学习的RecyclerView用法是比较相似的，只是 要在onCreateViewHolder()方法中根据不同的viewType来加载不同的布局并创建不同的 ViewHolder。然后在onBindViewHolder()方法中判断ViewHolder的类型：如果是 LeftViewHolder，就将内容显示到左边的消息布局；如果是RightViewHolder，就将内容 显示到右边的消息布局。</p>
<p>最后修改MainActivity中的代码，为RecyclerView初始化一些数据，并给发送按钮加入事件响 应，代码如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">AppCompatActivity</span>(),View.OnClickListener&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> msgList = ArrayLIst&lt;Msg&gt;()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> adapter:MsgAdapter? = <span class="literal">null</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState:<span class="type">Bundle</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentVeiw(R.layout.activity_main)</span><br><span class="line">        initMsg()</span><br><span class="line">        <span class="keyword">val</span> layoutManager = LinearLayoutManager(<span class="keyword">this</span>)</span><br><span class="line">        recyclerView.layoutManager = layoutManager</span><br><span class="line">        adapter = MsgAdapter(magList)</span><br><span class="line">        recyclerView.adapter = adapter</span><br><span class="line">        send.setOnClickListner(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v:<span class="type">View</span>?)</span></span>&#123;</span><br><span class="line">        <span class="keyword">when</span>(v)&#123;</span><br><span class="line">            send-&gt;&#123;</span><br><span class="line">                <span class="keyword">val</span> content = inputText.text.toString()</span><br><span class="line">                <span class="keyword">if</span>(content.isNotEmpty())&#123;</span><br><span class="line">                    <span class="keyword">val</span> msg = Msg(content,Msg.TYPE_SENT)</span><br><span class="line">                    magList.add(msg)</span><br><span class="line">                    adapter?.notifyItemInserted(msgLsig.size-<span class="number">1</span>)</span><br><span class="line">                    recyclerView.scrollToPosition(msgLisg.size-<span class="number">1</span>)</span><br><span class="line">                    inputText.setText(<span class="string">&quot;&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">initMst</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">val</span> masl = Msg(<span class="string">&quot;Hello guy.&quot;</span>,Msg.TYPE_RECEIVED)</span><br><span class="line">        msgLisg.add(msg1)</span><br><span class="line">        <span class="keyword">val</span> msg2 = Msg(<span class="string">&quot;Hello. Who is that?&quot;</span>,Msg.TYPE_SENT)</span><br><span class="line">        msgList.add(msg2)</span><br><span class="line">        <span class="keyword">val</span> msg3 = Msg(<span class="string">&quot;This is Tom.Nice talking to you&quot;</span>,Msg.TYPE_RECEIVED)</span><br><span class="line">        msgList.add(msg3)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Kotlin课堂-延迟初始化和密封类"><a href="#Kotlin课堂-延迟初始化和密封类" class="headerlink" title="Kotlin课堂:延迟初始化和密封类"></a>Kotlin课堂:延迟初始化和密封类</h2><h3 id="对变量延迟初始化"><a href="#对变量延迟初始化" class="headerlink" title="对变量延迟初始化"></a>对变量延迟初始化</h3><p>延迟初始化使用的是lateinit关键字，它可以告诉Kotlin编译器，我会在晚些时候对这个变量 进行初始化，这样就不用在一开始的时候将它赋值为null了。</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">lateinit</span> <span class="keyword">var</span> adapter:MsgAdapter</span><br></pre></td></tr></table></figure>

<p>当然，使用lateinit关键字也不是没有任何风险，如果我们在adapter变量还没有初始化的 情况下就直接使用它，那么程序就一定会崩溃，并且抛出一个 UninitializedPropertyAccessException异常</p>
<p>另外，我们还可以通过代码来判断一个全局变量是否已经完成了初始化，这样在某些时候能够 有效地避免重复对某一个变量进行初始化操作，示例代码如下</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(::adapter.isInitialized)&#123;</span><br><span class="line">    adapter = MsgAdpater(msgList)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>具体语法就是这样，::adapter.isInitialized可用于判断adapter变量是否已经初始 化。虽然语法看上去有点奇怪，但这是固定的写法。然后我们再对结果进行取反，如果还没有 初始化，那么就立即对adapter变量进行初始化，否则什么都不用做。</p>
<h3 id="使用密封类优化代码"><a href="#使用密封类优化代码" class="headerlink" title="使用密封类优化代码"></a>使用密封类优化代码</h3><p>首先来了解一下密封类具体的作用，这里我们来看一个简单的例子。新建一个Kotlin文件，文件 名就叫Result.kt好了，然后在这个文件中编写如下代码：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Result</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Success</span>(<span class="keyword">val</span> msg:String):Result</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Failure</span>(<span class="keyword">val</span> error:Exception):Result</span><br></pre></td></tr></table></figure>

<p>这里定义了一个Result接口，用于表示某个操作的执行结果，接口中不用编写任何内容。然后 定义了两个类去实现Result接口：一个Success类用于表示成功时的结果，一个Failure类 用于表示失败时的结果，这样就把准备工作做好了。</p>
<p>接下来再定义一个getResultMsg()方法，用于获取最终执行结果的信息，代码如下所示</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getResultMsg</span><span class="params">(result:<span class="type">Result</span>)</span></span> = <span class="keyword">when</span>(result)&#123;</span><br><span class="line">    <span class="keyword">is</span> Success -&gt; result.msg</span><br><span class="line">    <span class="keyword">is</span> Failure -&gt; result.error.message</span><br><span class="line">    <span class="keyword">else</span> -&gt; <span class="keyword">throw</span> IllegalArgumentException()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>etResultMsg()方法中接收一个Result参数。我们通过when语句来判断：如果Result属 于Success，那么就返回成功的消息；如果Result属于Failure，那么就返回错误信息。到 目前为止，代码都是没有问题的，但比较让人讨厌的是，接下来我们不得不再编写一个else条 件，否则Kotlin编译器会认为这里缺少条件分支，代码将无法编译通过。但实际上Result的执 行结果只可能是Success或者Failure，这个else条件是永远走不到的，所以我们在这里直接 抛出了一个异常，只是为了满足Kotlin编译器的语法检查而已。</p>
<p>另外，编写else条件还有一个潜在的风险。如果我们现在新增了一个Unknown类并实现 Result接口，用于表示未知的执行结果，但是忘记在getResultMsg()方法中添加相应的条 件分支，编译器在这种情况下是不会提醒我们的，而是会在运行的时候进入else条件里面，从 而抛出异常并导致程序崩溃。</p>
<p>密封类的关键字是sealed class，它的用法同样非常简单，我们可以轻松地将Result接口改 造成密封类的写法：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title class_">Result</span> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Success</span>(<span class="keyword">val</span> msg:String):Result()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Failure</span>(<span class="keyword">val</span> reror:Exception):Result()</span><br></pre></td></tr></table></figure>

<p>可以看到，代码并没有什么太大的变化，只是将interface关键字改成了sealed class。另 外，由于密封类是一个可继承的类，因此在继承它的时候需要在后面加上一对括号，这一点我 们在第2章就学习过了。</p>
<p>那么改成密封类之后有什么好处呢？你会发现现在getResultMsg()方法中的else条件已经不 再需要了，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">getResultMsg</span><span class="params">(result: <span class="type">Result</span>)</span></span> = <span class="keyword">when</span> (result) &#123; </span><br><span class="line"> <span class="keyword">is</span> Success -&gt; result.msg </span><br><span class="line"> <span class="keyword">is</span> Failure -&gt; <span class="string">&quot;Error is <span class="subst">$&#123;result.error.message&#125;</span>&quot;</span> </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>为什么这里去掉了else条件仍然能编译通过呢？这是因为当在when语句中传入一个密封类变量 作为条件时，Kotlin编译器会自动检查该密封类有哪些子类，并强制要求你将每一个子类所对应 的条件全部处理。这样就可以保证，即使没有编写else条件，也不可能会出现漏写条件分支的 情况。而如果我们现在新增一个Unknown类，并也让它继承自Result，此时 getResultMsg()方法就一定会报错，必须增加一个Unknown的条件分支才能让代码编译通 过。</p>
<p>了解了这么多关于密封类的知识，接下来我们看一下它该如何结合MsgAdapter中的 ViewHolder一起使用，并顺便优化一下MsgAdapter中的代码。</p>
<p>观看MsgAdapter现在的代码，你会发现onBindViewHolder()方法中就存在一个没有实际作 用的else条件，只是抛出了一个异常而已。对于这部分代码，我们就可以借助密封类的特性来 进行优化。首先删除MsgAdapter中的LeftViewHolder和RightViewHolder，然后新建一个 MsgViewHolder.kt文件，在其中加入如下代码：</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title class_">MsgViewHolder</span>(view: View) : RecyclerView.ViewHolder(view) </span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LeftViewHolder</span>(view: View) : MsgViewHolder(view) &#123; </span><br><span class="line"> <span class="keyword">val</span> leftMsg: TextView = view.findViewById(R.id.leftMsg) </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RightViewHolder</span>(view: View) : MsgViewHolder(view) &#123; </span><br><span class="line"> <span class="keyword">val</span> rightMsg: TextView = view.findViewById(R.id.rightMsg) </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">lele</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/12/08/UI%E5%BC%80%E5%8F%91%E7%9A%84%E7%82%B9%E7%82%B9%E6%BB%B4%E6%BB%B4/">http://example.com/2024/12/08/UI%E5%BC%80%E5%8F%91%E7%9A%84%E7%82%B9%E7%82%B9%E6%BB%B4%E6%BB%B4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Hexo</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/12/22/%E6%8E%A2%E7%A9%B6Fragment/" title="探究Fragment"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">探究Fragment</div></div></a></div><div class="next-post pull-right"><a href="/2024/12/06/Activity/" title="Activity"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Activity</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#UI%E5%BC%80%E5%8F%91"><span class="toc-text">UI开发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%8E%A7%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">常用控件的使用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TextView"><span class="toc-text">TextView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Button"><span class="toc-text">Button</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EditText"><span class="toc-text">EditText</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ImageView"><span class="toc-text">ImageView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProgressBar"><span class="toc-text">ProgressBar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AlertDialog"><span class="toc-text">AlertDialog</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%A6%E8%A7%A33%E7%A7%8D%E5%9F%BA%E6%9C%AC%E5%B8%83%E5%B1%80"><span class="toc-text">详解3种基本布局</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LinearLayot"><span class="toc-text">LinearLayot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RelativeLayout"><span class="toc-text">RelativeLayout</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FrameLayout"><span class="toc-text">FrameLayout</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%8E%A7%E4%BB%B6%E4%B8%8D%E5%A4%9F%E7%94%A8%EF%BC%9F%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6"><span class="toc-text">系统控件不够用？创建自定义控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E5%B8%83%E5%B1%80"><span class="toc-text">引入布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8E%A7%E4%BB%B6"><span class="toc-text">创建自定义控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ListView"><span class="toc-text">ListView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ListView%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-text">ListView的简单使用方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E5%88%B6ListView-%E7%9A%84%E7%95%8C%E9%9D%A2"><span class="toc-text">定制ListView 的界面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E5%8D%87ListView-%E7%9A%84%E8%BF%90%E8%A1%8C%E6%95%88%E7%8E%87"><span class="toc-text">提升ListView 的运行效率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ListView%E7%9A%84%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="toc-text">ListView的点击事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RecyclerView"><span class="toc-text">RecyclerView</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RecyclerView%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="toc-text">RecyclerView的基本用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%A8%AA%E5%90%91%E6%BB%9A%E5%8A%A8%E5%92%8C%E7%80%91%E5%B8%83%E6%B5%81%E5%B8%83%E5%B1%80"><span class="toc-text">实现横向滚动和瀑布流布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RecycleView%E7%9A%84%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="toc-text">RecycleView的点击事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ViewBinding%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">ViewBinding的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%9B%86%E6%88%90"><span class="toc-text">项目集成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8Activity%E4%B8%AD%E4%BD%BF%E7%94%A8"><span class="toc-text">在Activity中使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8Adapter%E4%B8%AD%E4%BD%BF%E7%94%A8ViewBinding"><span class="toc-text">在Adapter中使用ViewBinding</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ViewPage2"><span class="toc-text">ViewPage2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#MainActivyty-java"><span class="toc-text">MainActivyty.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ViewPagerAdapter-java"><span class="toc-text">ViewPagerAdapter.java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#item-pager-xml"><span class="toc-text">item_pager.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#colors-xml"><span class="toc-text">colors.xml</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%95%8C%E9%9D%A2%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">编写界面的最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%B6%E4%BD%9C9-Patch%E5%9B%BE%E7%89%87"><span class="toc-text">制作9-Patch图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%B2%BE%E7%BE%8E%E7%9A%84%E8%81%8A%E5%A4%A9%E7%95%8C%E9%9D%A2"><span class="toc-text">编写精美的聊天界面</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kotlin%E8%AF%BE%E5%A0%82-%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E5%AF%86%E5%B0%81%E7%B1%BB"><span class="toc-text">Kotlin课堂:延迟初始化和密封类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E5%8F%98%E9%87%8F%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">对变量延迟初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AF%86%E5%B0%81%E7%B1%BB%E4%BC%98%E5%8C%96%E4%BB%A3%E7%A0%81"><span class="toc-text">使用密封类优化代码</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By lele</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="30" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>